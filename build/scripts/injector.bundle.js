(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function parents(e,n){var o=[];n=n||noop;do o.push(e),e=e.parentNode;while(e&&e.tagName&&n(e));return o.slice(1)}function noop(e){return!0}module.exports=parents;

},{}],2:[function(require,module,exports){
!function(){"use strict";function e(){for(var r=[],o=0;o<arguments.length;o++){var f=arguments[o];if(f){var i=typeof f;if("string"===i||"number"===i)r.push(f);else if(Array.isArray(f))r.push(e.apply(null,f));else if("object"===i)for(var t in f)n.call(f,t)&&f[t]&&r.push(t)}}return r.join(" ")}var n={}.hasOwnProperty;"undefined"!=typeof module&&module.exports?module.exports=e:"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("classnames",[],function(){return e}):window.classNames=e}();

},{}],3:[function(require,module,exports){
"use strict";function diff_match_patch(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;diff_match_patch.Diff,diff_match_patch.prototype.diff_main=function(t,e,n,i){"undefined"==typeof i&&(i=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var h=i;if(null==t||null==e)throw new Error("Null input. (diff_main)");if(t==e)return t?[[DIFF_EQUAL,t]]:[];"undefined"==typeof n&&(n=!0);var r=n,a=this.diff_commonPrefix(t,e),f=t.substring(0,a);t=t.substring(a),e=e.substring(a),a=this.diff_commonSuffix(t,e);var s=t.substring(t.length-a);t=t.substring(0,t.length-a),e=e.substring(0,e.length-a);var l=this.diff_compute_(t,e,r,h);return f&&l.unshift([DIFF_EQUAL,f]),s&&l.push([DIFF_EQUAL,s]),this.diff_cleanupMerge(l),l},diff_match_patch.prototype.diff_compute_=function(t,e,n,i){var h;if(!t)return[[DIFF_INSERT,e]];if(!e)return[[DIFF_DELETE,t]];var r=t.length>e.length?t:e,a=t.length>e.length?e:t,f=r.indexOf(a);if(-1!=f)return h=[[DIFF_INSERT,r.substring(0,f)],[DIFF_EQUAL,a],[DIFF_INSERT,r.substring(f+a.length)]],t.length>e.length&&(h[0][0]=h[2][0]=DIFF_DELETE),h;if(1==a.length)return[[DIFF_DELETE,t],[DIFF_INSERT,e]];var s=this.diff_halfMatch_(t,e);if(s){var l=s[0],_=s[1],c=s[2],g=s[3],o=s[4],p=this.diff_main(l,c,n,i),u=this.diff_main(_,g,n,i);return p.concat([[DIFF_EQUAL,o]],u)}return n&&t.length>100&&e.length>100?this.diff_lineMode_(t,e,i):this.diff_bisect_(t,e,i)},diff_match_patch.prototype.diff_lineMode_=function(t,e,n){var i=this.diff_linesToChars_(t,e);t=i.chars1,e=i.chars2;var h=i.lineArray,r=this.diff_main(t,e,!1,n);this.diff_charsToLines_(r,h),this.diff_cleanupSemantic(r),r.push([DIFF_EQUAL,""]);for(var a=0,f=0,s=0,l="",_="";a<r.length;){switch(r[a][0]){case DIFF_INSERT:s++,_+=r[a][1];break;case DIFF_DELETE:f++,l+=r[a][1];break;case DIFF_EQUAL:if(f>=1&&s>=1){r.splice(a-f-s,f+s),a=a-f-s;for(var i=this.diff_main(l,_,!1,n),c=i.length-1;c>=0;c--)r.splice(a,0,i[c]);a+=i.length}s=0,f=0,l="",_=""}a++}return r.pop(),r},diff_match_patch.prototype.diff_bisect_=function(t,e,n){for(var i=t.length,h=e.length,r=Math.ceil((i+h)/2),a=r,f=2*r,s=new Array(f),l=new Array(f),_=0;f>_;_++)s[_]=-1,l[_]=-1;s[a+1]=0,l[a+1]=0;for(var c=i-h,g=c%2!=0,o=0,p=0,u=0,d=0,F=0;r>F&&!((new Date).getTime()>n);F++){for(var E=-F+o;F-p>=E;E+=2){var m,D=a+E;m=E==-F||E!=F&&s[D-1]<s[D+1]?s[D+1]:s[D-1]+1;for(var I=m-E;i>m&&h>I&&t.charAt(m)==e.charAt(I);)m++,I++;if(s[D]=m,m>i)p+=2;else if(I>h)o+=2;else if(g){var b=a+c-E;if(b>=0&&f>b&&-1!=l[b]){var v=i-l[b];if(m>=v)return this.diff_bisectSplit_(t,e,m,I,n)}}}for(var L=-F+u;F-d>=L;L+=2){var v,b=a+L;v=L==-F||L!=F&&l[b-1]<l[b+1]?l[b+1]:l[b-1]+1;for(var T=v-L;i>v&&h>T&&t.charAt(i-v-1)==e.charAt(h-T-1);)v++,T++;if(l[b]=v,v>i)d+=2;else if(T>h)u+=2;else if(!g){var D=a+c-L;if(D>=0&&f>D&&-1!=s[D]){var m=s[D],I=a+m-D;if(v=i-v,m>=v)return this.diff_bisectSplit_(t,e,m,I,n)}}}}return[[DIFF_DELETE,t],[DIFF_INSERT,e]]},diff_match_patch.prototype.diff_bisectSplit_=function(t,e,n,i,h){var r=t.substring(0,n),a=e.substring(0,i),f=t.substring(n),s=e.substring(i),l=this.diff_main(r,a,!1,h),_=this.diff_main(f,s,!1,h);return l.concat(_)},diff_match_patch.prototype.diff_linesToChars_=function(t,e){function n(t){for(var e="",n=0,r=-1,a=i.length;r<t.length-1;){r=t.indexOf("\n",n),-1==r&&(r=t.length-1);var f=t.substring(n,r+1);n=r+1,(h.hasOwnProperty?h.hasOwnProperty(f):void 0!==h[f])?e+=String.fromCharCode(h[f]):(e+=String.fromCharCode(a),h[f]=a,i[a++]=f)}return e}var i=[],h={};i[0]="";var r=n(t),a=n(e);return{chars1:r,chars2:a,lineArray:i}},diff_match_patch.prototype.diff_charsToLines_=function(t,e){for(var n=0;n<t.length;n++){for(var i=t[n][1],h=[],r=0;r<i.length;r++)h[r]=e[i.charCodeAt(r)];t[n][1]=h.join("")}},diff_match_patch.prototype.diff_commonPrefix=function(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),h=i,r=0;h>n;)t.substring(r,h)==e.substring(r,h)?(n=h,r=n):i=h,h=Math.floor((i-n)/2+n);return h},diff_match_patch.prototype.diff_commonSuffix=function(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,i=Math.min(t.length,e.length),h=i,r=0;h>n;)t.substring(t.length-h,t.length-r)==e.substring(e.length-h,e.length-r)?(n=h,r=n):i=h,h=Math.floor((i-n)/2+n);return h},diff_match_patch.prototype.diff_commonOverlap_=function(t,e){var n=t.length,i=e.length;if(0==n||0==i)return 0;n>i?t=t.substring(n-i):i>n&&(e=e.substring(0,n));var h=Math.min(n,i);if(t==e)return h;for(var r=0,a=1;;){var f=t.substring(h-a),s=e.indexOf(f);if(-1==s)return r;a+=s,0!=s&&t.substring(h-a)!=e.substring(0,a)||(r=a,a++)}},diff_match_patch.prototype.diff_halfMatch_=function(t,e){function n(t,e,n){for(var i,h,r,f,s=t.substring(n,n+Math.floor(t.length/4)),l=-1,_="";-1!=(l=e.indexOf(s,l+1));){var c=a.diff_commonPrefix(t.substring(n),e.substring(l)),g=a.diff_commonSuffix(t.substring(0,n),e.substring(0,l));_.length<g+c&&(_=e.substring(l-g,l)+e.substring(l,l+c),i=t.substring(0,n-g),h=t.substring(n+c),r=e.substring(0,l-g),f=e.substring(l+c))}return 2*_.length>=t.length?[i,h,r,f,_]:null}if(this.Diff_Timeout<=0)return null;var i=t.length>e.length?t:e,h=t.length>e.length?e:t;if(i.length<4||2*h.length<i.length)return null;var r,a=this,f=n(i,h,Math.ceil(i.length/4)),s=n(i,h,Math.ceil(i.length/2));if(!f&&!s)return null;r=s?f&&f[4].length>s[4].length?f:s:f;var l,_,c,g;t.length>e.length?(l=r[0],_=r[1],c=r[2],g=r[3]):(c=r[0],g=r[1],l=r[2],_=r[3]);var o=r[4];return[l,_,c,g,o]},diff_match_patch.prototype.diff_cleanupSemantic=function(t){for(var e=!1,n=[],i=0,h=null,r=0,a=0,f=0,s=0,l=0;r<t.length;)t[r][0]==DIFF_EQUAL?(n[i++]=r,a=s,f=l,s=0,l=0,h=t[r][1]):(t[r][0]==DIFF_INSERT?s+=t[r][1].length:l+=t[r][1].length,h&&h.length<=Math.max(a,f)&&h.length<=Math.max(s,l)&&(t.splice(n[i-1],0,[DIFF_DELETE,h]),t[n[i-1]+1][0]=DIFF_INSERT,i--,i--,r=i>0?n[i-1]:-1,a=0,f=0,s=0,l=0,h=null,e=!0)),r++;for(e&&this.diff_cleanupMerge(t),this.diff_cleanupSemanticLossless(t),r=1;r<t.length;){if(t[r-1][0]==DIFF_DELETE&&t[r][0]==DIFF_INSERT){var _=t[r-1][1],c=t[r][1],g=this.diff_commonOverlap_(_,c),o=this.diff_commonOverlap_(c,_);g>=o?(g>=_.length/2||g>=c.length/2)&&(t.splice(r,0,[DIFF_EQUAL,c.substring(0,g)]),t[r-1][1]=_.substring(0,_.length-g),t[r+1][1]=c.substring(g),r++):(o>=_.length/2||o>=c.length/2)&&(t.splice(r,0,[DIFF_EQUAL,_.substring(0,o)]),t[r-1][0]=DIFF_INSERT,t[r-1][1]=c.substring(0,c.length-o),t[r+1][0]=DIFF_DELETE,t[r+1][1]=_.substring(o),r++),r++}r++}},diff_match_patch.prototype.diff_cleanupSemanticLossless=function(t){function e(t,e){if(!t||!e)return 6;var n=t.charAt(t.length-1),i=e.charAt(0),h=n.match(diff_match_patch.nonAlphaNumericRegex_),r=i.match(diff_match_patch.nonAlphaNumericRegex_),a=h&&n.match(diff_match_patch.whitespaceRegex_),f=r&&i.match(diff_match_patch.whitespaceRegex_),s=a&&n.match(diff_match_patch.linebreakRegex_),l=f&&i.match(diff_match_patch.linebreakRegex_),_=s&&t.match(diff_match_patch.blanklineEndRegex_),c=l&&e.match(diff_match_patch.blanklineStartRegex_);return _||c?5:s||l?4:h&&!a&&f?3:a||f?2:h||r?1:0}for(var n=1;n<t.length-1;){if(t[n-1][0]==DIFF_EQUAL&&t[n+1][0]==DIFF_EQUAL){var i=t[n-1][1],h=t[n][1],r=t[n+1][1],a=this.diff_commonSuffix(i,h);if(a){var f=h.substring(h.length-a);i=i.substring(0,i.length-a),h=f+h.substring(0,h.length-a),r=f+r}for(var s=i,l=h,_=r,c=e(i,h)+e(h,r);h.charAt(0)===r.charAt(0);){i+=h.charAt(0),h=h.substring(1)+r.charAt(0),r=r.substring(1);var g=e(i,h)+e(h,r);g>=c&&(c=g,s=i,l=h,_=r)}t[n-1][1]!=s&&(s?t[n-1][1]=s:(t.splice(n-1,1),n--),t[n][1]=l,_?t[n+1][1]=_:(t.splice(n+1,1),n--))}n++}},diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,diff_match_patch.whitespaceRegex_=/\s/,diff_match_patch.linebreakRegex_=/[\r\n]/,diff_match_patch.blanklineEndRegex_=/\n\r?\n$/,diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/,diff_match_patch.prototype.diff_cleanupEfficiency=function(t){for(var e=!1,n=[],i=0,h=null,r=0,a=!1,f=!1,s=!1,l=!1;r<t.length;)t[r][0]==DIFF_EQUAL?(t[r][1].length<this.Diff_EditCost&&(s||l)?(n[i++]=r,a=s,f=l,h=t[r][1]):(i=0,h=null),s=l=!1):(t[r][0]==DIFF_DELETE?l=!0:s=!0,h&&(a&&f&&s&&l||h.length<this.Diff_EditCost/2&&a+f+s+l==3)&&(t.splice(n[i-1],0,[DIFF_DELETE,h]),t[n[i-1]+1][0]=DIFF_INSERT,i--,h=null,a&&f?(s=l=!0,i=0):(i--,r=i>0?n[i-1]:-1,s=l=!1),e=!0)),r++;e&&this.diff_cleanupMerge(t)},diff_match_patch.prototype.diff_cleanupMerge=function(t){t.push([DIFF_EQUAL,""]);for(var e,n=0,i=0,h=0,r="",a="";n<t.length;)switch(t[n][0]){case DIFF_INSERT:h++,a+=t[n][1],n++;break;case DIFF_DELETE:i++,r+=t[n][1],n++;break;case DIFF_EQUAL:i+h>1?(0!==i&&0!==h&&(e=this.diff_commonPrefix(a,r),0!==e&&(n-i-h>0&&t[n-i-h-1][0]==DIFF_EQUAL?t[n-i-h-1][1]+=a.substring(0,e):(t.splice(0,0,[DIFF_EQUAL,a.substring(0,e)]),n++),a=a.substring(e),r=r.substring(e)),e=this.diff_commonSuffix(a,r),0!==e&&(t[n][1]=a.substring(a.length-e)+t[n][1],a=a.substring(0,a.length-e),r=r.substring(0,r.length-e))),0===i?t.splice(n-h,i+h,[DIFF_INSERT,a]):0===h?t.splice(n-i,i+h,[DIFF_DELETE,r]):t.splice(n-i-h,i+h,[DIFF_DELETE,r],[DIFF_INSERT,a]),n=n-i-h+(i?1:0)+(h?1:0)+1):0!==n&&t[n-1][0]==DIFF_EQUAL?(t[n-1][1]+=t[n][1],t.splice(n,1)):n++,h=0,i=0,r="",a=""}""===t[t.length-1][1]&&t.pop();var f=!1;for(n=1;n<t.length-1;)t[n-1][0]==DIFF_EQUAL&&t[n+1][0]==DIFF_EQUAL&&(t[n][1].substring(t[n][1].length-t[n-1][1].length)==t[n-1][1]?(t[n][1]=t[n-1][1]+t[n][1].substring(0,t[n][1].length-t[n-1][1].length),t[n+1][1]=t[n-1][1]+t[n+1][1],t.splice(n-1,1),f=!0):t[n][1].substring(0,t[n+1][1].length)==t[n+1][1]&&(t[n-1][1]+=t[n+1][1],t[n][1]=t[n][1].substring(t[n+1][1].length)+t[n+1][1],t.splice(n+1,1),f=!0)),n++;f&&this.diff_cleanupMerge(t)},diff_match_patch.prototype.diff_xIndex=function(t,e){var n,i=0,h=0,r=0,a=0;for(n=0;n<t.length&&(t[n][0]!==DIFF_INSERT&&(i+=t[n][1].length),t[n][0]!==DIFF_DELETE&&(h+=t[n][1].length),!(i>e));n++)r=i,a=h;return t.length!=n&&t[n][0]===DIFF_DELETE?a:a+(e-r)},diff_match_patch.prototype.diff_prettyHtml=function(t){for(var e=[],n=/&/g,i=/</g,h=/>/g,r=/\n/g,a=0;a<t.length;a++){var f=t[a][0],s=t[a][1],l=s.replace(n,"&amp;").replace(i,"&lt;").replace(h,"&gt;").replace(r,"&para;<br>");switch(f){case DIFF_INSERT:e[a]='<ins style="background:#e6ffe6;">'+l+"</ins>";break;case DIFF_DELETE:e[a]='<del style="background:#ffe6e6;">'+l+"</del>";break;case DIFF_EQUAL:e[a]="<span>"+l+"</span>"}}return e.join("")},diff_match_patch.prototype.diff_text1=function(t){for(var e=[],n=0;n<t.length;n++)t[n][0]!==DIFF_INSERT&&(e[n]=t[n][1]);return e.join("")},diff_match_patch.prototype.diff_text2=function(t){for(var e=[],n=0;n<t.length;n++)t[n][0]!==DIFF_DELETE&&(e[n]=t[n][1]);return e.join("")},diff_match_patch.prototype.diff_levenshtein=function(t){for(var e=0,n=0,i=0,h=0;h<t.length;h++){var r=t[h][0],a=t[h][1];switch(r){case DIFF_INSERT:n+=a.length;break;case DIFF_DELETE:i+=a.length;break;case DIFF_EQUAL:e+=Math.max(n,i),n=0,i=0}}return e+=Math.max(n,i)},diff_match_patch.prototype.diff_toDelta=function(t){for(var e=[],n=0;n<t.length;n++)switch(t[n][0]){case DIFF_INSERT:e[n]="+"+encodeURI(t[n][1]);break;case DIFF_DELETE:e[n]="-"+t[n][1].length;break;case DIFF_EQUAL:e[n]="="+t[n][1].length}return e.join("	").replace(/%20/g," ")},diff_match_patch.prototype.diff_fromDelta=function(t,e){for(var n=[],i=0,h=0,r=e.split(/\t/g),a=0;a<r.length;a++){var f=r[a].substring(1);switch(r[a].charAt(0)){case"+":try{n[i++]=[DIFF_INSERT,decodeURI(f)]}catch(s){throw new Error("Illegal escape in diff_fromDelta: "+f)}break;case"-":case"=":var l=parseInt(f,10);if(isNaN(l)||0>l)throw new Error("Invalid number in diff_fromDelta: "+f);var _=t.substring(h,h+=l);"="==r[a].charAt(0)?n[i++]=[DIFF_EQUAL,_]:n[i++]=[DIFF_DELETE,_];break;default:if(r[a])throw new Error("Invalid diff operation in diff_fromDelta: "+r[a])}}if(h!=t.length)throw new Error("Delta length ("+h+") does not equal source text length ("+t.length+").");return n},diff_match_patch.prototype.match_main=function(t,e,n){if(null==t||null==e||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,t.length)),t==e?0:t.length?t.substring(n,n+e.length)==e?n:this.match_bitap_(t,e,n):-1},diff_match_patch.prototype.match_bitap_=function(t,e,n){function i(t,i){var h=t/e.length,a=Math.abs(n-i);return r.Match_Distance?h+a/r.Match_Distance:a?1:h}if(e.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var h=this.match_alphabet_(e),r=this,a=this.Match_Threshold,f=t.indexOf(e,n);-1!=f&&(a=Math.min(i(0,f),a),f=t.lastIndexOf(e,n+e.length),-1!=f&&(a=Math.min(i(0,f),a)));var s=1<<e.length-1;f=-1;for(var l,_,c,g=e.length+t.length,o=0;o<e.length;o++){for(l=0,_=g;_>l;)i(o,n+_)<=a?l=_:g=_,_=Math.floor((g-l)/2+l);g=_;var p=Math.max(1,n-_+1),u=Math.min(n+_,t.length)+e.length,d=Array(u+2);d[u+1]=(1<<o)-1;for(var F=u;F>=p;F--){var E=h[t.charAt(F-1)];if(0===o?d[F]=(d[F+1]<<1|1)&E:d[F]=(d[F+1]<<1|1)&E|((c[F+1]|c[F])<<1|1)|c[F+1],d[F]&s){var m=i(o,F-1);if(a>=m){if(a=m,f=F-1,!(f>n))break;p=Math.max(1,2*n-f)}}}if(i(o+1,n)>a)break;c=d}return f},diff_match_patch.prototype.match_alphabet_=function(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=0;for(var n=0;n<t.length;n++)e[t.charAt(n)]|=1<<t.length-n-1;return e},diff_match_patch.prototype.patch_addContext_=function(t,e){if(0!=e.length){for(var n=e.substring(t.start2,t.start2+t.length1),i=0;e.indexOf(n)!=e.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,n=e.substring(t.start2-i,t.start2+t.length1+i);i+=this.Patch_Margin;var h=e.substring(t.start2-i,t.start2);h&&t.diffs.unshift([DIFF_EQUAL,h]);var r=e.substring(t.start2+t.length1,t.start2+t.length1+i);r&&t.diffs.push([DIFF_EQUAL,r]),t.start1-=h.length,t.start2-=h.length,t.length1+=h.length+r.length,t.length2+=h.length+r.length}},diff_match_patch.prototype.patch_make=function(t,e,n){var i,h;if("string"==typeof t&&"string"==typeof e&&"undefined"==typeof n)i=t,h=this.diff_main(i,e,!0),h.length>2&&(this.diff_cleanupSemantic(h),this.diff_cleanupEfficiency(h));else if(t&&"object"==typeof t&&"undefined"==typeof e&&"undefined"==typeof n)h=t,i=this.diff_text1(h);else if("string"==typeof t&&e&&"object"==typeof e&&"undefined"==typeof n)i=t,h=e;else{if("string"!=typeof t||"string"!=typeof e||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");i=t,h=n}if(0===h.length)return[];for(var r=[],a=new diff_match_patch.patch_obj,f=0,s=0,l=0,_=i,c=i,g=0;g<h.length;g++){var o=h[g][0],p=h[g][1];switch(f||o===DIFF_EQUAL||(a.start1=s,a.start2=l),o){case DIFF_INSERT:a.diffs[f++]=h[g],a.length2+=p.length,c=c.substring(0,l)+p+c.substring(l);break;case DIFF_DELETE:a.length1+=p.length,a.diffs[f++]=h[g],c=c.substring(0,l)+c.substring(l+p.length);break;case DIFF_EQUAL:p.length<=2*this.Patch_Margin&&f&&h.length!=g+1?(a.diffs[f++]=h[g],a.length1+=p.length,a.length2+=p.length):p.length>=2*this.Patch_Margin&&f&&(this.patch_addContext_(a,_),r.push(a),a=new diff_match_patch.patch_obj,f=0,_=c,s=l)}o!==DIFF_INSERT&&(s+=p.length),o!==DIFF_DELETE&&(l+=p.length)}return f&&(this.patch_addContext_(a,_),r.push(a)),r},diff_match_patch.prototype.patch_deepCopy=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n],h=new diff_match_patch.patch_obj;h.diffs=[];for(var r=0;r<i.diffs.length;r++)h.diffs[r]=i.diffs[r].slice();h.start1=i.start1,h.start2=i.start2,h.length1=i.length1,h.length2=i.length2,e[n]=h}return e},diff_match_patch.prototype.patch_apply=function(t,e){if(0==t.length)return[e,[]];t=this.patch_deepCopy(t);var n=this.patch_addPadding(t);e=n+e+n,this.patch_splitMax(t);for(var i=0,h=[],r=0;r<t.length;r++){var a,f=t[r].start2+i,s=this.diff_text1(t[r].diffs),l=-1;if(s.length>this.Match_MaxBits?(a=this.match_main(e,s.substring(0,this.Match_MaxBits),f),-1!=a&&(l=this.match_main(e,s.substring(s.length-this.Match_MaxBits),f+s.length-this.Match_MaxBits),(-1==l||a>=l)&&(a=-1))):a=this.match_main(e,s,f),-1==a)h[r]=!1,i-=t[r].length2-t[r].length1;else{h[r]=!0,i=a-f;var _;if(_=-1==l?e.substring(a,a+s.length):e.substring(a,l+this.Match_MaxBits),s==_)e=e.substring(0,a)+this.diff_text2(t[r].diffs)+e.substring(a+s.length);else{var c=this.diff_main(s,_,!1);if(s.length>this.Match_MaxBits&&this.diff_levenshtein(c)/s.length>this.Patch_DeleteThreshold)h[r]=!1;else{this.diff_cleanupSemanticLossless(c);for(var g,o=0,p=0;p<t[r].diffs.length;p++){var u=t[r].diffs[p];u[0]!==DIFF_EQUAL&&(g=this.diff_xIndex(c,o)),u[0]===DIFF_INSERT?e=e.substring(0,a+g)+u[1]+e.substring(a+g):u[0]===DIFF_DELETE&&(e=e.substring(0,a+g)+e.substring(a+this.diff_xIndex(c,o+u[1].length))),u[0]!==DIFF_DELETE&&(o+=u[1].length)}}}}}return e=e.substring(n.length,e.length-n.length),[e,h]},diff_match_patch.prototype.patch_addPadding=function(t){for(var e=this.Patch_Margin,n="",i=1;e>=i;i++)n+=String.fromCharCode(i);for(var i=0;i<t.length;i++)t[i].start1+=e,t[i].start2+=e;var h=t[0],r=h.diffs;if(0==r.length||r[0][0]!=DIFF_EQUAL)r.unshift([DIFF_EQUAL,n]),h.start1-=e,h.start2-=e,h.length1+=e,h.length2+=e;else if(e>r[0][1].length){var a=e-r[0][1].length;r[0][1]=n.substring(r[0][1].length)+r[0][1],h.start1-=a,h.start2-=a,h.length1+=a,h.length2+=a}if(h=t[t.length-1],r=h.diffs,0==r.length||r[r.length-1][0]!=DIFF_EQUAL)r.push([DIFF_EQUAL,n]),h.length1+=e,h.length2+=e;else if(e>r[r.length-1][1].length){var a=e-r[r.length-1][1].length;r[r.length-1][1]+=n.substring(0,a),h.length1+=a,h.length2+=a}return n},diff_match_patch.prototype.patch_splitMax=function(t){for(var e=this.Match_MaxBits,n=0;n<t.length;n++)if(!(t[n].length1<=e)){var i=t[n];t.splice(n--,1);for(var h=i.start1,r=i.start2,a="";0!==i.diffs.length;){var f=new diff_match_patch.patch_obj,s=!0;for(f.start1=h-a.length,f.start2=r-a.length,""!==a&&(f.length1=f.length2=a.length,f.diffs.push([DIFF_EQUAL,a]));0!==i.diffs.length&&f.length1<e-this.Patch_Margin;){var l=i.diffs[0][0],_=i.diffs[0][1];l===DIFF_INSERT?(f.length2+=_.length,r+=_.length,f.diffs.push(i.diffs.shift()),s=!1):l===DIFF_DELETE&&1==f.diffs.length&&f.diffs[0][0]==DIFF_EQUAL&&_.length>2*e?(f.length1+=_.length,h+=_.length,s=!1,f.diffs.push([l,_]),i.diffs.shift()):(_=_.substring(0,e-f.length1-this.Patch_Margin),f.length1+=_.length,h+=_.length,l===DIFF_EQUAL?(f.length2+=_.length,r+=_.length):s=!1,f.diffs.push([l,_]),_==i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(_.length))}a=this.diff_text2(f.diffs),a=a.substring(a.length-this.Patch_Margin);var c=this.diff_text1(i.diffs).substring(0,this.Patch_Margin);""!==c&&(f.length1+=c.length,f.length2+=c.length,0!==f.diffs.length&&f.diffs[f.diffs.length-1][0]===DIFF_EQUAL?f.diffs[f.diffs.length-1][1]+=c:f.diffs.push([DIFF_EQUAL,c])),s||t.splice(++n,0,f)}}},diff_match_patch.prototype.patch_toText=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t[n];return e.join("")},diff_match_patch.prototype.patch_fromText=function(t){var e=[];if(!t)return e;for(var n=t.split("\n"),i=0,h=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<n.length;){var r=n[i].match(h);if(!r)throw new Error("Invalid patch string: "+n[i]);var a=new diff_match_patch.patch_obj;for(e.push(a),a.start1=parseInt(r[1],10),""===r[2]?(a.start1--,a.length1=1):"0"==r[2]?a.length1=0:(a.start1--,a.length1=parseInt(r[2],10)),a.start2=parseInt(r[3],10),""===r[4]?(a.start2--,a.length2=1):"0"==r[4]?a.length2=0:(a.start2--,a.length2=parseInt(r[4],10)),i++;i<n.length;){var f=n[i].charAt(0);try{var s=decodeURI(n[i].substring(1))}catch(l){throw new Error("Illegal escape in patch_fromText: "+s)}if("-"==f)a.diffs.push([DIFF_DELETE,s]);else if("+"==f)a.diffs.push([DIFF_INSERT,s]);else if(" "==f)a.diffs.push([DIFF_EQUAL,s]);else{if("@"==f)break;if(""!==f)throw new Error('Invalid patch mode "'+f+'" in: '+s)}i++}}return e},diff_match_patch.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},diff_match_patch.patch_obj.prototype.toString=function(){var t,e;t=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,e=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var n,i=["@@ -"+t+" +"+e+" @@\n"],h=0;h<this.diffs.length;h++){switch(this.diffs[h][0]){case DIFF_INSERT:n="+";break;case DIFF_DELETE:n="-";break;case DIFF_EQUAL:n=" "}i[h+1]=n+encodeURI(this.diffs[h][1])+"\n"}return i.join("").replace(/%20/g," ")},module.exports=diff_match_patch,module.exports.diff_match_patch=diff_match_patch,module.exports.DIFF_DELETE=DIFF_DELETE,module.exports.DIFF_INSERT=DIFF_INSERT,module.exports.DIFF_EQUAL=DIFF_EQUAL;

},{}],4:[function(require,module,exports){
module.exports=function(){var e=document.baseURI;if(!e)for(var t=document.getElementsByTagName("base"),n=0;n<t.length;n++)if(t[n].href){e=t[n].href;break}return e||document.documentURI}();

},{}],5:[function(require,module,exports){
"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,t,o){return t&&e(r.prototype,t),o&&e(r,o),r}}(),FragmentAnchor=function(){function e(r,t){if(_classCallCheck(this,e),void 0===r)throw new Error('missing required parameter "root"');if(void 0===t)throw new Error('missing required parameter "id"');this.root=r,this.id=t}return _createClass(e,[{key:"toRange",value:function(){var e=this.root.querySelector("#"+this.id);if(null==e)throw new Error('no element found with id "'+this.id+'"');var r=this.root.ownerDocument.createRange();return r.selectNodeContents(e),r}},{key:"toSelector",value:function(){var e=this.root.querySelector("#"+this.id);if(null==e)throw new Error('no element found with id "'+this.id+'"');var r="https://tools.ietf.org/html/rfc3236";return e instanceof SVGElement&&(r="http://www.w3.org/TR/SVG/"),{type:"FragmentSelector",value:this.id,conformsTo:r}}}],[{key:"fromRange",value:function(r,t){if(void 0===r)throw new Error('missing required parameter "root"');if(void 0===t)throw new Error('missing required parameter "range"');for(var o=t.commonAncestorContainer;null!=o&&!o.id;){if(!(r.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_CONTAINED_BY))throw new Error("no fragment identifier found");o=o.parentElement}return new e(r,o.id)}},{key:"fromSelector",value:function(r){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return new e(r,t.value)}}]),e}();exports["default"]=FragmentAnchor,module.exports=exports["default"];

},{}],6:[function(require,module,exports){
module.exports=require("./lib");

},{"./lib":7}],7:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function fromRange(e,r){if(void 0===e)throw new Error('missing required parameter "root"');if(void 0===r)throw new Error('missing required parameter "range"');var t=e.ownerDocument,o=t.createRange(),n=r.startContainer,a=r.startOffset;o.setStart(e,0),o.setEnd(n,a);var d=(0,_rangeToString2["default"])(o).length,i=d+(0,_rangeToString2["default"])(r).length;return{start:d,end:i}}function toRange(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(void 0===e)throw new Error('missing required parameter "root"');var t=e.ownerDocument,o=t.createRange(),n=(0,_domNodeIterator2["default"])(e,SHOW_TEXT),a=r.start||0,d=r.end||a,i=(0,_domSeek2["default"])(n,a),u=a-i;n.pointerBeforeReferenceNode?o.setStart(n.referenceNode,u):(o.setStart(n.nextNode(),u),n.previousNode());var f=d-a+u;return i=(0,_domSeek2["default"])(n,f),u=f-i,n.pointerBeforeReferenceNode?o.setEnd(n.referenceNode,u):o.setEnd(n.nextNode(),u),o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromRange=fromRange,exports.toRange=toRange;var _domNodeIterator=require("dom-node-iterator"),_domNodeIterator2=_interopRequireDefault(_domNodeIterator),_domSeek=require("dom-seek"),_domSeek2=_interopRequireDefault(_domSeek),_rangeToString=require("./range-to-string"),_rangeToString2=_interopRequireDefault(_rangeToString),SHOW_TEXT=4;

},{"./range-to-string":8,"dom-node-iterator":14,"dom-seek":9}],8:[function(require,module,exports){
"use strict";function nextNode(e,t){if(!t&&e.firstChild)return e.firstChild;do{if(e.nextSibling)return e.nextSibling;e=e.parentNode}while(e);return e}function firstNode(e){if(e.startContainer.nodeType===Node.ELEMENT_NODE){var t=e.startContainer.childNodes[e.startOffset];return t||nextNode(e.startContainer,!0)}return e.startContainer}function firstNodeAfter(e){if(e.endContainer.nodeType===Node.ELEMENT_NODE){var t=e.endContainer.childNodes[e.endOffset];return t||nextNode(e.endContainer,!0)}return nextNode(e.endContainer)}function forEachNodeInRange(e,t){for(var n=firstNode(e),r=firstNodeAfter(e);n!==r;)t(n),n=nextNode(n)}function rangeToString(e){var t="";return forEachNodeInRange(e,function(n){if(n.nodeType===Node.TEXT_NODE){var r=n===e.startContainer?e.startOffset:0,o=n===e.endContainer?e.endOffset:n.textContent.length;t+=n.textContent.slice(r,o)}}),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=rangeToString;

},{}],9:[function(require,module,exports){
module.exports=require("./lib")["default"];

},{"./lib":10}],10:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function seek(e,r){if(e.whatToShow!==SHOW_TEXT)throw new Error(E_SHOW);var n=0,t=e.referenceNode,o=null;if(isNumber(r))o={forward:function(){return r>n},backward:function(){return n>r}};else{if(!isText(r))throw new Error(E_WHERE);var u=before(t,r)?function(){return!1}:function(){return t!==r},f=function(){return t!=r||!e.pointerBeforeReferenceNode};o={forward:u,backward:f}}for(;o.forward()&&null!==(t=e.nextNode());)n+=t.nodeValue.length;for(;o.backward()&&null!==(t=e.previousNode());)n-=t.nodeValue.length;return n}function isNumber(e){return!isNaN(parseInt(e))&&isFinite(e)}function isText(e){return e.nodeType===TEXT_NODE}function before(e,r){if(e===r)return!1;for(var n=null,t=[e].concat((0,_ancestors2["default"])(e)).reverse(),o=[r].concat((0,_ancestors2["default"])(r)).reverse();t[0]===o[0];)n=t.shift(),o.shift();t=t[0],o=o[0];var u=(0,_indexOf2["default"])(n.childNodes,t),f=(0,_indexOf2["default"])(n.childNodes,o);return u>f}exports.__esModule=!0,exports["default"]=seek;var _ancestors=require("ancestors"),_ancestors2=_interopRequireDefault(_ancestors),_indexOf=require("index-of"),_indexOf2=_interopRequireDefault(_indexOf),E_SHOW="Argument 1 of seek must use filter NodeFilter.SHOW_TEXT.",E_WHERE="Argument 2 of seek must be a number or a Text Node.",SHOW_TEXT=4,TEXT_NODE=3;

},{"ancestors":1,"index-of":26}],11:[function(require,module,exports){
module.exports=require("./lib");

},{"./lib":12}],12:[function(require,module,exports){
"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e["default"]=t,e}function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function fromRange(t,e){if(void 0===t)throw new Error('missing required parameter "root"');if(void 0===e)throw new Error('missing required parameter "range"');var r=textPosition.fromRange(t,e);return fromTextPosition(t,r)}function fromTextPosition(t,e){if(void 0===t)throw new Error('missing required parameter "root"');if(void 0===e)throw new Error('missing required parameter "selector"');var r=e.start;if(void 0===r)throw new Error('selector missing required property "start"');if(0>r)throw new Error('property "start" must be a non-negative integer');var n=e.end;if(void 0===n)throw new Error('selector missing required property "end"');if(0>n)throw new Error('property "end" must be a non-negative integer');var o=t.textContent.substr(r,n-r),i=Math.max(0,r-CONTEXT_LENGTH),a=t.textContent.substr(i,r-i),s=Math.min(t.textContent.length,n+CONTEXT_LENGTH),u=t.textContent.substr(n,s-n);return{exact:o,prefix:a,suffix:u}}function toRange(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=toTextPosition(t,e,r);return null===n?null:textPosition.toRange(t,n)}function toTextPosition(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(void 0===t)throw new Error('missing required parameter "root"');if(void 0===e)throw new Error('missing required parameter "selector"');var n=e.exact;if(void 0===n)throw new Error('selector missing required property "exact"');var o=e.prefix,i=e.suffix,a=r.hint,s=new _diffMatchPatch2["default"];s.Match_Distance=2*t.textContent.length;var u=n.match(SLICE_RE),f=void 0===a?t.textContent.length/2|0:a,d=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,c=-1,l=void 0!==o,m=void 0!==i,x=!1;l&&(c=s.match_main(t.textContent,o,f),c>-1&&(f=c+o.length,x=!0)),m&&!x&&(c=s.match_main(t.textContent,i,f+n.length),c>-1&&(f=c-n.length));var g=u.shift();if(c=s.match_main(t.textContent,g,f),!(c>-1))return null;d=c,f=h=d+g.length;var p=function(e,r){if(!e)return null;var n=s.match_main(t.textContent,r,e.loc);return-1===n?null:(e.loc=n+r.length,e.start=Math.min(e.start,n),e.end=Math.max(e.end,n+r.length),e)};s.Match_Distance=64;var v=u.reduce(p,{start:d,end:h,loc:f});return v?{start:v.start,end:v.end}:null}Object.defineProperty(exports,"__esModule",{value:!0}),exports.fromRange=fromRange,exports.fromTextPosition=fromTextPosition,exports.toRange=toRange,exports.toTextPosition=toTextPosition;var _diffMatchPatch=require("diff-match-patch"),_diffMatchPatch2=_interopRequireDefault(_diffMatchPatch),_domAnchorTextPosition=require("dom-anchor-text-position"),textPosition=_interopRequireWildcard(_domAnchorTextPosition),SLICE_LENGTH=32,SLICE_RE=new RegExp("(.|[\r\n]){1,"+String(SLICE_LENGTH)+"}","g"),CONTEXT_LENGTH=SLICE_LENGTH;

},{"diff-match-patch":3,"dom-anchor-text-position":6}],13:[function(require,module,exports){
module.exports=require("./lib/implementation")["default"];

},{"./lib/implementation":17}],14:[function(require,module,exports){
module.exports=require("./lib")["default"],module.exports.getPolyfill=require("./polyfill"),module.exports.implementation=require("./implementation"),module.exports.shim=require("./shim");

},{"./implementation":13,"./lib":18,"./polyfill":21,"./shim":22}],15:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function createNodeIterator(e){var t=arguments.length<=1||void 0===arguments[1]?4294967295:arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2],o=9==e.nodeType||e.ownerDocument,n=o.createNodeIterator(e,t,r,!1);return new NodeIterator(n,e,t,r)}exports.__esModule=!0,exports["default"]=createNodeIterator;var NodeIterator=function(){function e(t,r,o,n){_classCallCheck(this,e),this.root=r,this.whatToShow=o,this.filter=n,this.referenceNode=r,this.pointerBeforeReferenceNode=!0,this._iter=t}return e.prototype.nextNode=function(){var e=this._iter.nextNode();return this.pointerBeforeReferenceNode=!1,null===e?null:(this.referenceNode=e,this.referenceNode)},e.prototype.previousNode=function(){var e=this._iter.previousNode();return this.pointerBeforeReferenceNode=!0,null===e?null:(this.referenceNode=e,this.referenceNode)},e.prototype.toString=function(){return"[object NodeIterator]"},e}();

},{}],16:[function(require,module,exports){
"use strict";function createNodeIterator(e){var t=arguments.length<=1||void 0===arguments[1]?4294967295:arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2],o=e.ownerDocument;return o.createNodeIterator.call(o,e,t,r)}exports.__esModule=!0,exports["default"]=createNodeIterator;

},{}],17:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function createNodeIterator(e){var t=arguments.length<=1||void 0===arguments[1]?4294967295:arguments[1],r=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return new NodeIterator(e,t,r)}exports.__esModule=!0,exports["default"]=createNodeIterator;var NodeIterator=function(){function e(t,r,o){_classCallCheck(this,e),this.root=t,this.whatToShow=r,this.filter=o,this.referenceNode=t,this.pointerBeforeReferenceNode=!0,this._filter=function(e){return o?1===o(e):!0},this._show=function(e){return r>>e.nodeType-1&!0}}return e.prototype.nextNode=function(){var e=this.pointerBeforeReferenceNode;this.pointerBeforeReferenceNode=!1;var t=this.referenceNode;if(e&&this._show(t)&&this._filter(t))return t;do if(t.firstChild)t=t.firstChild;else{do{if(t===this.root)return null;if(t.nextSibling)break;t=t.parentNode}while(t);t=t.nextSibling}while(!this._show(t)||!this._filter(t));return this.referenceNode=t,this.pointerBeforeReferenceNode=!1,t},e.prototype.previousNode=function(){var e=this.pointerBeforeReferenceNode;this.pointerBeforeReferenceNode=!0;var t=this.referenceNode;if(!e&&this._show(t)&&this._filter(t))return t;do{if(t===this.root)return null;if(t.previousSibling)for(t=t.previousSibling;t.lastChild;)t=t.lastChild;else t=t.parentNode}while(!this._show(t)||!this._filter(t));return this.referenceNode=t,this.pointerBeforeReferenceNode=!0,t},e.prototype.toString=function(){return"[object NodeIterator]"},e}();

},{}],18:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}exports.__esModule=!0;var _polyfill=require("./polyfill"),_polyfill2=_interopRequireDefault(_polyfill),_implementation=require("./implementation"),_implementation2=_interopRequireDefault(_implementation),_shim=require("./shim"),_shim2=_interopRequireDefault(_shim),polyfill=(0,_polyfill2["default"])();polyfill.implementation=_implementation2["default"],polyfill.shim=_shim2["default"],exports["default"]=polyfill;

},{"./implementation":17,"./polyfill":19,"./shim":20}],19:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function getPolyfill(){try{var e="undefined"==typeof document?{}:document,t=(0,_builtin2["default"])(e,4294967295,null,!1);return t.referenceNode===e?_builtin2["default"]:_adapter2["default"]}catch(i){return _implementation2["default"]}}exports.__esModule=!0,exports["default"]=getPolyfill;var _adapter=require("./adapter"),_adapter2=_interopRequireDefault(_adapter),_builtin=require("./builtin"),_builtin2=_interopRequireDefault(_builtin),_implementation=require("./implementation"),_implementation2=_interopRequireDefault(_implementation);

},{"./adapter":15,"./builtin":16,"./implementation":17}],20:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function shim(){var e="undefined"==typeof document?{}:document,i=(0,_polyfill2["default"])();return i!==_builtin2["default"]&&(e.createNodeIterator=i),i}exports.__esModule=!0,exports["default"]=shim;var _builtin=require("./builtin"),_builtin2=_interopRequireDefault(_builtin),_polyfill=require("./polyfill"),_polyfill2=_interopRequireDefault(_polyfill);

},{"./builtin":16,"./polyfill":19}],21:[function(require,module,exports){
module.exports=require("./lib/polyfill")["default"];

},{"./lib/polyfill":19}],22:[function(require,module,exports){
module.exports=require("./lib/shim")["default"];

},{"./lib/shim":20}],23:[function(require,module,exports){
"use strict";function seek(e,r){if(e.whatToShow!==NodeFilter.SHOW_TEXT)throw new Error(E_SHOW);var t=0,o=e.referenceNode,n=null;if(isNumber(r))n={forward:function(){return r>t},backward:function(){return t>r}};else{if(!isText(r))throw new Error(E_WHERE);n={forward:function(){return before(o,r)},backward:function(){return!e.pointerBeforeReferenceNode||after(o,r)}}}for(;n.forward()&&null!==(o=e.nextNode());)t+=o.textContent.length;for(;n.backward()&&null!==(o=e.previousNode());)t-=o.textContent.length;return t}function isNumber(e){return!isNaN(parseInt(e))&&isFinite(e)}function isText(e){return e.nodeType===Node.TEXT_NODE}function before(e,r){return r.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING}function after(e,r){return r.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=seek;var E_SHOW="Argument 1 of seek must use filter NodeFilter.SHOW_TEXT.",E_WHERE="Argument 2 of seek must be a number or a Text Node.";module.exports=exports["default"];

},{}],24:[function(require,module,exports){
var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,undefined,isArray=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===toStr.call(t)},isPlainObject=function(t){"use strict";if(!t||"[object Object]"!==toStr.call(t))return!1;var r=hasOwn.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&hasOwn.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!o)return!1;var n;for(n in t);return n===undefined||hasOwn.call(t,n)};module.exports=function t(){"use strict";var r,o,n,e,c,i,a=arguments[0],s=1,u=arguments.length,l=!1;for("boolean"==typeof a?(l=a,a=arguments[1]||{},s=2):("object"!=typeof a&&"function"!=typeof a||null==a)&&(a={});u>s;++s)if(r=arguments[s],null!=r)for(o in r)n=a[o],e=r[o],a!==e&&(l&&e&&(isPlainObject(e)||(c=isArray(e)))?(c?(c=!1,i=n&&isArray(n)?n:[]):i=n&&isPlainObject(n)?n:{},a[o]=t(l,i,e)):e!==undefined&&(a[o]=e));return a};

},{}],25:[function(require,module,exports){
(function (global){
var __browserify_shim_require__=require;(function(t,e,n,i,r){!function(e,n,r,s){"use strict";function o(t,e,n){return setTimeout(l(t,n),e)}function a(t,e,n){return Array.isArray(t)?(h(t,n[e],n),!0):!1}function h(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function u(t,n,i){var r="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=e.console&&(e.console.warn||e.console.log);return s&&s.call(e.console,r,i),t.apply(this,arguments)}}function c(t,e,n){var i,r=e.prototype;i=t.prototype=Object.create(r),i.constructor=t,i._super=r,n&&ut(i,n)}function l(t,e){return function(){return t.apply(e,arguments)}}function p(t,e){return typeof t==pt?t.apply(e?e[0]||s:s,e):t}function f(t,e){return t===s?e:t}function d(t,e,n){h(y(e),function(e){t.addEventListener(e,n,!1)})}function v(t,e,n){h(y(e),function(e){t.removeEventListener(e,n,!1)})}function m(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function g(t,e){return t.indexOf(e)>-1}function y(t){return t.trim().split(/\s+/g)}function T(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function E(t){return Array.prototype.slice.call(t,0)}function I(t,e,n){for(var i=[],r=[],s=0;s<t.length;){var o=e?t[s][e]:t[s];T(r,o)<0&&i.push(t[s]),r[s]=o,s++}return n&&(i=e?i.sort(function(t,n){return t[e]>n[e]}):i.sort()),i}function _(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<ct.length;){if(n=ct[o],i=n?n+r:e,i in t)return i;o++}return s}function A(){return yt++}function w(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}function D(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){p(t.options.enable,[t])&&n.handler(e)},this.init()}function b(t){var e,n=t.options.inputClass;return new(e=n?n:It?H:_t?L:Et?V:q)(t,S)}function S(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,s=e&Pt&&i-r===0,o=e&(Ct|Rt)&&i-r===0;n.isFirst=!!s,n.isFinal=!!o,s&&(t.session={}),n.eventType=e,P(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function P(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=R(e)),r>1&&!n.firstMultiple?n.firstMultiple=R(e):1===r&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,a=o?o.center:s.center,h=e.center=O(i);e.timeStamp=vt(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=X(a,h),e.distance=N(a,h),x(n,e),e.offsetDirection=M(e.deltaX,e.deltaY);var u=z(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=dt(u.x)>dt(u.y)?u.x:u.y,e.scale=o?F(o.pointers,i):1,e.rotation=o?Y(o.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,C(n,e);var c=t.element;m(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}function x(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},s=t.prevInput||{};e.eventType!==Pt&&s.eventType!==Ct||(r=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}function C(t,e){var n,i,r,o,a=t.lastInterval||e,h=e.timeStamp-a.timeStamp;if(e.eventType!=Rt&&(h>St||a.velocity===s)){var u=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,l=z(h,u,c);i=l.x,r=l.y,n=dt(l.x)>dt(l.y)?l.x:l.y,o=M(u,c),t.lastInterval=e}else n=a.velocity,i=a.velocityX,r=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}function R(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:ft(t.pointers[n].clientX),clientY:ft(t.pointers[n].clientY)},n++;return{timeStamp:vt(),pointers:e,center:O(e),deltaX:t.deltaX,deltaY:t.deltaY}}function O(t){var e=t.length;if(1===e)return{x:ft(t[0].clientX),y:ft(t[0].clientY)};for(var n=0,i=0,r=0;e>r;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:ft(n/e),y:ft(i/e)}}function z(t,e,n){return{x:e/t||0,y:n/t||0}}function M(t,e){return t===e?Ot:dt(t)>=dt(e)?0>t?zt:Mt:0>e?Nt:Xt}function N(t,e,n){n||(n=Ht);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function X(t,e,n){n||(n=Ht);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}function Y(t,e){return X(e[1],e[0],Wt)+X(t[1],t[0],Wt)}function F(t,e){return N(e[0],e[1],Wt)/N(t[0],t[1],Wt)}function q(){this.evEl=Lt,this.evWin=Ut,this.allow=!0,this.pressed=!1,D.apply(this,arguments)}function H(){this.evEl=Gt,this.evWin=Zt,D.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function W(){this.evTarget=$t,this.evWin=Jt,this.started=!1,D.apply(this,arguments)}function k(t,e){var n=E(t.touches),i=E(t.changedTouches);return e&(Ct|Rt)&&(n=I(n.concat(i),"identifier",!0)),[n,i]}function L(){this.evTarget=Qt,this.targetIds={},D.apply(this,arguments)}function U(t,e){var n=E(t.touches),i=this.targetIds;if(e&(Pt|xt)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,s,o=E(t.changedTouches),a=[],h=this.target;if(s=n.filter(function(t){return m(t.target,h)}),e===Pt)for(r=0;r<s.length;)i[s[r].identifier]=!0,r++;for(r=0;r<o.length;)i[o[r].identifier]&&a.push(o[r]),e&(Ct|Rt)&&delete i[o[r].identifier],r++;return a.length?[I(s.concat(a),"identifier",!0),a]:void 0}function V(){D.apply(this,arguments);var t=l(this.handler,this);this.touch=new L(this.manager,t),this.mouse=new q(this.manager,t)}function j(t,e){this.manager=t,this.set(e)}function G(t){if(g(t,se))return se;var e=g(t,oe),n=g(t,ae);return e&&n?se:e||n?e?oe:ae:g(t,re)?re:ie}function Z(t){this.options=ut({},this.defaults,t||{}),this.id=A(),this.manager=null,this.options.enable=f(this.options.enable,!0),this.state=he,this.simultaneous={},this.requireFail=[]}function B(t){return t&fe?"cancel":t&le?"end":t&ce?"move":t&ue?"start":""}function $(t){return t==Xt?"down":t==Nt?"up":t==zt?"left":t==Mt?"right":""}function J(t,e){var n=e.manager;return n?n.get(t):t}function K(){Z.apply(this,arguments)}function Q(){K.apply(this,arguments),this.pX=null,this.pY=null}function tt(){K.apply(this,arguments)}function et(){Z.apply(this,arguments),this._timer=null,this._input=null}function nt(){K.apply(this,arguments)}function it(){K.apply(this,arguments)}function rt(){Z.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function st(t,e){return e=e||{},e.recognizers=f(e.recognizers,st.defaults.preset),new ot(t,e)}function ot(t,e){this.options=ut({},st.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=b(this),this.touchAction=new j(this,this.options.touchAction),at(this,!0),h(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function at(t,e){var n=t.element;n.style&&h(t.options.cssProps,function(t,i){n.style[_(n.style,i)]=e?t:""})}function ht(t,e){var i=n.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}var ut,ct=["","webkit","Moz","MS","ms","o"],lt=n.createElement("div"),pt="function",ft=Math.round,dt=Math.abs,vt=Date.now;ut="function"!=typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==s&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var mt=u(function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===s)&&(t[i[r]]=e[i[r]]),r++;return t},"extend","Use `assign`."),gt=u(function(t,e){return mt(t,e,!0)},"merge","Use `assign`."),yt=1,Tt=/mobile|tablet|ip(ad|hone|od)|android/i,Et="ontouchstart"in e,It=_(e,"PointerEvent")!==s,_t=Et&&Tt.test(navigator.userAgent),At="touch",wt="pen",Dt="mouse",bt="kinect",St=25,Pt=1,xt=2,Ct=4,Rt=8,Ot=1,zt=2,Mt=4,Nt=8,Xt=16,Yt=zt|Mt,Ft=Nt|Xt,qt=Yt|Ft,Ht=["x","y"],Wt=["clientX","clientY"];D.prototype={handler:function(){},init:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(w(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(w(this.element),this.evWin,this.domHandler)}};var kt={mousedown:Pt,mousemove:xt,mouseup:Ct},Lt="mousedown",Ut="mousemove mouseup";c(q,D,{handler:function(t){var e=kt[t.type];e&Pt&&0===t.button&&(this.pressed=!0),e&xt&&1!==t.which&&(e=Ct),this.pressed&&this.allow&&(e&Ct&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Dt,srcEvent:t}))}});var Vt={pointerdown:Pt,pointermove:xt,pointerup:Ct,pointercancel:Rt,pointerout:Rt},jt={2:At,3:wt,4:Dt,5:bt},Gt="pointerdown",Zt="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Gt="MSPointerDown",Zt="MSPointerMove MSPointerUp MSPointerCancel"),c(H,D,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=Vt[i],s=jt[t.pointerType]||t.pointerType,o=s==At,a=T(e,t.pointerId,"pointerId");r&Pt&&(0===t.button||o)?0>a&&(e.push(t),a=e.length-1):r&(Ct|Rt)&&(n=!0),0>a||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),n&&e.splice(a,1))}});var Bt={touchstart:Pt,touchmove:xt,touchend:Ct,touchcancel:Rt},$t="touchstart",Jt="touchstart touchmove touchend touchcancel";c(W,D,{handler:function(t){var e=Bt[t.type];if(e===Pt&&(this.started=!0),this.started){var n=k.call(this,t,e);e&(Ct|Rt)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:At,srcEvent:t})}}});var Kt={touchstart:Pt,touchmove:xt,touchend:Ct,touchcancel:Rt},Qt="touchstart touchmove touchend touchcancel";c(L,D,{handler:function(t){var e=Kt[t.type],n=U.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:At,srcEvent:t})}}),c(V,D,{handler:function(t,e,n){var i=n.pointerType==At,r=n.pointerType==Dt;if(i)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;e&(Ct|Rt)&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var te=_(lt.style,"touchAction"),ee=te!==s,ne="compute",ie="auto",re="manipulation",se="none",oe="pan-x",ae="pan-y";j.prototype={set:function(t){t==ne&&(t=this.compute()),ee&&this.manager.element.style&&(this.manager.element.style[te]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return h(this.manager.recognizers,function(e){p(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),G(t.join(" "))},preventDefaults:function(t){if(!ee){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var i=this.actions,r=g(i,se),s=g(i,ae),o=g(i,oe);if(r){var a=1===t.pointers.length,h=t.distance<2,u=t.deltaTime<250;if(a&&h&&u)return}if(!o||!s)return r||s&&n&Yt||o&&n&Ft?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var he=1,ue=2,ce=4,le=8,pe=le,fe=16,de=32;Z.prototype={defaults:{},set:function(t){return ut(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(a(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=J(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return a(t,"dropRecognizeWith",this)?this:(t=J(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(a(t,"requireFailure",this))return this;var e=this.requireFail;return t=J(t,this),-1===T(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(a(t,"dropRequireFailure",this))return this;t=J(t,this);var e=T(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,i=this.state;le>i&&e(n.options.event+B(i)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),i>=le&&e(n.options.event+B(i))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=de)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(de|he)))return!1;t++}return!0},recognize:function(t){var e=ut({},t);return p(this.options.enable,[this,e])?(this.state&(pe|fe|de)&&(this.state=he),this.state=this.process(e),void(this.state&(ue|ce|le|fe)&&this.tryEmit(e))):(this.reset(),void(this.state=de))},process:function(t){},getTouchAction:function(){},reset:function(){}},c(K,Z,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(ue|ce),r=this.attrTest(t);return i&&(n&Rt||!r)?e|fe:i||r?n&Ct?e|le:e&ue?e|ce:ue:de}}),c(Q,K,{defaults:{event:"pan",threshold:10,pointers:1,direction:qt},getTouchAction:function(){var t=this.options.direction,e=[];return t&Yt&&e.push(ae),t&Ft&&e.push(oe),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,s=t.deltaX,o=t.deltaY;return r&e.direction||(e.direction&Yt?(r=0===s?Ot:0>s?zt:Mt,n=s!=this.pX,i=Math.abs(t.deltaX)):(r=0===o?Ot:0>o?Nt:Xt,n=o!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return K.prototype.attrTest.call(this,t)&&(this.state&ue||!(this.state&ue)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=$(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),c(tt,K,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[se]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ue)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),c(et,Z,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ie]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(Ct|Rt)&&!r)this.reset();else if(t.eventType&Pt)this.reset(),this._timer=o(function(){this.state=pe,this.tryEmit()},e.time,this);else if(t.eventType&Ct)return pe;return de},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===pe&&(t&&t.eventType&Ct?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=vt(),this.manager.emit(this.options.event,this._input)))}}),c(nt,K,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[se]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ue)}}),c(it,K,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Yt|Ft,pointers:1},getTouchAction:function(){return Q.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Yt|Ft)?e=t.overallVelocity:n&Yt?e=t.overallVelocityX:n&Ft&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&dt(e)>this.options.velocity&&t.eventType&Ct},emit:function(t){var e=$(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),c(rt,Z,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[re]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&Pt&&0===this.count)return this.failTimeout();if(i&&r&&n){if(t.eventType!=Ct)return this.failTimeout();var s=this.pTime?t.timeStamp-this.pTime<e.interval:!0,a=!this.pCenter||N(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t;var h=this.count%e.taps;if(0===h)return this.hasRequireFailures()?(this._timer=o(function(){this.state=pe,this.tryEmit()},e.interval,this),ue):pe}return de},failTimeout:function(){return this._timer=o(function(){this.state=de},this.options.interval,this),de},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==pe&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),st.VERSION="2.0.6",st.defaults={domEvents:!1,touchAction:ne,enable:!0,inputTarget:null,inputClass:null,preset:[[nt,{enable:!1}],[tt,{enable:!1},["rotate"]],[it,{direction:Yt}],[Q,{direction:Yt},["swipe"]],[rt],[rt,{event:"doubletap",taps:2},["tap"]],[et]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ve=1,me=2;ot.prototype={set:function(t){return ut(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?me:ve},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,i=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&pe)&&(r=e.curRecognizer=null);for(var s=0;s<i.length;)n=i[s],e.stopped===me||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&n.state&(ue|ce|le)&&(r=e.curRecognizer=n),s++}},get:function(t){if(t instanceof Z)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(a(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(a(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=T(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){var n=this.handlers;return h(y(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},off:function(t,e){var n=this.handlers;return h(y(t),function(t){e?n[t]&&n[t].splice(T(n[t],e),1):delete n[t]}),this},emit:function(t,e){this.options.domEvents&&ht(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&at(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ut(st,{INPUT_START:Pt,INPUT_MOVE:xt,INPUT_END:Ct,INPUT_CANCEL:Rt,STATE_POSSIBLE:he,STATE_BEGAN:ue,STATE_CHANGED:ce,STATE_ENDED:le,STATE_RECOGNIZED:pe,STATE_CANCELLED:fe,STATE_FAILED:de,DIRECTION_NONE:Ot,DIRECTION_LEFT:zt,DIRECTION_RIGHT:Mt,DIRECTION_UP:Nt,DIRECTION_DOWN:Xt,DIRECTION_HORIZONTAL:Yt,DIRECTION_VERTICAL:Ft,DIRECTION_ALL:qt,Manager:ot,Input:D,TouchAction:j,TouchInput:L,MouseInput:q,PointerEventInput:H,TouchMouseInput:V,SingleTouchInput:W,Recognizer:Z,AttrRecognizer:K,Tap:rt,Pan:Q,Swipe:it,Pinch:tt,Rotate:nt,Press:et,on:d,off:v,each:h,merge:gt,extend:mt,assign:ut,inherit:c,bindFn:l,prefixed:_});var ge="undefined"!=typeof e?e:"undefined"!=typeof self?self:{};ge.Hammer=st,"function"==typeof i&&i.amd?i(function(){return st}):"undefined"!=typeof t&&t.exports?t.exports=st:e[r]=st}(window,document,"Hammer"),r("undefined"!=typeof Hammer?Hammer:window.Hammer)}).call(global,void 0,void 0,void 0,void 0,function(t){module.exports=t});

}).call(this,window)

},{}],26:[function(require,module,exports){
"use strict";module.exports=function(r,t,e){e=e||0;var n=-1;if(null==r)return n;var u=r.length,f=0>e?u+e:e;if(f>=r.length)return-1;for(;u>f;){if(r[f]===t)return f;f++}return-1};

},{}],27:[function(require,module,exports){
(function (process){
(function(){var e,n,r;"undefined"!=typeof performance&&null!==performance&&performance.now?module.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(module.exports=function(){return(e()-r)/1e6},n=process.hrtime,e=function(){var e;return e=n(),1e9*e[0]+e[1]},r=e()):Date.now?(module.exports=function(){return Date.now()-r},r=Date.now()):(module.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this);

}).call(this,require('_process'))

},{"_process":28}],28:[function(require,module,exports){
function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var e=setTimeout(cleanUpNextTick);draining=!0;for(var n=queue.length;n;){for(currentQueue=queue,queue=[];++queueIndex<n;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,n=queue.length}currentQueue=null,draining=!1,clearTimeout(e)}}function Item(e,n){this.fun=e,this.array=n}function noop(){}var process=module.exports={},queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];queue.push(new Item(e,n)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],29:[function(require,module,exports){
(function (global){
for(var now=require("performance-now"),root="undefined"==typeof window?global:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=root["request"+suffix],caf=root["cancel"+suffix]||root["cancelRequest"+suffix],i=0;!raf&&i<vendors.length;i++)raf=root[vendors[i]+"Request"+suffix],caf=root[vendors[i]+"Cancel"+suffix]||root[vendors[i]+"CancelRequest"+suffix];if(!raf||!caf){var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(e){if(0===queue.length){var o=now(),a=Math.max(0,frameDuration-(o-last));last=a+o,setTimeout(function(){var e=queue.slice(0);queue.length=0;for(var o=0;o<e.length;o++)if(!e[o].cancelled)try{e[o].callback(last)}catch(a){setTimeout(function(){throw a},0)}},Math.round(a))}return queue.push({handle:++id,callback:e,cancelled:!1}),id},caf=function(e){for(var o=0;o<queue.length;o++)queue[o].handle===e&&(queue[o].cancelled=!0)}}module.exports=function(e){return raf.call(root,e)},module.exports.cancel=function(){caf.apply(root,arguments)},module.exports.polyfill=function(){root.requestAnimationFrame=raf,root.cancelAnimationFrame=caf};

}).call(this,window)

},{"performance-now":27}],30:[function(require,module,exports){
function setElementScroll(t,e,n){t===window?t.scrollTo(e,n):(t.scrollLeft=e,t.scrollTop=n)}function getTargetScrollLocation(t,e,n){var i,l,o,r,a,c=t.getBoundingClientRect(),d=n&&null!=n.left?n.left:.5,s=n&&null!=n.top?n.top:.5,h=d,f=s;if(e===window)l=c.left+window.scrollX-window.innerWidth*h+Math.min(c.width,window.innerWidth)*h,o=c.top+window.scrollY-window.innerHeight*f+Math.min(c.height,window.innerHeight)*f,l=Math.max(Math.min(l,document.body.scrollWidth-window.innerWidth*h),0),o=Math.max(Math.min(o,document.body.scrollHeight-window.innerHeight*f),0),r=l-window.scrollX,a=o-window.scrollY;else{i=e.getBoundingClientRect();var g=c.top-(i.top-e.scrollTop),w=c.left-(i.left-e.scrollLeft);l=w+c.width*h-e.clientWidth*h,o=g+c.height*f-e.clientHeight*f,l=Math.max(Math.min(l,e.scrollWidth-e.clientWidth),0),o=Math.max(Math.min(o,e.scrollHeight-e.clientHeight),0),r=l-e.scrollLeft,a=o-e.scrollTop}return{x:l,y:o,differenceX:r,differenceY:a}}function animate(t){raf(function(){var e=t._scrollSettings;if(e){var n=getTargetScrollLocation(e.target,t,e.align),i=Date.now()-e.startTime,l=Math.min(1/e.time*i,1);if(i>e.time+20||Math.abs(n.differenceY)<=1&&Math.abs(n.differenceX)<=1)return setElementScroll(t,n.x,n.y),t._scrollSettings=null,e.end(COMPLETE);var o=l,r=l;setElementScroll(t,n.x-n.differenceX*Math.pow(1-o,o/2),n.y-n.differenceY*Math.pow(1-r,r/2)),animate(t)}})}function transitionScrollTo(t,e,n,i){function l(t){e._scrollSettings=null,i(t),e.removeEventListener("touchstart",l)}var o=!e._scrollSettings;e._scrollSettings&&e._scrollSettings.end(CANCELED),e._scrollSettings={startTime:Date.now(),target:t,time:n.time,ease:n.ease,align:n.align,end:l},e.addEventListener("touchstart",l.bind(null,CANCELED)),o&&animate(e)}var raf=require("raf"),COMPLETE="complete",CANCELED="canceled";module.exports=function(t,e,n){function i(t){o--,o||n&&n(t)}if(t){"function"==typeof e&&(n=e,e=null),e||(e={}),e.time=e.time||1e3,e.ease=e.ease||function(t){return t};for(var l=t.parentElement,o=0;l;){if((e.validTarget?e.validTarget(l,o):l===window||(l.scrollHeight!==l.clientHeight||l.scrollWidth!==l.clientWidth)&&"hidden"!==getComputedStyle(l).overflow)&&(o++,transitionScrollTo(t,l,e,i)),l=l.parentElement,!l)return;"BODY"===l.tagName&&(l=window)}}};

},{"raf":29}],31:[function(require,module,exports){
module.exports=require("./zen-observable.js").Observable;

},{"./zen-observable.js":32}],32:[function(require,module,exports){
"use strict";!function(r,t){"undefined"!=typeof exports?r(exports,module):"undefined"!=typeof self&&r("*"===t?self:t?self[t]={}:{})}(function(r,t){function n(r){return"function"==typeof Symbol&&Boolean(Symbol[r])}function e(r){return n(r)?Symbol[r]:"@@"+r}function o(r,t){var n=r[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function i(r){var t=e("species");return t?r[t]:r}function c(r,t){Object.keys(t).forEach(function(n){var e=Object.getOwnPropertyDescriptor(t,n);e.enumerable=!1,Object.defineProperty(r,n,e)})}function u(r){var t=r._cleanup;t&&(r._cleanup=void 0,t())}function f(r){return void 0===r._observer}function s(r){f(r)||(r._observer=void 0,u(r))}function a(r){return function(t){r.unsubscribe()}}function l(r,t){if(Object(r)!==r)throw new TypeError("Observer must be an object");this._cleanup=void 0,this._observer=r;var n=o(r,"start");if(n&&n.call(r,this),!f(this)){r=new b(this);try{var e=t.call(void 0,r);if(null!=e){if("function"==typeof e.unsubscribe)e=a(e);else if("function"!=typeof e)throw new TypeError(e+" is not a function");this._cleanup=e}}catch(i){return void r.error(i)}f(this)&&u(this)}}function b(r){this._subscription=r}function p(r){if("function"!=typeof r)throw new TypeError("Observable initializer must be a function");this._subscriber=r}c(l.prototype={},{get closed(){return f(this)},unsubscribe:function(){s(this)}}),c(b.prototype={},{get closed(){return f(this._subscription)},next:function(r){var t=this._subscription;if(!f(t)){var n=t._observer;try{var e=o(n,"next");if(!e)return;return e.call(n,r)}catch(i){try{s(t)}finally{throw i}}}},error:function(r){var t=this._subscription;if(f(t))throw r;var n=t._observer;t._observer=void 0;try{var e=o(n,"error");if(!e)throw r;r=e.call(n,r)}catch(i){try{u(t)}finally{throw i}}return u(t),r},complete:function(r){var t=this._subscription;if(!f(t)){var n=t._observer;t._observer=void 0;try{var e=o(n,"complete");r=e?e.call(n,r):void 0}catch(i){try{u(t)}finally{throw i}}return u(t),r}}}),c(p.prototype,{subscribe:function(r){for(var t=[],n=1;n<arguments.length;++n)t.push(arguments[n]);return"function"==typeof r&&(r={next:r,error:t[0],complete:t[1]}),new l(r,this._subscriber)},forEach:function(r){var t=this;return new Promise(function(n,e){return"function"!=typeof r?Promise.reject(new TypeError(r+" is not a function")):void t.subscribe({_subscription:null,start:function(r){if(Object(r)!==r)throw new TypeError(r+" is not an object");this._subscription=r},next:function(t){var n=this._subscription;if(!n.closed)try{return r(t)}catch(o){e(o),n.unsubscribe()}},error:e,complete:n})})},map:function(r){var t=this;if("function"!=typeof r)throw new TypeError(r+" is not a function");var n=i(this.constructor);return new n(function(n){return t.subscribe({next:function(t){if(!n.closed){try{t=r(t)}catch(e){return n.error(e)}return n.next(t)}},error:function(r){return n.error(r)},complete:function(r){return n.complete(r)}})})},filter:function(r){var t=this;if("function"!=typeof r)throw new TypeError(r+" is not a function");var n=i(this.constructor);return new n(function(n){return t.subscribe({next:function(t){if(!n.closed){try{if(!r(t))return}catch(e){return n.error(e)}return n.next(t)}},error:function(r){return n.error(r)},complete:function(){return n.complete()}})})},reduce:function(r){var t=this;if("function"!=typeof r)throw new TypeError(r+" is not a function");var n=i(this.constructor),e=arguments.length>1,o=!1,c=arguments[1],u=c;return new n(function(n){return t.subscribe({next:function(t){if(!n.closed){var i=!o;if(o=!0,!i||e)try{u=r(u,t)}catch(c){return n.error(c)}else u=t}},error:function(r){return n.error(r)},complete:function(){return o||e?(n.next(u),void n.complete()):void n.error(new TypeError("Cannot reduce an empty sequence"))}})})},flatMap:function(r){var t=this;if("function"!=typeof r)throw new TypeError(r+" is not a function");var n=i(this.constructor);return new n(function(n){function e(){o&&0===i.length&&n.complete()}var o=!1,i=[],c=t.subscribe({next:function(t){if(r)try{t=r(t)}catch(o){return void n.error(o)}p.from(t).subscribe({_subscription:null,start:function(r){i.push(this._subscription=r)},next:function(r){n.next(r)},error:function(r){n.error(r)},complete:function(){var r=i.indexOf(this._subscription);r>=0&&i.splice(r,1),e()}})},error:function(r){return n.error(r)},complete:function(){o=!0,e()}});return function(r){i.forEach(function(r){return r.unsubscribe()}),c.unsubscribe()}})}}),Object.defineProperty(p.prototype,e("observable"),{value:function(){return this},writable:!0,configurable:!0}),c(p,{from:function(r){var t="function"==typeof this?this:p;if(null==r)throw new TypeError(r+" is not an object");var i=o(r,e("observable"));if(i){var c=i.call(r);if(Object(c)!==c)throw new TypeError(c+" is not an object");return c.constructor===t?c:new t(function(r){return c.subscribe(r)})}if(n("iterator")&&(i=o(r,e("iterator"))))return new t(function(t){for(var n,e=i.call(r)[Symbol.iterator]();n=e.next(),!n.done;){var o=n.value;if(t.next(o),t.closed)return}t.complete()});if(Array.isArray(r))return new t(function(t){for(var n=0;n<r.length;++n)if(t.next(r[n]),t.closed)return;t.complete()});throw new TypeError(r+" is not observable")},of:function(){for(var r=[],t=0;t<arguments.length;++t)r.push(arguments[t]);var n="function"==typeof this?this:p;return new n(function(t){for(var n=0;n<r.length;++n)if(t.next(r[n]),t.closed)return;t.complete()})}}),Object.defineProperty(p,e("species"),{get:function(){return this},configurable:!0}),r.Observable=p},"*");

},{}],33:[function(require,module,exports){
module.exports='<hypothesis-adder-toolbar class="annotator-adder js-adder">\n  <hypothesis-adder-actions class="annotator-adder-actions">\n    <button class="annotator-adder-actions__button h-icon-annotate js-annotate-btn">\n      <span class="annotator-adder-actions__label" data-action="comment">Annotate</span>\n    </button>\n    <button class="annotator-adder-actions__button h-icon-highlight js-highlight-btn">\n      <span class="annotator-adder-actions__label" data-action="highlight">Highlight</span>\n    </button>\n  </hypothesis-adder-actions>\n</hypothesis-adder-toolbar>\n';

},{}],34:[function(require,module,exports){
"use strict";function toPx(t){return t.toString()+"px"}function attachShadow(t){return t.attachShadow?t.attachShadow({mode:"open"}):t.createShadowRoot?t.createShadowRoot():null}function createAdderDOM(t){var e,n=attachShadow(t);if(n){n.innerHTML=template,e=n.querySelector(".js-adder");var a=Array.from(document.styleSheets).map(function(t){return t.href}).filter(function(t){return(t||"").match(/(icomoon|inject)\.css/)}),i=document.createElement("style");i.textContent=a.map(function(t){return'@import "'+t+'";'}).join("\n"),n.appendChild(i)}else t.innerHTML=template,e=t.querySelector(".js-adder");return e}function Adder(t,e){function n(t){t.preventDefault(),t.stopPropagation();var n=this.classList.contains(ANNOTATE_BTN_CLASS);n?e.onAnnotate():e.onHighlight(),r.hide()}function a(){return o.getBoundingClientRect().width}function i(){return o.getBoundingClientRect().height}var r=this,o=createAdderDOM(t);Object.assign(t.style,{display:"block",visibility:"hidden",position:"absolute",top:0,zIndex:999}),this.element=o;var s,O=o.ownerDocument.defaultView;o.querySelector(ANNOTATE_BTN_SELECTOR).addEventListener("click",n),o.querySelector(HIGHLIGHT_BTN_SELECTOR).addEventListener("click",n),this.hide=function(){clearTimeout(s),o.className=classnames({"annotator-adder":!0}),t.style.visibility="hidden"},this.target=function(t,e){var n;n=e?ARROW_POINTING_DOWN:ARROW_POINTING_UP;var r,o,s=Math.min(ARROW_H_MARGIN,t.width);return o=e?t.left-a()/2+s:t.left+t.width-a()/2-s,t.top-i()<O.pageYOffset&&n===ARROW_POINTING_DOWN?n=ARROW_POINTING_UP:t.top+i()>O.pageYOffset+O.innerHeight&&(n=ARROW_POINTING_DOWN),r=n===ARROW_POINTING_UP?t.top+t.height+ARROW_HEIGHT:t.top-i()-ARROW_HEIGHT,o=Math.max(o,O.pageXOffset),o=Math.min(o,O.pageXOffset+O.innerWidth-a()),r=Math.max(r,O.pageYOffset),r=Math.min(r,O.pageYOffset+O.innerHeight-i()),{top:r,left:o,arrowDirection:n}},this.showAt=function(e,n,a){o.className=classnames({"annotator-adder":!0,"annotator-adder--arrow-down":a===ARROW_POINTING_DOWN,"annotator-adder--arrow-up":a===ARROW_POINTING_UP}),this.element.querySelector(ANNOTATE_BTN_SELECTOR).style.display="",this.element.querySelector(HIGHLIGHT_BTN_SELECTOR).style.display="",Object.assign(t.style,{top:toPx(n),left:toPx(e),visibility:"visible"}),clearTimeout(s),s=setTimeout(function(){o.className+=" is-active"},1)}}var classnames=require("classnames"),template=require("./adder.html"),ANNOTATE_BTN_CLASS="js-annotate-btn",ANNOTATE_BTN_SELECTOR=".js-annotate-btn",HIGHLIGHT_BTN_SELECTOR=".js-highlight-btn",ARROW_POINTING_DOWN=1,ARROW_POINTING_UP=2,ARROW_HEIGHT=10,ARROW_H_MARGIN=20;module.exports={ARROW_POINTING_DOWN:ARROW_POINTING_DOWN,ARROW_POINTING_UP:ARROW_POINTING_UP,Adder:Adder};

},{"./adder.html":33,"classnames":2}],35:[function(require,module,exports){
var FragmentAnchor,RangeAnchor,TextPositionAnchor,TextQuoteAnchor,querySelector,ref;ref=require("./types"),FragmentAnchor=ref.FragmentAnchor,RangeAnchor=ref.RangeAnchor,TextPositionAnchor=ref.TextPositionAnchor,TextQuoteAnchor=ref.TextQuoteAnchor,querySelector=function(e,r,n,t){var o;return o=function(o,c){var u,l,a,h;try{return u=e.fromSelector(r,n,t),h=u.toRange(t),o(h)}catch(a){return l=a,c(l)}},new Promise(o)},exports.anchor=function(e,r,n){var t,o,c,u,l,a,h,i,f,s;for(null==n&&(n={}),t=null,l=null,h=null,i=null,f=null!=r?r:[],o=0,c=f.length;c>o;o++)switch(s=f[o],s.type){case"FragmentSelector":t=s;break;case"TextPositionSelector":l=s,n.hint=l.start;break;case"TextQuoteSelector":h=s;break;case"RangeSelector":i=s}return u=function(e){if(null!=(null!=h?h.exact:void 0)&&e.toString()!==h.exact)throw new Error("quote mismatch");return e},a=Promise.reject("unable to anchor"),null!=t&&(a=a["catch"](function(){return querySelector(FragmentAnchor,e,t,n).then(u)})),null!=i&&(a=a["catch"](function(){return querySelector(RangeAnchor,e,i,n).then(u)})),null!=l&&(a=a["catch"](function(){return querySelector(TextPositionAnchor,e,l,n).then(u)})),null!=h&&(a=a["catch"](function(){return querySelector(TextQuoteAnchor,e,h,n)})),a},exports.describe=function(e,r,n){var t,o,c,u,l;return null==n&&(n={}),l=[FragmentAnchor,RangeAnchor,TextPositionAnchor,TextQuoteAnchor],c=function(){var c,a,h;for(h=[],c=0,a=l.length;a>c;c++){u=l[c];try{t=u.fromRange(e,r,n),h.push(o=t.toSelector(n))}catch(i){continue}}return h}()};

},{"./types":38}],36:[function(require,module,exports){
var RenderingStates,TextPositionAnchor,TextQuoteAnchor,anchorByPosition,findInPages,findPage,getNodeTextLayer,getPage,getPageOffset,getPageTextContent,getSiblingIndex,html,pageTextCache,prioritizePages,quotePositionCache,ref,seek,xpathRange,slice=[].slice;seek=require("dom-seek"),xpathRange=require("./range"),html=require("./html"),RenderingStates=require("../pdfjs-rendering-states"),ref=require("./types"),TextPositionAnchor=ref.TextPositionAnchor,TextQuoteAnchor=ref.TextQuoteAnchor,pageTextCache={},quotePositionCache={},getSiblingIndex=function(e){var t;return t=Array.prototype.slice.call(e.parentNode.childNodes),t.indexOf(e)},getNodeTextLayer=function(e){for(var t;!(null!=(t=e.classList)?t.contains("page"):void 0);)e=e.parentNode;return e.getElementsByClassName("textLayer")[0]},getPage=function(e){return PDFViewerApplication.pdfViewer.getPageView(e)},getPageTextContent=function(e){var t;return null!=pageTextCache[e]?pageTextCache[e]:(t=function(e){var t,n,r,o;return n=e.items,r=function(){var e,r,o;for(o=[],e=0,r=n.length;r>e;e++)t=n[e],/\S/.test(t.str)&&o.push(t.str);return o}(),o=r.join("")},pageTextCache[e]=PDFViewerApplication.pdfViewer.getPageTextContent(e).then(t),pageTextCache[e])},getPageOffset=function(e){var t,n;return t=-1,(n=function(r){return++t===e?Promise.resolve(r):getPageTextContent(t).then(function(e){return n(r+e.length)})})(0)},findPage=function(e){var t,n,r;return n=0,r=0,t=function(o){return r+o.length>e?(e=r,Promise.resolve({index:n,offset:e,textContent:o})):(n++,r+=o.length,getPageTextContent(n).then(t))},getPageTextContent(0).then(t)},anchorByPosition=function(e,t,n){var r,o,a,i,s,c,u,l,g;return u=e.renderingState,c=null!=(i=e.textLayer)?i.renderingDone:void 0,u===RenderingStates.FINISHED&&c?(l=e.textLayer.textLayerDiv,g=t.toSelector(n),html.anchor(l,[g])):(r=null!=(s=e.div)?s:e.el,o=r.getElementsByClassName("annotator-placeholder")[0],null==o&&(o=document.createElement("span"),o.classList.add("annotator-placeholder"),o.textContent="Loading annotations…",r.appendChild(o)),a=document.createRange(),a.setStartBefore(o),a.setEndAfter(o),a)},findInPages=function(e,t,n){var r,o,a,i,s,c,u,l;return u=e[0],l=2<=e.length?slice.call(e,1):[],null==u?Promise.reject(new Error("Quote not found")):(r=function(e){var r,o,a,i,s,c;return s=e[0],o=e[1],i=e[2],c={textContent:o},r=new TextQuoteAnchor.fromSelector(c,t),null!=n?(a=n.start-i,a=Math.max(0,a),a=Math.min(a,o.length),r.toPositionAnchor({hint:a})):r.toPositionAnchor()},i=function(){return findInPages(l,t,n)},o=function(e){var r;return n&&(null==quotePositionCache[r=t.exact]&&(quotePositionCache[r]={}),quotePositionCache[t.exact][n.start]={page:c,anchor:e}),anchorByPosition(c,e)},c=getPage(u),a=getPageTextContent(u),s=getPageOffset(u),Promise.all([c,a,s]).then(r).then(o)["catch"](i))},prioritizePages=function(e){var t,n,r,o;return n=PDFViewerApplication.pdfViewer.pagesCount,t=function(){r=[];for(var e=0;n>=0?n>e:e>n;n>=0?e++:e--)r.push(e);return r}.apply(this),o=function(e){var n,r,o;for(n=t.slice(0,e),o=t.slice(e),r=[];n.length||o.length;)o.length&&r.push(o.shift()),n.length&&r.push(n.pop());return r},null!=e?findPage(e.start).then(function(e){var t;return t=e.index,o(t)}):Promise.resolve(t)},exports.anchor=function(e,t,n){var r,o,a,i,s,c,u,l;for(null==n&&(n={}),i=null,c=null,u=null!=t?t:[],o=0,a=u.length;a>o;o++)switch(l=u[o],l.type){case"TextPositionSelector":i=l;break;case"TextQuoteSelector":c=l}return s=Promise.reject("unable to anchor"),r=function(e){if(null!=(null!=c?c.exact:void 0)&&e.toString()!==c.exact)throw new Error("quote mismatch");return e},null!=i&&(s=s["catch"](function(){return findPage(i.start).then(function(t){var o,a,s,c,u,l,g,h;return s=t.index,u=t.offset,h=t.textContent,l=getPage(s),g=i.start-u,a=i.end-u,c=a-g,r(h.substr(g,c)),o=new TextPositionAnchor(e,g,a),anchorByPosition(l,o,n)})})),null!=c&&(s=s["catch"](function(){var e,t,r,o;return null!=i&&null!=(null!=(r=quotePositionCache[c.exact])?r[i.start]:void 0)?(o=quotePositionCache[c.exact][i.start],t=o.page,e=o.anchor,anchorByPosition(t,e,n)):prioritizePages(i).then(function(e){return findInPages(e,c,i)})})),s},exports.describe=function(e,t,n){var r,o,a,i,s,c,u,l,g;if(null==n&&(n={}),t=new xpathRange.BrowserRange(t).normalize(),g=getNodeTextLayer(t.start),i=getNodeTextLayer(t.end),g!==i)throw new Error("selecting across page breaks is not supported");return l=t.limit(g),a=t.limit(i),u=getSiblingIndex(g.parentNode),o=getSiblingIndex(i.parentNode),s=document.createNodeIterator(g,NodeFilter.SHOW_TEXT),c=seek(s,t.start),r=seek(s,t.end)+c+t.end.textContent.length,getPageOffset(u).then(function(t){var o,i,s;return c+=t,r+=t,o=new TextPositionAnchor(e,c,r).toSelector(n),s=document.createRange(),s.setStartBefore(l.start),s.setEndAfter(a.end),i=TextQuoteAnchor.fromRange(e,s,n).toSelector(n),Promise.all([o,i])})},exports.purgeCache=function(){return pageTextCache={},quotePositionCache={}};

},{"../pdfjs-rendering-states":49,"./html":35,"./range":37,"./types":38,"dom-seek":23}],37:[function(require,module,exports){
var $,Range,Util,extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;$=require("jquery"),Util=require("./util"),Range={},Range.sniff=function(t){return null!=t.commonAncestorContainer?new Range.BrowserRange(t):"string"==typeof t.start?new Range.SerializedRange(t):t.start&&"object"==typeof t.start?new Range.NormalizedRange(t):(console.error("Could not sniff range type"),!1)},Range.nodeFromXPath=function(t,e){var n,r,o,s,i;return null==e&&(e=document),r=function(t,n){var r,o;null==n&&(n=null);try{return document.evaluate("."+t,e,n,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(r){return o=r,console.log("XPath evaluation failed."),console.log("Trying fallback..."),Util.nodeFromXPath(t,e)}},$.isXMLDoc(document.documentElement)?(n=document.createNSResolver(null===document.ownerDocument?document.documentElement:document.ownerDocument.documentElement),s=r(t,n),s||(t=function(){var e,n,r,o;for(r=t.split("/"),o=[],e=0,n=r.length;n>e;e++)i=r[e],i&&-1===i.indexOf(":")?o.push(i.replace(/^([a-z]+)/,"xhtml:$1")):o.push(i);return o}().join("/"),o=document.lookupNamespaceURI(null),n=function(t){return"xhtml"===t?o:document.documentElement.getAttribute("xmlns:"+t)},s=r(t,n)),s):r(t)},Range.RangeError=function(t){function e(t,n,r){this.type=t,this.message=n,this.parent=null!=r?r:null,e.__super__.constructor.call(this,this.message)}return extend(e,t),e}(Error),Range.BrowserRange=function(){function t(t){this.commonAncestorContainer=t.commonAncestorContainer,this.startContainer=t.startContainer,this.startOffset=t.startOffset,this.endContainer=t.endContainer,this.endOffset=t.endOffset}return t.prototype.normalize=function(t){var e,n,r,o;if(this.tainted)return console.error("You may only call normalize() once on a BrowserRange!"),!1;if(this.tainted=!0,o={},this.startContainer.nodeType===Node.ELEMENT_NODE?(this.startOffset<this.startContainer.childNodes.length?o.start=Util.getFirstTextNodeNotBefore(this.startContainer.childNodes[this.startOffset]):o.start=Util.getFirstTextNodeNotBefore(this.startContainer),o.startOffset=0):(o.start=this.startContainer,o.startOffset=this.startOffset),this.endContainer.nodeType===Node.ELEMENT_NODE){if(n=this.endContainer.childNodes[this.endOffset],null!=n){for(e=n;null!=e&&e.nodeType!==Node.TEXT_NODE;)e=e.firstChild;null!=e&&(o.end=e,o.endOffset=0)}null==o.end&&(n=this.endOffset?this.endContainer.childNodes[this.endOffset-1]:this.endContainer.previousSibling,o.end=Util.getLastTextNodeUpTo(n),o.endOffset=o.end.nodeValue.length)}else o.end=this.endContainer,o.endOffset=this.endOffset;for(r={},o.startOffset>0?!o.start.nextSibling||o.start.nodeValue.length>o.startOffset?r.start=o.start.splitText(o.startOffset):r.start=o.start.nextSibling:r.start=o.start,o.start===o.end?(r.start.nodeValue.length>o.endOffset-o.startOffset&&r.start.splitText(o.endOffset-o.startOffset),r.end=r.start):(o.end.nodeValue.length>o.endOffset&&o.end.splitText(o.endOffset),r.end=o.end),r.commonAncestor=this.commonAncestorContainer;r.commonAncestor.nodeType!==Node.ELEMENT_NODE;)r.commonAncestor=r.commonAncestor.parentNode;return new Range.NormalizedRange(r)},t.prototype.serialize=function(t,e){return this.normalize(t).serialize(t,e)},t}(),Range.NormalizedRange=function(){function t(t){this.commonAncestor=t.commonAncestor,this.start=t.start,this.end=t.end}return t.prototype.normalize=function(t){return this},t.prototype.limit=function(t){var e,n,r,o,s,i;if(r=$.grep(this.textNodes(),function(e){return e.parentNode===t||$.contains(t,e.parentNode)}),!r.length)return null;for(this.start=r[0],this.end=r[r.length-1],i=$(this.start).parents(),s=$(this.end).parents(),e=0,n=s.length;n>e;e++)if(o=s[e],-1!==i.index(o)){this.commonAncestor=o;break}return this},t.prototype.serialize=function(t,e){var n,r,o;return r=function(n,r){var o,s,i,a,f,l,d,u;for(l=e?$(n).parents(":not("+e+")").eq(0):$(n).parent(),u=Util.xpathFromNode(l,t)[0],d=Util.getTextNodes(l),a=d.slice(0,d.index(n)),f=0,o=0,s=a.length;s>o;o++)i=a[o],f+=i.nodeValue.length;return r?[u,f+n.nodeValue.length]:[u,f]},o=r(this.start),n=r(this.end,!0),new Range.SerializedRange({start:o[0],end:n[0],startOffset:o[1],endOffset:n[1]})},t.prototype.text=function(){var t;return function(){var e,n,r,o;for(r=this.textNodes(),o=[],e=0,n=r.length;n>e;e++)t=r[e],o.push(t.nodeValue);return o}.call(this).join("")},t.prototype.textNodes=function(){var t,e,n,r;return r=Util.getTextNodes($(this.commonAncestor)),e=[r.index(this.start),r.index(this.end)],n=e[0],t=e[1],$.makeArray(r.slice(n,+t+1||9e9))},t.prototype.toRange=function(){var t;return t=document.createRange(),t.setStartBefore(this.start),t.setEndAfter(this.end),t},t}(),Range.SerializedRange=function(){function t(t){this.start=t.start,this.startOffset=t.startOffset,this.end=t.end,this.endOffset=t.endOffset}return t.prototype.normalize=function(t){var e,n,r,o,s,i,a,f,l,d,u,c,h,m,g;for(u={},c=["start","end"],o=0,i=c.length;i>o;o++){d=c[o];try{l=Range.nodeFromXPath(this[d],t)}catch(r){throw n=r,new Range.RangeError(d,"Error while finding "+d+" node: "+this[d]+": "+n,n)}if(!l)throw new Range.RangeError(d,"Couldn't find "+d+" node: "+this[d]);for(f=0,m=this[d+"Offset"],"end"===d&&m--,h=Util.getTextNodes($(l)),s=0,a=h.length;a>s;s++){if(g=h[s],f+g.nodeValue.length>m){u[d+"Container"]=g,u[d+"Offset"]=this[d+"Offset"]-f;break}f+=g.nodeValue.length}if(null==u[d+"Offset"])throw new Range.RangeError(d+"offset","Couldn't find offset "+this[d+"Offset"]+" in element "+this[d])}return e=null==document.compareDocumentPosition?function(t,e){return t.contains(e)}:function(t,e){return 16&t.compareDocumentPosition(e)},$(u.startContainer).parents().each(function(){return e(this,u.endContainer)?(u.commonAncestorContainer=this,!1):void 0}),new Range.BrowserRange(u).normalize(t)},t.prototype.serialize=function(t,e){return this.normalize(t).serialize(t,e)},t.prototype.toObject=function(){return{start:this.start,startOffset:this.startOffset,end:this.end,endOffset:this.endOffset}},t}(),module.exports=Range;

},{"./util":39,"jquery":"jquery"}],38:[function(require,module,exports){
var RangeAnchor,TextPositionAnchor,TextQuoteAnchor,domAnchorTextPosition,domAnchorTextQuote,missingParameter,xpathRange;domAnchorTextPosition=require("dom-anchor-text-position"),domAnchorTextQuote=require("dom-anchor-text-quote"),xpathRange=require("./range"),missingParameter=function(t){throw new Error('missing required parameter "'+t+'"')},RangeAnchor=function(){function t(t,e){null==t&&missingParameter("root"),null==e&&missingParameter("range"),this.root=t,this.range=xpathRange.sniff(e).normalize(this.root)}return t.fromRange=function(e,o){return new t(e,o)},t.fromSelector=function(e,o){var n,r;return n={start:o.startContainer,startOffset:o.startOffset,end:o.endContainer,endOffset:o.endOffset},r=new xpathRange.SerializedRange(n),new t(e,r)},t.prototype.toRange=function(){return this.range.toRange()},t.prototype.toSelector=function(t){var e;return null==t&&(t={}),e=this.range.serialize(this.root,t.ignoreSelector),{type:"RangeSelector",startContainer:e.start,startOffset:e.startOffset,endContainer:e.end,endOffset:e.endOffset}},t}(),TextPositionAnchor=function(){function t(t,e,o){this.root=t,this.start=e,this.end=o}return t.fromRange=function(e,o){var n;return n=domAnchorTextPosition.fromRange(e,o),t.fromSelector(e,n)},t.fromSelector=function(e,o){return new t(e,o.start,o.end)},t.prototype.toSelector=function(){return{type:"TextPositionSelector",start:this.start,end:this.end}},t.prototype.toRange=function(){return domAnchorTextPosition.toRange(this.root,{start:this.start,end:this.end})},t}(),TextQuoteAnchor=function(){function t(t,e,o){null==o&&(o={}),this.root=t,this.exact=e,this.context=o}return t.fromRange=function(e,o,n){var r;return r=domAnchorTextQuote.fromRange(e,o,n),t.fromSelector(e,r)},t.fromSelector=function(e,o){var n,r;return n=o.prefix,r=o.suffix,new t(e,o.exact,{prefix:n,suffix:r})},t.prototype.toSelector=function(){return{type:"TextQuoteSelector",exact:this.exact,prefix:this.context.prefix,suffix:this.context.suffix}},t.prototype.toRange=function(t){var e;if(null==t&&(t={}),e=domAnchorTextQuote.toRange(this.root,this.toSelector(),t),null===e)throw new Error("Quote not found");return e},t.prototype.toPositionAnchor=function(t){var e;if(null==t&&(t={}),e=domAnchorTextQuote.toTextPosition(this.root,this.toSelector(),t),null===e)throw new Error("Quote not found");return new TextPositionAnchor(this.root,e.start,e.end)},t}(),exports.RangeAnchor=RangeAnchor,exports.FragmentAnchor=require("dom-anchor-fragment"),exports.TextPositionAnchor=TextPositionAnchor,exports.TextQuoteAnchor=TextQuoteAnchor;

},{"./range":37,"dom-anchor-fragment":5,"dom-anchor-text-position":6,"dom-anchor-text-quote":11}],39:[function(require,module,exports){
var $,Util,ref,simpleXPathJQuery,simpleXPathPure;$=require("jquery"),ref=require("./xpath"),simpleXPathJQuery=ref.simpleXPathJQuery,simpleXPathPure=ref.simpleXPathPure,Util={},Util.flatten=function(e){var t;return(t=function(e){var r,l,o,i;for(l=[],o=0,i=e.length;i>o;o++)r=e[o],l=l.concat(r&&$.isArray(r)?t(r):r);return l})(e)},Util.getTextNodes=function(e){var t;return t=function(e){var r;if(e&&e.nodeType!==Node.TEXT_NODE){if(r=[],e.nodeType!==Node.COMMENT_NODE)for(e=e.lastChild;e;)r.push(t(e)),e=e.previousSibling;return r.reverse()}return e},e.map(function(){return Util.flatten(t(this))})},Util.getLastTextNodeUpTo=function(e){var t;switch(e.nodeType){case Node.TEXT_NODE:return e;case Node.ELEMENT_NODE:if(null!=e.lastChild&&(t=Util.getLastTextNodeUpTo(e.lastChild),null!=t))return t}return e=e.previousSibling,null!=e?Util.getLastTextNodeUpTo(e):null},Util.getFirstTextNodeNotBefore=function(e){var t;switch(e.nodeType){case Node.TEXT_NODE:return e;case Node.ELEMENT_NODE:if(null!=e.firstChild&&(t=Util.getFirstTextNodeNotBefore(e.firstChild),null!=t))return t}return e=e.nextSibling,null!=e?Util.getFirstTextNodeNotBefore(e):null},Util.xpathFromNode=function(e,t){var r,l,o;try{o=simpleXPathJQuery.call(e,t)}catch(r){l=r,console.log("jQuery-based XPath construction failed! Falling back to manual."),o=simpleXPathPure.call(e,t)}return o},Util.nodeFromXPath=function(e,t){var r,l,o,i,n,a,u,s;for(s=e.substring(1).split("/"),n=t,r=0,o=s.length;o>r;r++)u=s[r],a=u.split("["),i=a[0],l=a[1],l=null!=l?parseInt((null!=l?l.split("]"):void 0)[0]):1,n=findChild(n,i.toLowerCase(),l);return n},module.exports={nodeFromXPath:Util.nodeFromXPath,xpathFromNode:Util.xpathFromNode,getTextNodes:Util.getTextNodes,getFirstTextNodeNotBefore:Util.getFirstTextNodeNotBefore,getLastTextNodeUpTo:Util.getLastTextNodeUpTo};

},{"./xpath":40,"jquery":"jquery"}],40:[function(require,module,exports){
var $,findChild,getNodeName,getNodePosition,simpleXPathJQuery,simpleXPathPure;$=require("jquery"),simpleXPathJQuery=function(e){var r;return r=this.map(function(){var r,t,o,n;for(o="",r=this;(null!=r?r.nodeType:void 0)===Node.ELEMENT_NODE&&r!==e;)n=r.tagName.replace(":","\\:"),t=$(r.parentNode).children(n).index(r)+1,t="["+t+"]",o="/"+r.tagName.toLowerCase()+t+o,r=r.parentNode;return o}),r.get()},simpleXPathPure=function(e){var r,t,o,n;return r=function(e){var r,t;return r=getNodeName(e),t=getNodePosition(e),r+"["+t+"]"},n=e,t=function(e){var t;for(t="";e!==n;){if(null==e)throw new Error("Called getPathTo on a node which was not a descendant of @rootNode. "+n);t=r(e)+"/"+t,e=e.parentNode}return t="/"+t,t=t.replace(/\/$/,"")},o=this.map(function(){var e;return e=t(this)}),o.get()},findChild=function(e,r,t){var o,n,a,i,d,u;if(!e.hasChildNodes())throw new Error("XPath error: node has no children!");for(n=e.childNodes,a=0,i=0,d=n.length;d>i;i++)if(o=n[i],u=getNodeName(o),u===r&&(a+=1,a===t))return o;throw new Error("XPath error: wanted child not found.")},getNodeName=function(e){var r;switch(r=e.nodeName.toLowerCase()){case"#text":return"text()";case"#comment":return"comment()";case"#cdata-section":return"cdata-section()";default:return r}},getNodePosition=function(e){var r,t;for(r=0,t=e;t;)t.nodeName===e.nodeName&&r++,t=t.previousSibling;return r},module.exports={simpleXPathJQuery:simpleXPathJQuery,simpleXPathPure:simpleXPathPure};

},{"jquery":"jquery"}],41:[function(require,module,exports){
"use strict";function annotationCounts(t,n){function o(n){var o=t.querySelectorAll("["+ANNOTATION_COUNT_ATTR+"]");Array.from(o).forEach(function(t){t.textContent=n})}n.on(events.PUBLIC_ANNOTATION_COUNT_CHANGED,o)}var events=require("../shared/bridge-events"),ANNOTATION_COUNT_ATTR="data-hypothesis-annotation-count";module.exports=annotationCounts;

},{"../shared/bridge-events":64}],42:[function(require,module,exports){
"use strict";function AnnotationSync(t,n){var o=this;if(this.bridge=t,!n.on)throw new Error("options.on unspecified for AnnotationSync.");if(!n.emit)throw new Error("options.emit unspecified for AnnotationSync.");this.cache={},this._on=n.on,this._emit=n.emit,Object.keys(this._eventListeners).forEach(function(t){var n=o._eventListeners[t];o._on(t,function(t){n.apply(o,[t])})}),Object.keys(this._channelListeners).forEach(function(t){o.bridge.on(t,function(n,e){var i=o._channelListeners[t];i.apply(o,[n,e])})})}AnnotationSync.prototype.cache=null,AnnotationSync.prototype.sync=function(t){return t=function(){var n,o=[];for(n=0;n<t.length;n++)o.push(this._format(t[n]));return o}.call(this),this.bridge.call("sync",t,function(t){return function(n,o){var e,i=[];for(o=o||[],e=0;e<o.length;e++)i.push(t._parse(o[e]));return i}}(this)),this},AnnotationSync.prototype._channelListeners={deleteAnnotation:function(t,n){var o=this._parse(t);delete this.cache[o.$tag],this._emit("annotationDeleted",o),n(null,this._format(o))},loadAnnotations:function(t,n){var o=function(){var n,o=[];for(n=0;n<t.length;n++)o.push(this._parse(t[n]));return o}.call(this);return this._emit("annotationsLoaded",o),n(null,o)}},AnnotationSync.prototype._eventListeners={beforeAnnotationCreated:function(t){return t.$tag?void 0:this._mkCallRemotelyAndParseResults("beforeCreateAnnotation")(t)}},AnnotationSync.prototype._mkCallRemotelyAndParseResults=function(t,n){return function(o){return function(e){var i=function(t,e){null===t&&o._parseResults(e),"function"==typeof n&&n(t,e)};o.bridge.call(t,o._format(e),i)}}(this)},AnnotationSync.prototype._parseResults=function(t){var n,o,e,i;for(e=0;e<t.length;e++)for(n=t[e],n=[].concat(n),i=0;i<n.length;i++)o=n[i],null!==o&&this._parse(o)},AnnotationSync.prototype._tag=function(t,n){return t.$tag?t:(n=n||window.btoa(Math.random()),Object.defineProperty(t,"$tag",{value:n}),this.cache[n]=t,t)},AnnotationSync.prototype._parse=function(t){var n=Object.assign(this.cache[t.tag]||{},t.msg);return this._tag(n,t.tag)},AnnotationSync.prototype._format=function(t){return this._tag(t),{tag:t.$tag,msg:t}},module.exports=AnnotationSync;

},{}],43:[function(require,module,exports){
"use strict";function config(t){var e={app:t.document.querySelector('link[type="application/annotator+html"]').href};try{Object.assign(e,settings(t.document))}catch(n){console.warn("Could not parse settings from js-hypothesis-config tags",n)}if(t.hasOwnProperty("hypothesisConfig")){if("function"!=typeof t.hypothesisConfig)throw new TypeError("hypothesisConfig must be a function, see: "+docs);Object.assign(e,t.hypothesisConfig())}var o=annotationQuery.extractAnnotationQuery(t.location.href);return o&&Object.assign(e,o),e}var annotationQuery=require("./util/extract-annotation-query"),settings=require("../shared/settings"),docs="https://h.readthedocs.io/en/latest/embedding.html";module.exports=config;

},{"../shared/settings":68,"./util/extract-annotation-query":59}],44:[function(require,module,exports){
var $,Annotator,Guest,adder,animationPromise,baseURI,extend,highlighter,normalizeURI,raf,rangeUtil,scrollIntoView,selections,xpathRange,extend1=function(t,n){function e(){this.constructor=t}for(var o in n)hasProp.call(n,o)&&(t[o]=n[o]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},hasProp={}.hasOwnProperty,slice=[].slice,indexOf=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};baseURI=require("document-base-uri"),extend=require("extend"),raf=require("raf"),scrollIntoView=require("scroll-into-view"),Annotator=require("annotator"),$=Annotator.$,adder=require("./adder"),highlighter=require("./highlighter"),rangeUtil=require("./range-util"),selections=require("./selections"),xpathRange=require("./anchoring/range"),animationPromise=function(t){return new Promise(function(n,e){return raf(function(){var o,r;try{return n(t())}catch(r){return o=r,e(o)}})})},normalizeURI=function(t,n){var e;return e=new URL(t,n),e.toString().replace(/#.*/,"")},module.exports=Guest=function(t){function n(t,e){var o,r,i,a,s;n.__super__.constructor.apply(this,arguments),s=this,this.adderCtrl=new adder.Adder(this.adder[0],{onAnnotate:function(){return s.createAnnotation(),Annotator.Util.getGlobal().getSelection().removeAllRanges()},onHighlight:function(){return s.setVisibleHighlights(!0),s.createHighlight(),Annotator.Util.getGlobal().getSelection().removeAllRanges()}}),this.selections=selections(document).subscribe({next:function(t){return t?s._onSelection(t):s._onClearSelection()}}),this.anchors=[],o={on:function(t){return function(n,e){return t.subscribe(n,e)}}(this),emit:function(t){return function(){var n,e;return e=arguments[0],n=2<=arguments.length?slice.call(arguments,1):[],t.publish(e,n)}}(this)},this.addPlugin("CrossFrame",o),this.crossframe=this.plugins.CrossFrame,this.crossframe.onConnect(function(t){return function(){return t.publish("panelReady")}}(this)),this._connectAnnotationSync(this.crossframe),this._connectAnnotationUISync(this.crossframe),a=this.options;for(r in a)hasProp.call(a,r)&&(i=a[r],!this.plugins[r]&&Annotator.Plugin[r]&&this.addPlugin(r,i))}var e;return extend1(n,t),e="annotator-highlights-always-on",n.prototype.events={".annotator-hl click":"onHighlightClick",".annotator-hl mouseover":"onHighlightMouseover",".annotator-hl mouseout":"onHighlightMouseout"},n.prototype.options={Document:{},TextSelection:{}},n.prototype.anchoring=require("./anchoring/html"),n.prototype.anchors=null,n.prototype.visibleHighlights=!1,n.prototype.html=extend({},Annotator.prototype.html,{adder:"<hypothesis-adder></hypothesis-adder>"}),n.prototype.getDocumentInfo=function(){var t,n;return null!=this.plugins.PDF?(t=Promise.resolve(this.plugins.PDF.getMetadata()),n=Promise.resolve(this.plugins.PDF.uri())):null!=this.plugins.Document?(n=Promise.resolve(this.plugins.Document.uri()),t=Promise.resolve(this.plugins.Document.metadata)):(n=Promise.reject(),t=Promise.reject()),n=n["catch"](function(){return decodeURIComponent(window.location.href)}),t=t["catch"](function(){return{title:document.title,link:[{href:decodeURIComponent(window.location.href)}]}}),Promise.all([t,n]).then(function(t){var n,e;return e=t[0],n=t[1],{uri:normalizeURI(n,baseURI),metadata:e}})},n.prototype._connectAnnotationSync=function(t){return this.subscribe("annotationDeleted",function(t){return function(n){return t.detach(n)}}(this)),this.subscribe("annotationsLoaded",function(t){return function(n){var e,o,r,i;for(i=[],o=0,r=n.length;r>o;o++)e=n[o],i.push(t.anchor(e));return i}}(this))},n.prototype._connectAnnotationUISync=function(t){return t.on("focusAnnotations",function(t){return function(n){var e,o,r,i,a,s,u;for(null==n&&(n=[]),i=t.anchors,s=[],o=0,r=i.length;r>o;o++)e=i[o],null!=e.highlights&&(a=e.annotation.$tag,u=indexOf.call(n,a)>=0,s.push($(e.highlights).toggleClass("annotator-hl-focused",u)));return s}}(this)),t.on("scrollToAnnotation",function(t){return function(n){var e,o,r,i,a;for(i=t.anchors,a=[],o=0,r=i.length;r>o;o++)e=i[o],null!=e.highlights&&(e.annotation.$tag===n?a.push(scrollIntoView(e.highlights[0])):a.push(void 0));return a}}(this)),t.on("getDocumentInfo",function(t){return function(n){return t.getDocumentInfo().then(function(t){return n(null,t)})["catch"](function(t){return n(t)})}}(this)),t.on("setVisibleHighlights",function(t){return function(n){return t.setVisibleHighlights(n)}}(this))},n.prototype._setupWrapper=function(){return this.wrapper=this.element,this},n.prototype._setupViewer=function(){return this},n.prototype._setupEditor=function(){return this},n.prototype._setupDocumentEvents=function(){return this},n.prototype._setupDynamicStyle=function(){return this},n.prototype.destroy=function(){var t,n,e;$("#annotator-dynamic-style").remove(),this.selections.unsubscribe(),this.adder.remove(),this.element.find(".annotator-hl").each(function(){return $(this).contents().insertBefore(this),$(this).remove()}),this.element.data("annotator",null),e=this.plugins;for(t in e)n=e[t],this.plugins[t].destroy();return this.removeEvents()},n.prototype.anchor=function(t){var n,e,o,r,i,a,s,u,l,h,c,g,p,f,d,m,v;for(d=this,f=this.element[0],o=[],e=[],r=[],null==t.target&&(t.target=[]),h=function(n){var e,o;return(null!=(o=n.selector)?o:[]).some(function(t){return function(t){return"TextQuoteSelector"===t.type}}(this))?(e={cache:d.anchoringCache,ignoreSelector:'[class^="annotator-"]'},d.anchoring.anchor(f,n.selector,e).then(function(e){return{annotation:t,target:n,range:e}})["catch"](function(){return{annotation:t,target:n}})):Promise.resolve({annotation:t,target:n})},i=function(t){return null==t.range?t:animationPromise(function(){var n,e,o;return o=xpathRange.sniff(t.range),e=o.normalize(f),n=highlighter.highlightRange(e),$(n).data("annotation",t.annotation),t.highlights=n,t})},m=function(n){var e,o,r,i,a,s,u;for(o=!1,r=!1,i=0,a=n.length;a>i;i++)if(e=n[i],null!=e.target.selector&&(o=!0,null!=e.range)){r=!0;break}return t.$orphan=o&&!r,d.anchors=d.anchors.concat(n),null!=(s=d.plugins.BucketBar)&&s.update(),null!=(u=d.plugins.CrossFrame)&&u.sync([t]),n},c=d.anchors.splice(0,d.anchors.length),a=0,u=c.length;u>a;a++)n=c[a],n.annotation===t?null!=n.range&&(g=n.target,indexOf.call(t.target,g)>=0)?(o.push(n),e.push(n.target)):null!=n.highlights&&(r=r.concat(n.highlights),delete n.highlights,delete n.range):d.anchors.push(n);for(raf(function(){return highlighter.removeHighlights(r)}),p=t.target,s=0,l=p.length;l>s;s++)v=p[s],indexOf.call(e,v)<0&&(n=h(v).then(i),o.push(n));return Promise.all(o).then(m)},n.prototype.detach=function(t){var n,e,o,r,i,a,s,u,l;for(e=[],u=[],l=[],i=this.anchors,o=0,r=i.length;r>o;o++)n=i[o],n.annotation===t?l.push(null!=(a=n.highlights)?a:[]):e.push(n);return this.anchors=e,l=(s=Array.prototype).concat.apply(s,l),raf(function(t){return function(){var n;return highlighter.removeHighlights(l),null!=(n=t.plugins.BucketBar)?n.update():void 0}}(this))},n.prototype.createAnnotation=function(t){var n,e,o,r,i,a,s,u,l,h,c;return null==t&&(t={}),u=this,a=this.element[0],r=null!=(i=this.selectedRanges)?i:[],this.selectedRanges=null,n=function(t){var n;return n={cache:u.anchoringCache,ignoreSelector:'[class^="annotator-"]'},u.anchoring.describe(a,t,n)},l=function(n){return t.document=n.metadata,t.uri=n.uri},h=function(n){var e,o,r,i;return e=n[0],r=n[1],i=e.uri,t.target=function(){var t,n,e;for(e=[],t=0,n=r.length;n>t;t++)o=r[t],e.push({source:i,selector:o});return e}()},e=this.getDocumentInfo(),s=Promise.all(r.map(n)),o=e.then(l),c=Promise.all([e,s]).then(h),c.then(function(){return u.publish("beforeAnnotationCreated",[t])}),c.then(function(){return u.anchor(t)}),t},n.prototype.createHighlight=function(){return this.createAnnotation({$highlight:!0})},n.prototype.createComment=function(){var t,n,e;return t={},e=this,n=function(n){return t.document=n.metadata,t.uri=n.uri,t.target=[{source:n.uri}]},this.getDocumentInfo().then(n).then(function(){return e.publish("beforeAnnotationCreated",[t])}),t},n.prototype.showAnnotations=function(t){var n,e,o;return o=function(){var e,o,r;for(r=[],e=0,o=t.length;o>e;e++)n=t[e],r.push(n.$tag);return r}(),null!=(e=this.crossframe)?e.call("showAnnotations",o):void 0},n.prototype.toggleAnnotationSelection=function(t){var n,e,o;return o=function(){var e,o,r;for(r=[],e=0,o=t.length;o>e;e++)n=t[e],r.push(n.$tag);return r}(),null!=(e=this.crossframe)?e.call("toggleAnnotationSelection",o):void 0},n.prototype.updateAnnotations=function(t){var n,e,o;return o=function(){var e,o,r;for(r=[],e=0,o=t.length;o>e;e++)n=t[e],r.push(n.$tag);return r}(),null!=(e=this.crossframe)?e.call("updateAnnotations",o):void 0},n.prototype.focusAnnotations=function(t){var n,e,o;return o=function(){var e,o,r;for(r=[],e=0,o=t.length;o>e;e++)n=t[e],r.push(n.$tag);return r}(),null!=(e=this.crossframe)?e.call("focusAnnotations",o):void 0},n.prototype._onSelection=function(t){var n,e,o,r,i,a,s;return a=Annotator.Util.getGlobal().getSelection(),o=rangeUtil.isSelectionBackwards(a),(e=rangeUtil.selectionFocusRect(a))?(this.selectedRanges=[t],Annotator.$(".annotator-toolbar .h-icon-note").attr("title","New Annotation").removeClass("h-icon-note").addClass("h-icon-annotate"),i=this.adderCtrl.target(e,o),r=i.left,s=i.top,n=i.arrowDirection,this.adderCtrl.showAt(r,s,n)):void this._onClearSelection()},n.prototype._onClearSelection=function(){return this.adderCtrl.hide(),this.selectedRanges=[],Annotator.$(".annotator-toolbar .h-icon-annotate").attr("title","New Page Note").removeClass("h-icon-annotate").addClass("h-icon-note")},n.prototype.selectAnnotations=function(t,n){return n?this.toggleAnnotationSelection(t):this.showAnnotations(t)},n.prototype.onHighlightMouseover=function(t){var n,e;if(this.visibleHighlights)return n=$(t.currentTarget).data("annotation"),e=null!=t.annotations?t.annotations:t.annotations=[],e.push(n),t.target===t.currentTarget?setTimeout(function(t){return function(){return t.focusAnnotations(e)}}(this)):void 0},n.prototype.onHighlightMouseout=function(t){return this.visibleHighlights?this.focusAnnotations([]):void 0},n.prototype.onHighlightClick=function(t){var n,e,o;if(this.visibleHighlights)return n=$(t.currentTarget).data("annotation"),e=null!=t.annotations?t.annotations:t.annotations=[],e.push(n),t.target===t.currentTarget?(o=t.metaKey||t.ctrlKey,setTimeout(function(t){return function(){return t.selectAnnotations(e,o)}}(this))):void 0},n.prototype.setVisibleHighlights=function(t){var n;return null!=(n=this.crossframe)&&n.call("setVisibleHighlights",t),this.toggleHighlightClass(t),this.publish("setVisibleHighlights",t)},n.prototype.toggleHighlightClass=function(t){return t?this.element.addClass(e):this.element.removeClass(e),this.visibleHighlights=t},n}(Annotator);

},{"./adder":34,"./anchoring/html":35,"./anchoring/range":37,"./highlighter":45,"./range-util":55,"./selections":56,"annotator":62,"document-base-uri":4,"extend":24,"raf":29,"scroll-into-view":30}],45:[function(require,module,exports){
var $;$=require("jquery"),exports.highlightRange=function(t,e){var r,n,o;return null==e&&(e="annotator-hl"),o=/^\s*$/,r=$("<hypothesis-highlight class='"+e+"'></hypothesis-highlight>"),n=$(t.textNodes()).filter(function(t){return!o.test(this.nodeValue)}),n.wrap(r).parent().toArray()},exports.removeHighlights=function(t){var e,r,n,o;for(o=[],r=0,n=t.length;n>r;r++)e=t[r],null!=e.parentNode&&o.push($(e).replaceWith(e.childNodes));return o},exports.getBoundingClientRect=function(t){var e;return e=t.map(function(t){return t.getBoundingClientRect()}),e.reduce(function(t,e){return{top:Math.min(t.top,e.top),left:Math.min(t.left,e.left),bottom:Math.max(t.bottom,e.bottom),right:Math.max(t.right,e.right)}})};

},{"jquery":"jquery"}],46:[function(require,module,exports){
var $,Annotator,Guest,Host,extend=function(t,e){function r(){this.constructor=t}for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};Annotator=require("annotator"),$=Annotator.$,Guest=require("./guest"),module.exports=Host=function(t){function e(t,r){var n,o;o="config="+encodeURIComponent(JSON.stringify(Object.assign({},r,{app:void 0}))),r.app&&indexOf.call(r.app,"?")>=0?r.app+="&"+o:r.app+="?"+o,n=$("<iframe></iframe>").attr("name","hyp_sidebar_frame").attr("allowfullscreen","").attr("seamless","").attr("src",r.app).addClass("h-sidebar-iframe"),this.frame=$("<div></div>").css("display","none").addClass("annotator-frame annotator-outer").appendTo(t),e.__super__.constructor.apply(this,arguments),n.appendTo(this.frame),this.on("panelReady",function(t){return function(){return void 0===r.showHighlights&&(r.showHighlights=!0),t.setVisibleHighlights(r.showHighlights),t.frame.css("display","")}}(this)),this.on("beforeAnnotationCreated",function(t){return t.$highlight?void 0:n[0].contentWindow.focus()})}return extend(e,t),e.prototype.destroy=function(){return this.frame.remove(),e.__super__.destroy.apply(this,arguments)},e}(Guest);

},{"./guest":44,"annotator":62}],47:[function(require,module,exports){
"use strict";require("../shared/polyfills");var Annotator=require("annotator");window.document.evaluate||require("./vendor/wgxpath.install");var g=Annotator.Util.getGlobal();g.wgxpath&&g.wgxpath.install(),Annotator.Guest=require("./guest"),Annotator.Host=require("./host"),Annotator.Sidebar=require("./sidebar"),Annotator.PdfSidebar=require("./pdf-sidebar"),Annotator.Plugin.BucketBar=require("./plugin/bucket-bar"),Annotator.Plugin.Toolbar=require("./plugin/toolbar"),Annotator.Plugin.PDF=require("./plugin/pdf"),require("./vendor/annotator.document"),Annotator.Plugin.CrossFrame=require("./plugin/cross-frame"),Annotator.Plugin.CrossFrame.AnnotationSync=require("./annotation-sync"),Annotator.Plugin.CrossFrame.Bridge=require("../shared/bridge"),Annotator.Plugin.CrossFrame.Discovery=require("../shared/discovery");var appLinkEl=document.querySelector('link[type="application/annotator+html"]'),options=require("./config")(window);Annotator.noConflict().$.noConflict(!0)(function(){var n=window.PDFViewerApplication?Annotator.PdfSidebar:Annotator.Sidebar;options.hasOwnProperty("constructor")&&(n=options.constructor,delete options.constructor),window.annotator=new n(document.body,options),appLinkEl.addEventListener("destroy",function(){appLinkEl.parentElement.removeChild(appLinkEl),window.annotator.destroy(),window.annotator=void 0})});

},{"../shared/bridge":65,"../shared/discovery":66,"../shared/polyfills":"/src/shared/polyfills.js","./annotation-sync":42,"./config":43,"./guest":44,"./host":46,"./pdf-sidebar":48,"./plugin/bucket-bar":50,"./plugin/cross-frame":51,"./plugin/pdf":53,"./plugin/toolbar":54,"./sidebar":58,"./vendor/annotator.document":61,"./vendor/wgxpath.install":63,"annotator":62}],48:[function(require,module,exports){
var PdfSidebar,Sidebar,extend=function(r,e){function t(){this.constructor=r}for(var o in e)hasProp.call(e,o)&&(r[o]=e[o]);return t.prototype=e.prototype,r.prototype=new t,r.__super__=e.prototype,r},hasProp={}.hasOwnProperty;Sidebar=require("./sidebar"),module.exports=PdfSidebar=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return extend(e,r),e.prototype.options={TextSelection:{},PDF:{},BucketBar:{container:".annotator-frame",scrollables:["#viewerContainer"]},Toolbar:{container:".annotator-frame"}},e}(Sidebar);

},{"./sidebar":58}],49:[function(require,module,exports){
"use strict";var RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};module.exports=RenderingStates;

},{}],50:[function(require,module,exports){
var $,Annotator,BUCKET_NAV_SIZE,BUCKET_SIZE,BUCKET_TOP_THRESHOLD,BucketBar,highlighter,raf,scrollIntoView,scrollToClosest,bind=function(t,n){return function(){return t.apply(n,arguments)}},extend=function(t,n){function e(){this.constructor=t}for(var o in n)hasProp.call(n,o)&&(t[o]=n[o]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};raf=require("raf"),Annotator=require("annotator"),$=Annotator.$,scrollIntoView=require("scroll-into-view"),highlighter=require("../highlighter"),BUCKET_SIZE=16,BUCKET_NAV_SIZE=BUCKET_SIZE+6,BUCKET_TOP_THRESHOLD=115+BUCKET_NAV_SIZE,scrollToClosest=function(t,n){var e,o;return e="up"===n?1:-1,o=t.reduce(function(t,n){var r,i,s;return(null!=(i=n.highlights)?i.length:void 0)?(s=t.start,o=t.next,r=highlighter.getBoundingClientRect(n.highlights),1===e&&r.top>=BUCKET_TOP_THRESHOLD?t:-1===e&&r.top<=window.innerHeight-BUCKET_NAV_SIZE?t:null==o?{start:r.top,next:n}:s*e<r.top*e?{start:r.top,next:n}:t):t},{}).next,scrollIntoView(o.highlights[0])},module.exports=BucketBar=function(t){function n(t,e){this.update=bind(this.update,this),n.__super__.constructor.call(this,$(this.html),e),null!=this.options.container?$(this.options.container).append(this.element):$(t).append(this.element)}return extend(n,t),n.prototype.html='<div class="annotator-bucket-bar">\n</div>',n.prototype.options={gapSize:60,scrollables:["body"]},n.prototype.buckets=[],n.prototype.index=[],n.prototype.tabs=null,n.prototype.pluginInit=function(){var t,n,e,o,r,i;for($(window).on("resize scroll",this.update),o=null!=(e=this.options.scrollables)?e:[],r=[],t=0,n=o.length;n>t;t++)i=o[t],r.push($(i).on("resize scroll",this.update));return r},n.prototype.destroy=function(){var t,n,e,o,r,i;for($(window).off("resize scroll",this.update),o=null!=(e=this.options.scrollables)?e:[],r=[],t=0,n=o.length;n>t;t++)i=o[t],r.push($(i).off("resize scroll",this.update));return r},n.prototype._collate=function(t,n){var e,o,r;for(e=o=0,r=t.length-1;r>=0?r>=o:o>=r;e=r>=0?++o:--o){if(t[e]<n[e])return-1;if(t[e]>n[e])return 1}return 0},n.prototype.update=function(){return null==this._updatePending?this._updatePending=raf(function(t){return function(){return delete t._updatePending,t._update()}}(this)):void 0},n.prototype._update=function(){var t,n,e,o,r,i,s,u,h,l;for(t=[],e=[],u=this.annotator.anchors.reduce(function(n){return function(n,o,r){var i,s,u,h;return(null!=(u=o.highlights)?u.length:void 0)?(s=highlighter.getBoundingClientRect(o.highlights),h=s.top,i=s.bottom-s.top,BUCKET_TOP_THRESHOLD>h?indexOf.call(t,o)<0&&t.push(o):h>window.innerHeight-BUCKET_NAV_SIZE?indexOf.call(e,o)<0&&e.push(o):(n.push([h,1,o]),n.push([h+i,-1,o])),n):n}}(this),[]),h=u.sort(this._collate).reduce(function(t){return function(n,e,o,r){var i,s,u,h,l,a,c,p,d,g,f,_,T,E,b,B;if(u=n.buckets,a=n.index,h=n.carry,B=e[0],l=e[1],i=e[2],l>0?(c=h.anchors.indexOf(i))<0?(h.anchors.unshift(i),h.counts.unshift(1)):h.counts[c]++:(c=h.anchors.indexOf(i),0===--h.counts[c]&&(h.anchors.splice(c,1),h.counts.splice(c,1))),0===a.length||o===r.length-1||0===h.anchors.length||B-a[a.length-1]>t.options.gapSize)u.push(h.anchors.slice()),a.push(B);else{for((null!=(T=u[u.length-2])?T.length:void 0)?(g=u[u.length-2],b=u.pop(),a.pop()):(g=u[u.length-1],b=[]),E=h.anchors,p=0,f=E.length;f>p;p++)s=E[p],indexOf.call(g,s)<0&&g.push(s);for(d=0,_=b.length;_>d;d++)s=b[d],indexOf.call(g,s)<0&&g.push(s)}return{buckets:u,index:a,carry:h}}}(this),{buckets:[],index:[],carry:{anchors:[],counts:[],latest:0}}),this.buckets=h.buckets,this.index=h.index,this.buckets.unshift([],t,[]),this.index.unshift(0,BUCKET_TOP_THRESHOLD-1,BUCKET_TOP_THRESHOLD),this.buckets.push([],e,[]),this.index.push(window.innerHeight-BUCKET_NAV_SIZE,window.innerHeight-BUCKET_NAV_SIZE+1,window.innerHeight),s=0,l=this.buckets,r=0,i=l.length;i>r;r++)n=l[r],s=Math.max(s,n.length);return o=this.element,this.tabs||(this.tabs=$([])),this.tabs.slice(this.buckets.length).remove(),this.tabs=this.tabs.slice(0,this.buckets.length),$.each(this.buckets.slice(this.tabs.length),function(t){return function(){var n;return n=$("<div/>").appendTo(o),t.tabs.push(n[0]),n.addClass("annotator-bucket-indicator").on("mousemove",function(n){var e,o,r,i,s,u,h;for(o=t.tabs.index(n.currentTarget),s=t.annotator.anchors,u=[],r=0,i=s.length;i>r;r++)e=s[r],h=indexOf.call(t.buckets[o],e)>=0,u.push($(e.highlights).toggleClass("annotator-hl-focused",h));return u}).on("mouseout",function(n){var e,o,r,i,s,u;for(o=t.tabs.index(n.currentTarget),s=t.buckets[o],u=[],r=0,i=s.length;i>r;r++)e=s[r],u.push($(e.highlights).removeClass("annotator-hl-focused"));return u}).on("click",function(n){var e,o,r;return r=t.tabs.index(n.currentTarget),n.stopPropagation(),t.isUpper(r)?scrollToClosest(t.buckets[r],"up"):t.isLower(r)?scrollToClosest(t.buckets[r],"down"):(o=function(){var t,n,o,i;for(o=this.buckets[r],i=[],t=0,n=o.length;n>t;t++)e=o[t],i.push(e.annotation);return i}.call(t),annotator.selectAnnotations(o,n.ctrlKey||n.metaKey))})}}(this)),this._buildTabs(this.tabs,this.buckets)},n.prototype._buildTabs=function(){return this.tabs.each(function(t){return function(n,e){var o,r,i,s;return e=$(e),o=t.buckets[n],r=null!=o?o.length:void 0,s=1!==r?"Show "+r+" annotations":r>0?"Show one annotation":void 0,e.attr("title",s),e.toggleClass("upper",t.isUpper(n)),e.toggleClass("lower",t.isLower(n)),i=t.isUpper(n)||t.isLower(n)?BUCKET_NAV_SIZE:BUCKET_SIZE,e.css({top:(t.index[n]+t.index[n+1])/2,marginTop:-i/2,display:r?"":"none"}),o?e.html("<div class='label'>"+r+"</div>"):void 0}}(this))},n.prototype.isUpper=function(t){return 1===t},n.prototype.isLower=function(t){return t===this.index.length-2},n}(Annotator.Plugin),BucketBar.BUCKET_SIZE=BUCKET_SIZE,BucketBar.BUCKET_NAV_SIZE=BUCKET_NAV_SIZE,BucketBar.BUCKET_TOP_THRESHOLD=BUCKET_TOP_THRESHOLD;

},{"../highlighter":45,"annotator":62,"raf":29,"scroll-into-view":30}],51:[function(require,module,exports){
var Annotator,CrossFrame,extract,slice=[].slice,extend=function(t,n){function r(){this.constructor=t}for(var o in n)hasProp.call(n,o)&&(t[o]=n[o]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},hasProp={}.hasOwnProperty;Annotator=require("annotator"),extract=extract=function(){var t,n,r,o,e,c;for(e=arguments[0],r=2<=arguments.length?slice.call(arguments,1):[],c={},t=0,o=r.length;o>t;t++)n=r[t],e.hasOwnProperty(n)&&(c[n]=e[n]);return c},module.exports=CrossFrame=function(t){function n(t,r){var o,e,c,i;n.__super__.constructor.apply(this,arguments),i=extract(r,"server"),c=new n.Discovery(window,i),e=new n.Bridge,i=extract(r,"on","emit"),o=new n.AnnotationSync(e,i),this.pluginInit=function(){var t;return t=function(t,n,r){return e.createChannel(t,n,r)},c.startDiscovery(t)},this.destroy=function(){return Annotator.Plugin.prototype.destroy.apply(this,arguments),e.destroy(),c.stopDiscovery()},this.sync=function(t,n){return o.sync(t,n)},this.on=function(t,n){return e.on(t,n)},this.call=function(){var t,n;return n=arguments[0],t=2<=arguments.length?slice.call(arguments,1):[],e.call.apply(e,[n].concat(slice.call(t)))},this.onConnect=function(t){return e.onConnect(t)}}return extend(n,t),n}(Annotator.Plugin);

},{"annotator":62}],52:[function(require,module,exports){
"use strict";function PDFMetadata(t){this._loaded=new Promise(function(e){var n=function(){window.removeEventListener("documentload",n),e(t)};t.documentFingerprint?e(t):window.addEventListener("documentload",n)})}function fingerprintToURN(t){return"urn:x-pdf:"+String(t)}function getPDFURL(t){return 0!==t.url.indexOf("file://")?t.url:null}PDFMetadata.prototype.getUri=function(){return this._loaded.then(function(t){var e=getPDFURL(t);return e||(e=fingerprintToURN(t.documentFingerprint)),e})},PDFMetadata.prototype.getMetadata=function(){return this._loaded.then(function(t){var e=document.title;t.metadata&&t.metadata.has("dc:title")&&"Untitled"!==t.metadata.get("dc:title")?e=t.metadata.get("dc:title"):t.documentInfo&&t.documentInfo.Title&&(e=t.documentInfo.Title);var n=[{href:fingerprintToURN(t.documentFingerprint)}],i=getPDFURL(t);return i&&n.push({href:i}),{title:e,link:n,documentFingerprint:t.documentFingerprint}})},module.exports=PDFMetadata;

},{}],53:[function(require,module,exports){
var Annotator,PDF,RenderingStates,extend,extend1=function(e,t){function r(){this.constructor=e}for(var n in t)hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(e){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===e)return t;return-1};extend=require("extend"),Annotator=require("annotator"),RenderingStates=require("../pdfjs-rendering-states"),module.exports=PDF=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return extend1(t,e),t.prototype.documentLoaded=null,t.prototype.observer=null,t.prototype.pdfViewer=null,t.prototype.pluginInit=function(){var e;return this.annotator.anchoring=require("../anchoring/pdf"),e=require("./pdf-metadata"),this.pdfViewer=PDFViewerApplication.pdfViewer,this.pdfViewer.viewer.classList.add("has-transparent-text-layer"),this.pdfMetadata=new e(PDFViewerApplication),this.observer=new MutationObserver(function(e){return function(t){return e._update()}}(this)),this.observer.observe(this.pdfViewer.viewer,{attributes:!0,attributeFilter:["data-loaded"],childList:!0,subtree:!0})},t.prototype.destroy=function(){return this.pdfViewer.viewer.classList.remove("has-transparent-text-layer"),this.observer.disconnect()},t.prototype.uri=function(){return this.pdfMetadata.getUri()},t.prototype.getMetadata=function(){return this.pdfMetadata.getMetadata()},t.prototype._update=function(){var e,t,r,n,i,o,a,s,p,d,u,l,h,f,c,g,y,v,w,x,b,V,_,P;for(r=this.annotator,c=this.pdfViewer,_=[],f=o=0,y=c.pagesCount;y>=0?y>o:o>y;f=y>=0?++o:--o)if(h=c.getPageView(f),null!=(v=h.textLayer)?v.renderingDone:void 0)switch(n=null!=(w=h.div)?w:h.el,g=n.getElementsByClassName("annotator-placeholder")[0],h.renderingState){case RenderingStates.INITIAL:h.textLayer=null;break;case RenderingStates.FINISHED:null!=g&&g.parentNode.removeChild(g)}for(x=r.anchors,a=0,d=x.length;d>a;a++)if(e=x[a],null!=e.highlights&&(b=e.annotation,!(indexOf.call(_,b)>=0)))for(V=e.highlights,s=0,u=V.length;u>s;s++)if(i=V[s],!document.body.contains(i)){delete e.highlights,delete e.range,_.push(e.annotation);break}for(P=[],p=0,l=_.length;l>p;p++)t=_[p],P.push(r.anchor(t));return P},t}(Annotator.Plugin);

},{"../anchoring/pdf":36,"../pdfjs-rendering-states":49,"./pdf-metadata":52,"annotator":62,"extend":24}],54:[function(require,module,exports){
var $,Annotator,Toolbar,makeButton,extend=function(t,o){function n(){this.constructor=t}for(var i in o)hasProp.call(o,i)&&(t[i]=o[i]);return n.prototype=o.prototype,t.prototype=new n,t.__super__=o.prototype,t},hasProp={}.hasOwnProperty;Annotator=require("annotator"),$=Annotator.$,makeButton=function(t){var o,n;return o=$("<button></button>").attr("href","").attr("title",t.title).attr("name",t.name).on(t.on).addClass("annotator-frame-button").addClass(t["class"]),n=$("<li></li>").append(o),n[0]},module.exports=Toolbar=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}var n;return extend(o,t),n="annotator-hide",o.prototype.events={setVisibleHighlights:"onSetVisibleHighlights"},o.prototype.html='<div class="annotator-toolbar"></div>',o.prototype.pluginInit=function(){var t,o,n;return this.annotator.toolbar=this.toolbar=$(this.html),null!=this.options.container?$(this.options.container).append(this.toolbar):$(this.element).append(this.toolbar),o=[{title:"Toggle or Resize Sidebar","class":"annotator-frame-button--sidebar_toggle h-icon-chevron-left",name:"sidebar-toggle",on:{click:function(t){return function(o){var n;return o.preventDefault(),o.stopPropagation(),n=t.annotator.frame.hasClass("annotator-collapsed"),n?t.annotator.show():t.annotator.hide()}}(this)}},{title:"Hide Highlights","class":"h-icon-visibility",name:"highlight-visibility",on:{click:function(t){return function(o){var n;return o.preventDefault(),o.stopPropagation(),n=!t.annotator.visibleHighlights,t.annotator.setVisibleHighlights(n)}}(this)}},{title:"New Page Note","class":"h-icon-note",name:"insert-comment",on:{click:function(t){return function(o){return o.preventDefault(),o.stopPropagation(),t.annotator.createAnnotation(),t.annotator.show()}}(this)}}],this.buttons=$(function(){var n,i,e;for(e=[],n=0,i=o.length;i>n;n++)t=o[n],e.push(makeButton(t));return e}()),n=$("<ul></ul>"),this.buttons.appendTo(n),this.toolbar.append(n),this.toolbar.on("mouseup","a",function(t){return $(t.target).blur()})},o.prototype.onSetVisibleHighlights=function(t){return t?$("[name=highlight-visibility]").removeClass("h-icon-visibility-off").addClass("h-icon-visibility").prop("title","Hide Highlights"):$("[name=highlight-visibility]").removeClass("h-icon-visibility").addClass("h-icon-visibility-off").prop("title","Show Highlights")},o}(Annotator.Plugin);

},{"annotator":62}],55:[function(require,module,exports){
"use strict";function translate(e,t,n){return{left:e.left+t,top:e.top+n,width:e.width,height:e.height}}function mapViewportRectToDocument(e,t){return translate(t,e.pageXOffset,e.pageYOffset)}function isSelectionBackwards(e){if(e.focusNode===e.anchorNode)return e.focusOffset<e.anchorOffset;var t=e.getRangeAt(0);return t.startContainer===e.focusNode}function isNodeInRange(e,t){if(t===e.startContainer||t===e.endContainer)return!0;var n=t.ownerDocument.createRange();n.selectNode(t);var o=e.compareBoundaryPoints(Range.START_TO_START,n)<=0,r=e.compareBoundaryPoints(Range.END_TO_END,n)>=0;return n.detach(),o&&r}function forEachNodeInRange(e,t){for(var n,o=e.commonAncestorContainer,r=o.ownerDocument.createNodeIterator(o,NodeFilter.SHOW_ALL,null,!1);n=r.nextNode();)isNodeInRange(e,n)&&t(n)}function getTextBoundingBoxes(e){var t=/^\s*$/,n=[];forEachNodeInRange(e,function(e){e.nodeType!==Node.TEXT_NODE||e.textContent.match(t)||n.push(e)});var o=[];return n.forEach(function(t){var n=t.ownerDocument.createRange();if(n.selectNodeContents(t),t===e.startContainer&&n.setStart(t,e.startOffset),t===e.endContainer&&n.setEnd(t,e.endOffset),!n.collapsed){var r=Array.from(n.getClientRects());n.detach(),o=o.concat(r.map(function(e){return mapViewportRectToDocument(t.ownerDocument.defaultView,e)}))}}),o}function selectionFocusRect(e){if(e.isCollapsed)return null;var t=getTextBoundingBoxes(e.getRangeAt(0));return 0===t.length?null:isSelectionBackwards(e)?t[0]:t[t.length-1]}module.exports={getTextBoundingBoxes:getTextBoundingBoxes,isNodeInRange:isNodeInRange,isSelectionBackwards:isSelectionBackwards,selectionFocusRect:selectionFocusRect};

},{}],56:[function(require,module,exports){
"use strict";function selectedRange(e){var o=e.getSelection();return!o.rangeCount||o.getRangeAt(0).collapsed?null:o.getRangeAt(0)}function selections(e){var o,r=observable.listen(e,["mousedown","mouseup","selectionchange"]).filter(function(e){return"mousedown"===e.type||"mouseup"===e.type?(o="mousedown"===e.type,!1):!o}),t=observable.merge([observable.buffer(10,observable.listen(e,["mouseup"])),observable.buffer(100,r),observable.delay(0,observable.Observable.of({}))]);return t.map(function(){return selectedRange(e)})}var observable=require("./util/observable");module.exports=selections;

},{"./util/observable":60}],57:[function(require,module,exports){
"use strict";function trigger(r,t){function e(r){t(),r.stopPropagation()}var o=r.querySelectorAll("["+SIDEBAR_TRIGGER_BTN_ATTR+"]");Array.from(o).forEach(function(r){r.addEventListener("click",e)})}var SIDEBAR_TRIGGER_BTN_ATTR="data-hypothesis-trigger";module.exports=trigger;

},{}],58:[function(require,module,exports){
var Hammer,Host,MIN_RESIZE,Sidebar,annotationCounts,events,extend,raf,sidebarTrigger,bind=function(t,e){return function(){return t.apply(e,arguments)}},extend1=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;extend=require("extend"),raf=require("raf"),Hammer=require("hammerjs"),Host=require("./host"),annotationCounts=require("./annotation-counts"),sidebarTrigger=require("./sidebar-trigger"),events=require("../shared/bridge-events"),MIN_RESIZE=280,module.exports=Sidebar=function(t){function e(t,n){this.onSwipe=bind(this.onSwipe,this),this.onPan=bind(this.onPan,this);var r,i;e.__super__.constructor.apply(this,arguments),this.hide(),(n.openSidebar||n.annotations||n.query)&&this.on("panelReady",function(t){return function(){return t.show()}}(this)),null!=this.plugins.BucketBar&&this.plugins.BucketBar.element.on("click",function(t){return function(e){return t.show()}}(this)),null!=this.plugins.Toolbar&&this._setupGestures(),this.onLoginRequest=null!=(r=n.services)&&null!=(i=r[0])?i.onLoginRequest:void 0,this._setupSidebarEvents()}return extend1(e,t),e.prototype.options={Document:{},TextSelection:{},BucketBar:{container:".annotator-frame"},Toolbar:{container:".annotator-frame"}},e.prototype.renderFrame=null,e.prototype.gestureState=null,e.prototype._setupDocumentEvents=function(){return sidebarTrigger(document.body,function(t){return function(){return t.show()}}(this)),this.element.on("click",function(t){return function(e){var n;return(null!=(n=t.selectedTargets)?n.length:void 0)?void 0:t.hide()}}(this)),this.element.on("touchstart",function(t){return function(e){var n;return(null!=(n=t.selectedTargets)?n.length:void 0)?void 0:t.hide()}}(this)),this},e.prototype._setupSidebarEvents=function(){return annotationCounts(document.body,this.crossframe),this.crossframe.on("show",function(t){return function(){return t.show()}}(this)),this.crossframe.on("hide",function(t){return function(){return t.hide()}}(this)),this.crossframe.on(events.DO_LOGIN,function(t){return function(){return t.onLoginRequest?t.onLoginRequest():void 0}}(this)),this},e.prototype._setupGestures=function(){var t,e,n,r;return t=this.toolbar.find("[name=sidebar-toggle]"),t.on("touchmove",function(t){return t.preventDefault()}),e=new Hammer.Manager(t[0]).on("panstart panend panleft panright",this.onPan).on("swipeleft swiperight",this.onSwipe),n=e.add(new Hammer.Pan({direction:Hammer.DIRECTION_HORIZONTAL})),r=e.add(new Hammer.Swipe({direction:Hammer.DIRECTION_HORIZONTAL})),r.recognizeWith(n),this._initializeGestureState(),this},e.prototype._initializeGestureState=function(){return this.gestureState={initial:null,"final":null}},e.prototype._updateLayout=function(){return this.renderFrame?void 0:this.renderFrame=raf(function(t){return function(){var e,n;return t.renderFrame=null,t.gestureState["final"]!==t.gestureState.initial&&(e=t.gestureState["final"],n=-e,t.frame.css("margin-left",e+"px"),n>=MIN_RESIZE)?t.frame.css("width",n+"px"):void 0}}(this))},e.prototype.onPan=function(t){var e,n;switch(t.type){case"panstart":return this._initializeGestureState(),this.frame.addClass("annotator-no-transition"),this.frame.css("pointer-events","none"),this.gestureState.initial=parseInt(getComputedStyle(this.frame[0]).marginLeft);case"panend":return this.frame.removeClass("annotator-no-transition"),this.frame.css("pointer-events",""),this.gestureState["final"]<=-MIN_RESIZE?this.show():this.hide(),this._initializeGestureState();case"panleft":case"panright":if(null==this.gestureState.initial)return;return n=this.gestureState.initial,e=t.deltaX,this.gestureState["final"]=Math.min(Math.round(n+e),0),this._updateLayout()}},e.prototype.onSwipe=function(t){switch(t.type){case"swipeleft":return this.show();case"swiperight":return this.hide()}},e.prototype.show=function(){return this.crossframe.call("sidebarOpened"),this.frame.css({"margin-left":-1*this.frame.width()+"px"}),this.frame.removeClass("annotator-collapsed"),null!=this.toolbar?this.toolbar.find("[name=sidebar-toggle]").removeClass("h-icon-chevron-left").addClass("h-icon-chevron-right"):void 0},e.prototype.hide=function(){return this.frame.css({"margin-left":""}),this.frame.addClass("annotator-collapsed"),null!=this.toolbar?this.toolbar.find("[name=sidebar-toggle]").removeClass("h-icon-chevron-right").addClass("h-icon-chevron-left"):void 0},e.prototype.isOpen=function(){return!this.frame.hasClass("annotator-collapsed")},e.prototype.createAnnotation=function(t){return null==t&&(t={}),e.__super__.createAnnotation.apply(this,arguments),t.$highlight?void 0:this.show()},e.prototype.showAnnotations=function(t){return e.__super__.showAnnotations.apply(this,arguments),this.show()},e}(Host);

},{"../shared/bridge-events":64,"./annotation-counts":41,"./host":46,"./sidebar-trigger":57,"extend":24,"hammerjs":25,"raf":29}],59:[function(require,module,exports){
"use strict";function extractAnnotationQuery(t){var n={};try{var a=t.match(/#annotations:([A-Za-z0-9_-]+)$/),o=t.match(/#annotations:(query|q):(.+)$/i);o?n.query=decodeURI(o[2]):a?n.annotations=a[1]:n=null}catch(r){n=null}return n}module.exports={extractAnnotationQuery:extractAnnotationQuery};

},{}],60:[function(require,module,exports){
"use strict";function listen(e,n){return new Observable(function(r){var t=function(e){r.next(e)};return n.forEach(function(n){e.addEventListener(n,t)}),function(){n.forEach(function(n){e.removeEventListener(n,t)})}})}function delay(e,n){return new Observable(function(r){var t=[],u=n.subscribe({next:function(n){var u=setTimeout(function(){t=t.filter(function(e){return e!==u}),r.next(n)},e);t.push(u)}});return function(){t.forEach(clearTimeout),u.unsubscribe()}})}function buffer(e,n){return new Observable(function(r){function t(){r.next(u)}var u,i,o=n.subscribe({next:function(n){u=n,clearTimeout(i),i=setTimeout(t,e)}});return function(){o.unsubscribe(),clearTimeout(i)}})}function merge(e){return new Observable(function(n){var r=e.map(function(e){return e.subscribe({next:function(e){n.next(e)}})});return function(){r.forEach(function(e){e.unsubscribe()})}})}function drop(e,n){var r=0;return e.filter(function(){return++r,r>n})}var Observable=require("zen-observable");module.exports={buffer:buffer,delay:delay,drop:drop,listen:listen,merge:merge,Observable:Observable};

},{"zen-observable":31}],61:[function(require,module,exports){
(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},i={}.hasOwnProperty,a=function(t,e){function a(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return a.prototype=e.prototype,t.prototype=new a,t.__super__=e.prototype,t};Annotator.Plugin.Document=function(i){function r(){return this._getFavicon=e(this._getFavicon,this),this._getLinks=e(this._getLinks,this),this._getTitle=e(this._getTitle,this),this._getMetaTags=e(this._getMetaTags,this),this._getEprints=e(this._getEprints,this),this._getPrism=e(this._getPrism,this),this._getDublinCore=e(this._getDublinCore,this),this._getTwitter=e(this._getTwitter,this),this._getFacebook=e(this._getFacebook,this),this._getHighwire=e(this._getHighwire,this),this.getDocumentMetadata=e(this.getDocumentMetadata,this),this.beforeAnnotationCreated=e(this.beforeAnnotationCreated,this),this.uris=e(this.uris,this),this.uri=e(this.uri,this),t=r.__super__.constructor.apply(this,arguments)}var n;return a(r,i),n=Annotator.$,r.prototype.events={beforeAnnotationCreated:"beforeAnnotationCreated"},r.prototype.pluginInit=function(){return this.getDocumentMetadata()},r.prototype.uri=function(){var t,e,i,a,r;for(e=decodeURIComponent(document.location.href),r=this.metadata.link,i=0,a=r.length;a>i;i++)t=r[i],"canonical"===t.rel&&(e=t.href);return e},r.prototype.uris=function(){var t,e,i,a,r,n;for(i={},n=this.metadata.link,a=0,r=n.length;r>a;a++)e=n[a],e.href&&(i[e.href]=!0);return function(){var e;e=[];for(t in i)e.push(t);return e}()},r.prototype.beforeAnnotationCreated=function(t){return t.document=this.metadata},r.prototype.getDocumentMetadata=function(){return this.metadata={},this._getHighwire(),this._getDublinCore(),this._getFacebook(),this._getEprints(),this._getPrism(),this._getTwitter(),this._getFavicon(),this._getTitle(),this._getLinks(),this.metadata},r.prototype._getHighwire=function(){return this.metadata.highwire=this._getMetaTags("citation","name","_")},r.prototype._getFacebook=function(){return this.metadata.facebook=this._getMetaTags("og","property",":")},r.prototype._getTwitter=function(){return this.metadata.twitter=this._getMetaTags("twitter","name",":")},r.prototype._getDublinCore=function(){return this.metadata.dc=this._getMetaTags("dc","name",".")},r.prototype._getPrism=function(){return this.metadata.prism=this._getMetaTags("prism","name",".")},r.prototype._getEprints=function(){return this.metadata.eprints=this._getMetaTags("eprints","name",".")},r.prototype._getMetaTags=function(t,e,i){var a,r,o,s,h,p,u,l,g;for(p={},g=n("meta"),u=0,l=g.length;l>u;u++)o=g[u],h=n(o).attr(e),a=n(o).prop("content"),h&&(r=h.match(RegExp("^"+t+i+"(.+)$","i")),r&&(s=r[1],p[s]?p[s].push(a):p[s]=[a]));return p},r.prototype._getTitle=function(){return this.metadata.highwire.title?this.metadata.title=this.metadata.highwire.title[0]:this.metadata.eprints.title?this.metadata.title=this.metadata.eprints.title[0]:this.metadata.prism.title?this.metadata.title=this.metadata.prism.title[0]:this.metadata.facebook.title?this.metadata.title=this.metadata.facebook.title[0]:this.metadata.twitter.title?this.metadata.title=this.metadata.twitter.title[0]:this.metadata.dc.title?this.metadata.title=this.metadata.dc.title[0]:this.metadata.title=n("head title").text()},r.prototype._getLinks=function(){var t,e,i,a,r,o,s,h,p,u,l,g,c,f,d,m,_,y,k,b,v;for(this.metadata.link=[{href:document.location.href}],y=n("link"),g=0,d=y.length;d>g;g++)if(o=y[g],a=n(o),e=this._absoluteUrl(a.prop("href")),h=a.prop("rel"),p=a.prop("type"),r=a.prop("hreflang"),"alternate"===h||"canonical"===h||"bookmark"===h||"shortlink"===h){if("alternate"===h){if(p&&p.match(/^application\/(rss|atom)\+xml/))continue;if(r)continue}this.metadata.link.push({href:e,rel:h,type:p})}k=this.metadata.highwire;for(s in k){if(l=k[s],"pdf_url"===s)for(c=0,m=l.length;m>c;c++)u=l[c],this.metadata.link.push({href:this._absoluteUrl(u),type:"application/pdf"});if("doi"===s)for(f=0,_=l.length;_>f;f++)t=l[f],"doi:"!==t.slice(0,4)&&(t="doi:"+t),this.metadata.link.push({href:t})}b=this.metadata.dc,v=[];for(s in b)l=b[s],"identifier"===s?v.push(function(){var t,e,a;for(a=[],t=0,e=l.length;e>t;t++)i=l[t],"doi:"===i.slice(0,4)?a.push(this.metadata.link.push({href:i})):a.push(void 0);return a}.call(this)):v.push(void 0);return v},r.prototype._getFavicon=function(){var t,e,i,a,r,o;for(a=n("link"),o=[],e=0,i=a.length;i>e;e++)t=a[e],"shortcut icon"===(r=n(t).prop("rel"))||"icon"===r?o.push(this.metadata.favicon=this._absoluteUrl(t.href)):o.push(void 0);return o},r.prototype._absoluteUrl=function(t){var e;return e=document.createElement("a"),e.href=t,e.href},r}(Annotator.Plugin)}).call(this);

},{}],62:[function(require,module,exports){
(function (global){
jQuery=global.jQuery=require("jquery");var __browserify_shim_require__=require;(function(t,e,n,o,i){(function(){var t,e,n,o,i,r,s,a,l,u,h,d,c,p,f,m,g,v,y,w,E,b,N,C,_=[].slice,O={}.hasOwnProperty,T=function(t,e){function n(){this.constructor=t}for(var o in e)O.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},x=function(t,e){return function(){return t.apply(e,arguments)}};if(p=function(e){var n;return n=this.map(function(){var n,o,i,r;for(i="",n=this;(null!=n?n.nodeType:void 0)===Node.ELEMENT_NODE&&n!==e;)r=n.tagName.replace(":","\\:"),o=t(n.parentNode).children(r).index(n)+1,o="["+o+"]",i="/"+n.tagName.toLowerCase()+o+i,n=n.parentNode;return i}),n.get()},f=function(t){var e,n,o,i;return e=function(t){var e,n;return e=h(t),n=d(t),""+e+"["+n+"]"},i=t,n=function(t){var n;for(n="";t!==i;){if(null==t)throw new Error("Called getPathTo on a node which was not a descendant of @rootNode. "+i);n=e(t)+"/"+n,t=t.parentNode}return n="/"+n,n=n.replace(/\/$/,"")},o=this.map(function(){var t;return t=n(this)}),o.get()},s=function(t,e,n){var o,i,r,s,a,l;if(!t.hasChildNodes())throw new Error("XPath error: node has no children!");for(i=t.childNodes,r=0,a=0,l=i.length;l>a;a++)if(o=i[a],s=h(o),s===e&&(r+=1,r===n))return o;throw new Error("XPath error: wanted child not found.")},h=function(t){var e;switch(e=t.nodeName.toLowerCase()){case"#text":return"text()";case"#comment":return"comment()";case"#cdata-section":return"cdata-section()";default:return e}},d=function(t){var e,n;for(e=0,n=t;n;)n.nodeName===t.nodeName&&e++,n=n.previousSibling;return e},c=null,"undefined"!=typeof Gettext&&null!==Gettext?(g=new Gettext({domain:"annotator"}),c=function(t){return g.gettext(t)}):c=function(t){return t},C=function(t){return c(t)},("undefined"!=typeof jQuery&&null!==jQuery&&null!=(b=jQuery.fn)?b.jquery:void 0)||console.error(C("Annotator requires jQuery: have you included lib/vendor/jquery.js?")),JSON&&JSON.parse&&JSON.stringify||console.error(C("Annotator requires a JSON implementation: have you included lib/vendor/json2.js?")),t=jQuery,r={},r.flatten=function(e){var n;return(n=function(e){var o,i,r,s;for(i=[],r=0,s=e.length;s>r;r++)o=e[r],i=i.concat(o&&t.isArray(o)?n(o):o);return i})(e)},r.contains=function(t,e){var n;for(n=e;null!=n;){if(n===t)return!0;n=n.parentNode}return!1},r.getTextNodes=function(t){var e;return e=function(t){var n;if(t&&t.nodeType!==Node.TEXT_NODE){if(n=[],t.nodeType!==Node.COMMENT_NODE)for(t=t.lastChild;t;)n.push(e(t)),t=t.previousSibling;return n.reverse()}return t},t.map(function(){return r.flatten(e(this))})},r.getLastTextNodeUpTo=function(t){var e;switch(t.nodeType){case Node.TEXT_NODE:return t;case Node.ELEMENT_NODE:if(null!=t.lastChild&&(e=r.getLastTextNodeUpTo(t.lastChild),null!=e))return e}return t=t.previousSibling,null!=t?r.getLastTextNodeUpTo(t):null},r.getFirstTextNodeNotBefore=function(t){var e;switch(t.nodeType){case Node.TEXT_NODE:return t;case Node.ELEMENT_NODE:if(null!=t.firstChild&&(e=r.getFirstTextNodeNotBefore(t.firstChild),null!=e))return e}return t=t.nextSibling,null!=t?r.getFirstTextNodeNotBefore(t):null},r.readRangeViaSelection=function(t){var e;return e=r.getGlobal().getSelection(),e.removeAllRanges(),e.addRange(t.toRange()),e.toString()},r.xpathFromNode=function(t,e){var n,o;try{o=p.call(t,e)}catch(i){n=i,console.log("jQuery-based XPath construction failed! Falling back to manual."),o=f.call(t,e)}return o},r.nodeFromXPath=function(t,e){var n,o,i,r,a,l,u,h;for(a=t.substring(1).split("/"),i=e,l=0,u=a.length;u>l;l++)r=a[l],h=r.split("["),o=h[0],n=h[1],n=null!=n?parseInt((null!=n?n.split("]"):void 0)[0]):1,i=s(i,o.toLowerCase(),n);return i},r.escape=function(t){return t.replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},r.uuid=function(){var t;return t=0,function(){return t++}}(),r.getGlobal=function(){return function(){return this}()},r.maxZIndex=function(e){var n,o;return n=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)o=e[n],"static"===t(o).css("position")?r.push(-1):r.push(parseFloat(t(o).css("z-index"))||-1);return r}(),Math.max.apply(Math,n)},r.mousePosition=function(e,n){var o,i;return"absolute"!==(i=t(n).css("position"))&&"fixed"!==i&&"relative"!==i&&(n=t(n).offsetParent()[0]),o=t(n).offset(),{top:e.pageY-o.top,left:e.pageX-o.left}},r.preventEventDefault=function(t){return null!=t&&"function"==typeof t.preventDefault?t.preventDefault():void 0},l=["log","debug","info","warn","exception","assert","dir","dirxml","trace","group","groupEnd","groupCollapsed","time","timeEnd","profile","profileEnd","count","clear","table","error","notifyFirebug","firebug","userObjects"],"undefined"!=typeof console&&null!==console)for(null==console.group&&(console.group=function(t){return console.log("GROUP: ",t)}),null==console.groupCollapsed&&(console.groupCollapsed=console.group),v=0,w=l.length;w>v;v++)a=l[v],null==console[a]&&(console[a]=function(){return console.log(C("Not implemented:")+(" console."+name))});else{for(this.console={},y=0,E=l.length;E>y;y++)a=l[y],this.console[a]=function(){};this.console.error=function(){var t;return t=1<=arguments.length?_.call(arguments,0):[],alert("ERROR: "+t.join(", "))},this.console.warn=function(){var t;return t=1<=arguments.length?_.call(arguments,0):[],alert("WARNING: "+t.join(", "))}}n=function(){function e(e,n){this.options=t.extend(!0,{},this.options,n),this.element=t(e),this._closures={},this.on=this.subscribe,this.addEvents()}return e.prototype.events={},e.prototype.options={},e.prototype.element=null,e.prototype.destroy=function(){return this.removeEvents()},e.prototype.addEvents=function(){var t,n,o,i,r;for(i=e._parseEvents(this.events),r=[],n=0,o=i.length;o>n;n++)t=i[n],r.push(this._addEvent(t.selector,t.event,t.functionName));return r},e.prototype.removeEvents=function(){var t,n,o,i,r;for(i=e._parseEvents(this.events),r=[],n=0,o=i.length;o>n;n++)t=i[n],r.push(this._removeEvent(t.selector,t.event,t.functionName));return r},e.prototype._addEvent=function(t,n,o){var i,r=this;return i=function(){return r[o].apply(r,arguments)},""===t&&e._isCustomEvent(n)?this.subscribe(n,i):this.element.delegate(t,n,i),this._closures[""+t+"/"+n+"/"+o]=i,this},e.prototype._removeEvent=function(t,n,o){var i;return i=this._closures[""+t+"/"+n+"/"+o],""===t&&e._isCustomEvent(n)?this.unsubscribe(n,i):this.element.undelegate(t,n,i),delete this._closures[""+t+"/"+n+"/"+o],this},e.prototype.publish=function(){return this.element.triggerHandler.apply(this.element,arguments),this},e.prototype.subscribe=function(e,n){var o;return o=function(){return n.apply(this,[].slice.call(arguments,1))},o.guid=n.guid=t.guid+=1,this.element.bind(e,o),this},e.prototype.unsubscribe=function(){return this.element.unbind.apply(this.element,arguments),this},e}(),n._parseEvents=function(t){var e,n,o,i,r,s,a;n=[];for(i in t)o=t[i],a=i.split(" "),r=2<=a.length?_.call(a,0,s=a.length-1):(s=0,[]),e=a[s++],n.push({selector:r.join(" "),event:e,functionName:o});return n},n.natives=function(){var t,e,n;return e=function(){var e,o;e=jQuery.event.special,o=[];for(t in e)O.call(e,t)&&(n=e[t],o.push(t));return o}(),"blur focus focusin focusout load resize scroll unload click dblclick\nmousedown mouseup mousemove mouseover mouseout mouseenter mouseleave\nchange select submit keydown keypress keyup error".split(/[^a-z]+/).concat(e)}(),n._isCustomEvent=function(e){return e=e.split(".")[0],-1===t.inArray(e,n.natives)},i={},i.sniff=function(t){return null!=t.commonAncestorContainer?new i.BrowserRange(t):"string"==typeof t.start?new i.SerializedRange(t):t.start&&"object"==typeof t.start?new i.NormalizedRange(t):(console.error(C("Could not sniff range type")),!1)},i.nodeFromXPath=function(e,n){var o,i,s,a,l;return null==n&&(n=document),i=function(t,e){var o;null==e&&(e=null);try{return document.evaluate("."+t,n,e,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}catch(i){return o=i,console.log("XPath evaluation failed."),console.log("Trying fallback..."),r.nodeFromXPath(t,n)}},t.isXMLDoc(document.documentElement)?(o=document.createNSResolver(null===document.ownerDocument?document.documentElement:document.ownerDocument.documentElement),a=i(e,o),a||(e=function(){var t,n,o,i;for(o=e.split("/"),i=[],t=0,n=o.length;n>t;t++)l=o[t],l&&-1===l.indexOf(":")?i.push(l.replace(/^([a-z]+)/,"xhtml:$1")):i.push(l);return i}().join("/"),s=document.lookupNamespaceURI(null),o=function(t){return"xhtml"===t?s:document.documentElement.getAttribute("xmlns:"+t)},a=i(e,o)),a):i(e)},i.RangeError=function(t){function e(t,n,o){this.type=t,this.message=n,this.parent=null!=o?o:null,e.__super__.constructor.call(this,this.message)}return T(e,t),e}(Error),i.BrowserRange=function(){function t(t){this.commonAncestorContainer=t.commonAncestorContainer,this.startContainer=t.startContainer,this.startOffset=t.startOffset,this.endContainer=t.endContainer,this.endOffset=t.endOffset}return t.prototype.normalize=function(t){var e,n,o,s;if(this.tainted)return console.error(C("You may only call normalize() once on a BrowserRange!")),!1;if(this.tainted=!0,s={},this.startContainer.nodeType===Node.ELEMENT_NODE?(s.start=r.getFirstTextNodeNotBefore(this.startContainer.childNodes[this.startOffset]),s.startOffset=0):(s.start=this.startContainer,s.startOffset=this.startOffset),this.endContainer.nodeType===Node.ELEMENT_NODE){if(n=this.endContainer.childNodes[this.endOffset],null!=n){for(e=n;null!=e&&e.nodeType!==Node.TEXT_NODE;)e=e.firstChild;null!=e&&(s.end=e,s.endOffset=0)}null==s.end&&(n=this.endContainer.childNodes[this.endOffset-1],s.end=r.getLastTextNodeUpTo(n),s.endOffset=s.end.nodeValue.length)}else s.end=this.endContainer,s.endOffset=this.endOffset;for(o={},s.startOffset>0?!s.start.nextSibling||s.start.nodeValue.length>s.startOffset?o.start=s.start.splitText(s.startOffset):o.start=s.start.nextSibling:o.start=s.start,s.start===s.end?(o.start.nodeValue.length>s.endOffset-s.startOffset&&o.start.splitText(s.endOffset-s.startOffset),o.end=o.start):(s.end.nodeValue.length>s.endOffset&&s.end.splitText(s.endOffset),o.end=s.end),o.commonAncestor=this.commonAncestorContainer;o.commonAncestor.nodeType!==Node.ELEMENT_NODE;)o.commonAncestor=o.commonAncestor.parentNode;return new i.NormalizedRange(o)},t.prototype.serialize=function(t,e){return this.normalize(t).serialize(t,e)},t}(),i.NormalizedRange=function(){function e(t){this.commonAncestor=t.commonAncestor,this.start=t.start,this.end=t.end}return e.prototype.normalize=function(t){return this},e.prototype.limit=function(e){var n,o,i,r,s,a;if(n=t.grep(this.textNodes(),function(n){return n.parentNode===e||t.contains(e,n.parentNode)}),!n.length)return null;for(this.start=n[0],this.end=n[n.length-1],i=t(this.start).parents(),a=t(this.end).parents(),r=0,s=a.length;s>r;r++)if(o=a[r],-1!==i.index(o)){this.commonAncestor=o;break}return this},e.prototype.serialize=function(e,n){var o,s,a;return s=function(o,i){var s,a,l,u,h,d,c,p;for(u=n?t(o).parents(":not("+n+")").eq(0):t(o).parent(),d=r.xpathFromNode(u,e)[0],h=r.getTextNodes(u),a=h.slice(0,h.index(o)),l=0,c=0,p=a.length;p>c;c++)s=a[c],l+=s.nodeValue.length;return i?[d,l+o.nodeValue.length]:[d,l]},a=s(this.start),o=s(this.end,!0),new i.SerializedRange({start:a[0],end:o[0],startOffset:a[1],endOffset:o[1]})},e.prototype.text=function(){var t;return function(){var e,n,o,i;for(o=this.textNodes(),i=[],e=0,n=o.length;n>e;e++)t=o[e],i.push(t.nodeValue);return i}.call(this).join("")},e.prototype.textNodes=function(){var e,n,o,i;return o=r.getTextNodes(t(this.commonAncestor)),i=[o.index(this.start),o.index(this.end)],n=i[0],e=i[1],t.makeArray(o.slice(n,+e+1||9e9))},e.prototype.toRange=function(){var t;return t=document.createRange(),t.setStartBefore(this.start),t.setEndAfter(this.end),t},e}(),i.SerializedRange=function(){function e(t){this.start=t.start,this.startOffset=t.startOffset,this.end=t.end,this.endOffset=t.endOffset}return e.prototype.normalize=function(e){var n,o,s,a,l,u,h,d,c,p,f,m,g,v;for(u={},g=["start","end"],c=0,f=g.length;f>c;c++){l=g[c];try{a=i.nodeFromXPath(this[l],e)}catch(y){throw o=y,new i.RangeError(l,"Error while finding "+l+" node: "+this[l]+": "+o,o)}if(!a)throw new i.RangeError(l,"Couldn't find "+l+" node: "+this[l]);for(s=0,h=this[l+"Offset"],"end"===l&&h--,v=r.getTextNodes(t(a)),p=0,m=v.length;m>p;p++){if(d=v[p],s+d.nodeValue.length>h){u[l+"Container"]=d,u[l+"Offset"]=this[l+"Offset"]-s;break}s+=d.nodeValue.length}if(null==u[l+"Offset"])throw new i.RangeError(""+l+"offset","Couldn't find offset "+this[l+"Offset"]+" in element "+this[l])}return n=null==document.compareDocumentPosition?function(t,e){return t.contains(e)}:function(t,e){return 16&t.compareDocumentPosition(e)},t(u.startContainer).parents().each(function(){return n(this,u.endContainer)?(u.commonAncestorContainer=this,!1):void 0}),new i.BrowserRange(u).normalize(e)},e.prototype.serialize=function(t,e){return this.normalize(t).serialize(t,e)},e.prototype.toObject=function(){return{start:this.start,startOffset:this.startOffset,end:this.end,endOffset:this.endOffset}},e}(),m=this.Annotator,e=function(e){function n(e,o){return this.onDeleteAnnotation=x(this.onDeleteAnnotation,this),this.onEditAnnotation=x(this.onEditAnnotation,this),this.onAdderClick=x(this.onAdderClick,this),this.onAdderMousedown=x(this.onAdderMousedown,this),this.onHighlightMouseover=x(this.onHighlightMouseover,this),this.checkForEndSelection=x(this.checkForEndSelection,this),this.checkForStartSelection=x(this.checkForStartSelection,this),this.clearViewerHideTimer=x(this.clearViewerHideTimer,this),this.startViewerHideTimer=x(this.startViewerHideTimer,this),this.showViewer=x(this.showViewer,this),this.onEditorSubmit=x(this.onEditorSubmit,this),this.onEditorHide=x(this.onEditorHide,this),this.showEditor=x(this.showEditor,this),n.__super__.constructor.apply(this,arguments),this.plugins={},n.supported()?(this.options.readOnly||this._setupDocumentEvents(),this._setupWrapper()._setupViewer()._setupEditor(),this._setupDynamicStyle(),this.adder=t(this.html.adder).appendTo(this.wrapper).hide(),void n._instances.push(this)):this}return T(n,e),n.prototype.events={".annotator-adder button click":"onAdderClick",".annotator-adder button mousedown":"onAdderMousedown",".annotator-hl mouseover":"onHighlightMouseover",".annotator-hl mouseout":"startViewerHideTimer"},n.prototype.html={adder:'<div class="annotator-adder"><button>'+C("Annotate")+"</button></div>",wrapper:'<div class="annotator-wrapper"></div>'},n.prototype.options={readOnly:!1},n.prototype.plugins={},n.prototype.editor=null,n.prototype.viewer=null,n.prototype.selectedRanges=null,n.prototype.mouseIsDown=!1,n.prototype.ignoreMouseup=!1,n.prototype.viewerHideTimer=null,n.prototype._setupWrapper=function(){return this.wrapper=t(this.html.wrapper),this.element.find("script").remove(),this.element.wrapInner(this.wrapper),this.wrapper=this.element.find(".annotator-wrapper"),this},n.prototype._setupViewer=function(){var e=this;return this.viewer=new n.Viewer({readOnly:this.options.readOnly}),this.viewer.hide().on("edit",this.onEditAnnotation).on("delete",this.onDeleteAnnotation).addField({load:function(n,o){return o.text?t(n).html(r.escape(o.text)):t(n).html("<i>"+C("No Comment")+"</i>"),e.publish("annotationViewerTextField",[n,o])}}).element.appendTo(this.wrapper).bind({mouseover:this.clearViewerHideTimer,mouseout:this.startViewerHideTimer}),this},n.prototype._setupEditor=function(){return this.editor=new n.Editor,this.editor.hide().on("hide",this.onEditorHide).on("save",this.onEditorSubmit).addField({type:"textarea",label:C("Comments")+"…",load:function(e,n){return t(e).find("textarea").val(n.text||"")},submit:function(e,n){return n.text=t(e).find("textarea").val()}}),this.editor.element.appendTo(this.wrapper),this},n.prototype._setupDocumentEvents=function(){return t(document).bind({mouseup:this.checkForEndSelection,mousedown:this.checkForStartSelection}),this},n.prototype._setupDynamicStyle=function(){var e,n,o,i;return o=t("#annotator-dynamic-style"),o.length||(o=t('<style id="annotator-dynamic-style"></style>').appendTo(document.head)),n="*"+function(){var t,e,n,o;for(n=["adder","outer","notice","filter"],o=[],t=0,e=n.length;e>t;t++)i=n[t],o.push(":not(.annotator-"+i+")");return o}().join(""),e=r.maxZIndex(t(document.body).find(n)),e=Math.max(e,1e3),o.text([".annotator-adder, .annotator-outer, .annotator-notice {","  z-index: "+(e+20)+";","}",".annotator-filter {","  z-index: "+(e+10)+";","}"].join("\n")),this},n.prototype.destroy=function(){var e,o,i,r,s;n.__super__.destroy.apply(this,arguments),t(document).unbind({mouseup:this.checkForEndSelection,mousedown:this.checkForStartSelection}),t("#annotator-dynamic-style").remove(),this.adder.remove(),this.viewer.destroy(),this.editor.destroy(),this.wrapper.find(".annotator-hl").each(function(){return t(this).contents().insertBefore(this),t(this).remove()}),this.wrapper.contents().insertBefore(this.wrapper),this.wrapper.remove(),this.element.data("annotator",null),s=this.plugins;for(o in s)i=s[o],"function"==typeof(r=this.plugins[o]).destroy&&r.destroy();return e=n._instances.indexOf(this),-1!==e?n._instances.splice(e,1):void 0},n.prototype.getSelectedRanges=function(){var e,n,o,s,a,l,u,h,d;for(u=r.getGlobal().getSelection(),a=[],l=[],u.isCollapsed||(a=function(){var t,r,a;for(a=[],n=t=0,r=u.rangeCount;r>=0?r>t:t>r;n=r>=0?++t:--t)s=u.getRangeAt(n),e=new i.BrowserRange(s),o=e.normalize().limit(this.wrapper[0]),null===o&&l.push(s),a.push(o);return a}.call(this),u.removeAllRanges()),h=0,d=l.length;d>h;h++)s=l[h],u.addRange(s);return t.grep(a,function(t){return t&&u.addRange(t.toRange()),t})},n.prototype.createAnnotation=function(){var t;return t={},this.publish("beforeAnnotationCreated",[t]),t},n.prototype.setupAnnotation=function(e){var n,o,r,s,a,l,u,h,d,c;for(a=this.wrapper[0],e.ranges||(e.ranges=this.selectedRanges),r=[],c=e.ranges,l=0,h=c.length;h>l;l++){s=c[l];try{r.push(i.sniff(s).normalize(a))}catch(p){if(n=p,!(n instanceof i.RangeError))throw n;this.publish("rangeNormalizeFail",[e,s,n])}}for(e.quote=[],e.ranges=[],e.highlights=[],u=0,d=r.length;d>u;u++)o=r[u],e.quote.push(t.trim(o.text())),e.ranges.push(o.serialize(this.wrapper[0],".annotator-hl")),t.merge(e.highlights,this.highlightRange(o));return e.quote=e.quote.join(" / "),t(e.highlights).data("annotation",e),t(e.highlights).attr("data-annotation-id",e.id),e},n.prototype.updateAnnotation=function(e){return this.publish("beforeAnnotationUpdated",[e]),t(e.highlights).attr("data-annotation-id",e.id),this.publish("annotationUpdated",[e]),e},n.prototype.deleteAnnotation=function(e){var n,o,i,r,s;if(null!=e.highlights)for(s=e.highlights,i=0,r=s.length;r>i;i++)o=s[i],null!=o.parentNode&&(n=o.childNodes[0],t(o).replaceWith(o.childNodes));return this.publish("annotationDeleted",[e]),e},n.prototype.loadAnnotations=function(t){var e,n,o=this;return null==t&&(t=[]),n=function(t){var i,r,s,a;for(null==t&&(t=[]),r=t.splice(0,10),s=0,a=r.length;a>s;s++)i=r[s],o.setupAnnotation(i);return t.length>0?setTimeout(function(){return n(t)},10):o.publish("annotationsLoaded",[e])},e=t.slice(),n(t),this},n.prototype.dumpAnnotations=function(){return this.plugins.Store?this.plugins.Store.dumpAnnotations():(console.warn(C("Can't dump annotations without Store plugin.")),!1)},n.prototype.highlightRange=function(e,n){var o,i,r,s,a,l,u;for(null==n&&(n="annotator-hl"),r=/^\s*$/,o=t("<span class='"+n+"'></span>"),l=e.textNodes(),u=[],s=0,a=l.length;a>s;s++)i=l[s],r.test(i.nodeValue)||u.push(t(i).wrapAll(o).parent().show()[0]);return u},n.prototype.highlightRanges=function(e,n){var o,i,r,s;for(null==n&&(n="annotator-hl"),o=[],r=0,s=e.length;s>r;r++)i=e[r],t.merge(o,this.highlightRange(i,n));return o},n.prototype.addPlugin=function(t,e){var o,i;return this.plugins[t]?console.error(C("You cannot have more than one instance of any plugin.")):(o=n.Plugin[t],"function"==typeof o?(this.plugins[t]=new o(this.element[0],e),this.plugins[t].annotator=this,"function"==typeof(i=this.plugins[t]).pluginInit&&i.pluginInit()):console.error(C("Could not load ")+t+C(" plugin. Have you included the appropriate <script> tag?"))),this},n.prototype.showEditor=function(t,e){return this.editor.element.css(e),this.editor.load(t),this.publish("annotationEditorShown",[this.editor,t]),this},n.prototype.onEditorHide=function(){return this.publish("annotationEditorHidden",[this.editor]),this.ignoreMouseup=!1},n.prototype.onEditorSubmit=function(t){return this.publish("annotationEditorSubmit",[this.editor,t])},n.prototype.showViewer=function(t,e){return this.viewer.element.css(e),this.viewer.load(t),this.publish("annotationViewerShown",[this.viewer,t])},n.prototype.startViewerHideTimer=function(){return this.viewerHideTimer?void 0:this.viewerHideTimer=setTimeout(this.viewer.hide,250)},n.prototype.clearViewerHideTimer=function(){return clearTimeout(this.viewerHideTimer),this.viewerHideTimer=!1},n.prototype.checkForStartSelection=function(t){return t&&this.isAnnotator(t.target)||this.startViewerHideTimer(),this.mouseIsDown=!0},n.prototype.checkForEndSelection=function(t){var e,n,o,i,s;if(this.mouseIsDown=!1,!this.ignoreMouseup){for(this.selectedRanges=this.getSelectedRanges(),s=this.selectedRanges,o=0,i=s.length;i>o;o++)if(n=s[o],e=n.commonAncestor,this.isAnnotator(e))return;return t&&this.selectedRanges.length?this.adder.css(r.mousePosition(t,this.wrapper[0])).show():this.adder.hide()}},n.prototype.isAnnotator=function(e){return!!t(e).parents().addBack().filter("[class^=annotator-]").not("[class=annotator-hl]").not(this.wrapper).length},n.prototype.onHighlightMouseover=function(e){var n;return this.clearViewerHideTimer(),this.mouseIsDown?!1:(this.viewer.isShown()&&this.viewer.hide(),n=t(e.target).parents(".annotator-hl").addBack().map(function(){return t(this).data("annotation")}).toArray(),this.showViewer(n,r.mousePosition(e,this.wrapper[0])))},n.prototype.onAdderMousedown=function(t){return null!=t&&t.preventDefault(),this.ignoreMouseup=!0},n.prototype.onAdderClick=function(e){var n,o,i,r,s,a=this;return null!=e&&e.preventDefault(),r=this.adder.position(),this.adder.hide(),n=this.setupAnnotation(this.createAnnotation()),t(n.highlights).addClass("annotator-hl-temporary"),s=function(){return i(),t(n.highlights).removeClass("annotator-hl-temporary"),a.publish("annotationCreated",[n])},o=function(){return i(),a.deleteAnnotation(n)},i=function(){return a.unsubscribe("annotationEditorHidden",o),a.unsubscribe("annotationEditorSubmit",s)},this.subscribe("annotationEditorHidden",o),this.subscribe("annotationEditorSubmit",s),this.showEditor(n,r)},n.prototype.onEditAnnotation=function(t){var e,n,o,i=this;return n=this.viewer.element.position(),o=function(){return e(),i.updateAnnotation(t)},e=function(){return i.unsubscribe("annotationEditorHidden",e),i.unsubscribe("annotationEditorSubmit",o)},this.subscribe("annotationEditorHidden",e),this.subscribe("annotationEditorSubmit",o),this.viewer.hide(),this.showEditor(t,n)},n.prototype.onDeleteAnnotation=function(t){return this.viewer.hide(),this.deleteAnnotation(t)},n}(n),e.Plugin=function(t){function e(t,n){e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.pluginInit=function(){},e}(n),u=r.getGlobal(),null==(null!=(N=u.document)?N.evaluate:void 0)&&t.getScript("http://assets.annotateit.org/vendor/xpath.min.js"),null==u.getSelection&&t.getScript("http://assets.annotateit.org/vendor/ierange.min.js"),null==u.JSON&&t.getScript("http://assets.annotateit.org/vendor/json2.min.js"),null==u.Node&&(u.Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),e.$=t,e.Delegator=n,e.Range=i,e.Util=r,e._instances=[],e._t=C,e.supported=function(){return function(){return!!this.getSelection}()},e.noConflict=function(){return r.getGlobal().Annotator=m,this},t.fn.annotator=function(n){var o;return o=Array.prototype.slice.call(arguments,1),this.each(function(){var i;return i=t.data(this,"annotator"),"destroy"===n?(t.removeData(this,"annotator"),null!=i?i.destroy(o):void 0):i?n&&i[n].apply(i,o):(i=new e(this,n),t.data(this,"annotator",i))})},this.Annotator=e,e.Widget=function(n){function o(n,i){o.__super__.constructor.apply(this,arguments),this.classes=t.extend({},e.Widget.prototype.classes,this.classes)}return T(o,n),o.prototype.classes={hide:"annotator-hide",invert:{x:"annotator-invert-x",y:"annotator-invert-y"}},o.prototype.destroy=function(){return this.removeEvents(),this.element.remove()},o.prototype.checkOrientation=function(){var n,o,i,r,s;return this.resetOrientation(),s=t(e.Util.getGlobal()),r=this.element.children(":first"),o=r.offset(),i={top:s.scrollTop(),right:s.width()+s.scrollLeft()},n={top:o.top,right:o.left+r.width()},n.top-i.top<0&&this.invertY(),n.right-i.right>0&&this.invertX(),this},o.prototype.resetOrientation=function(){return this.element.removeClass(this.classes.invert.x).removeClass(this.classes.invert.y),this},o.prototype.invertX=function(){return this.element.addClass(this.classes.invert.x),this},o.prototype.invertY=function(){return this.element.addClass(this.classes.invert.y),this},o.prototype.isInvertedY=function(){return this.element.hasClass(this.classes.invert.y)},o.prototype.isInvertedX=function(){return this.element.hasClass(this.classes.invert.x)},o}(n),e.Editor=function(n){function o(e){this.onCancelButtonMouseover=x(this.onCancelButtonMouseover,this),this.processKeypress=x(this.processKeypress,this),this.submit=x(this.submit,this),this.load=x(this.load,this),this.hide=x(this.hide,this),this.show=x(this.show,this),o.__super__.constructor.call(this,t(this.html)[0],e),this.fields=[],this.annotation={}}return T(o,n),o.prototype.events={"form submit":"submit",".annotator-save click":"submit",".annotator-cancel click":"hide",".annotator-cancel mouseover":"onCancelButtonMouseover","textarea keydown":"processKeypress"},o.prototype.classes={hide:"annotator-hide",focus:"annotator-focus"},o.prototype.html='<div class="annotator-outer annotator-editor">\n  <form class="annotator-widget">\n    <ul class="annotator-listing"></ul>\n    <div class="annotator-controls">\n      <a href="#cancel" class="annotator-cancel">'+C("Cancel")+'</a>\n<a href="#save" class="annotator-save annotator-focus">'+C("Save")+"</a>\n    </div>\n  </form>\n</div>",o.prototype.options={},o.prototype.show=function(t){return e.Util.preventEventDefault(t),this.element.removeClass(this.classes.hide),this.element.find(".annotator-save").addClass(this.classes.focus),this.checkOrientation(),this.element.find(":input:first").focus(),this.setupDraggables(),this.publish("show")},o.prototype.hide=function(t){return e.Util.preventEventDefault(t),this.element.addClass(this.classes.hide),this.publish("hide")},o.prototype.load=function(t){var e,n,o,i;for(this.annotation=t,this.publish("load",[this.annotation]),i=this.fields,n=0,o=i.length;o>n;n++)e=i[n],e.load(e.element,this.annotation);return this.show()},o.prototype.submit=function(t){var n,o,i,r;for(e.Util.preventEventDefault(t),r=this.fields,o=0,i=r.length;i>o;o++)n=r[o],n.submit(n.element,this.annotation);return this.publish("save",[this.annotation]),this.hide()},o.prototype.addField=function(n){var o,i,r;switch(i=t.extend({id:"annotator-field-"+e.Util.uuid(),type:"input",label:"",load:function(){},submit:function(){}},n),r=null,o=t('<li class="annotator-item" />'),i.element=o[0],i.type){case"textarea":r=t("<textarea />");break;case"input":case"checkbox":r=t("<input />");break;case"select":r=t("<select />")}return o.append(r),r.attr({id:i.id,placeholder:i.label}),"checkbox"===i.type&&(r[0].type="checkbox",o.addClass("annotator-checkbox"),o.append(t("<label />",{"for":i.id,html:i.label}))),this.element.find("ul:first").append(o),this.fields.push(i),i.element},o.prototype.checkOrientation=function(){var t,e;return o.__super__.checkOrientation.apply(this,arguments),e=this.element.find("ul"),t=this.element.find(".annotator-controls"),this.element.hasClass(this.classes.invert.y)?t.insertBefore(e):t.is(":first-child")&&t.insertAfter(e),this},o.prototype.processKeypress=function(t){return 27===t.keyCode?this.hide():13!==t.keyCode||t.shiftKey?void 0:this.submit()},o.prototype.onCancelButtonMouseover=function(){return this.element.find("."+this.classes.focus).removeClass(this.classes.focus)},o.prototype.setupDraggables=function(){var e,n,o,i,r,s,a,l,u,h,d;return this.element.find(".annotator-resize").remove(),o=this.element.hasClass(this.classes.invert.y)?this.element.find(".annotator-item:last"):this.element.find(".annotator-item:first"),o&&t('<span class="annotator-resize"></span>').appendTo(o),r=null,e=this.classes,i=this.element,h=null,u=i.find(".annotator-resize"),n=i.find(".annotator-controls"),d=!1,s=function(e){return e.target===this?(r={element:this,top:e.pageY,left:e.pageX},h=i.find("textarea:first"),t(window).bind({"mouseup.annotator-editor-resize":l,"mousemove.annotator-editor-resize":a}),e.preventDefault()):void 0},l=function(){return r=null,t(window).unbind(".annotator-editor-resize")},a=function(t){var o,s,a,l,c;return r&&d===!1?(o={top:t.pageY-r.top,left:t.pageX-r.left},r.element===u[0]?(l=h.height(),c=h.width(),s=i.hasClass(e.invert.x)?-1:1,a=i.hasClass(e.invert.y)?1:-1,h.height(l+o.top*a),h.width(c+o.left*s),h.height()!==l&&(r.top=t.pageY),h.width()!==c&&(r.left=t.pageX)):r.element===n[0]&&(i.css({top:parseInt(i.css("top"),10)+o.top,left:parseInt(i.css("left"),10)+o.left}),r.top=t.pageY,r.left=t.pageX),d=!0,setTimeout(function(){return d=!1},1e3/60)):void 0},u.bind("mousedown",s),n.bind("mousedown",s)},o}(e.Widget),e.Viewer=function(n){function i(e){this.onDeleteClick=x(this.onDeleteClick,this),this.onEditClick=x(this.onEditClick,this),this.load=x(this.load,this),this.hide=x(this.hide,this),this.show=x(this.show,this),i.__super__.constructor.call(this,t(this.html.element)[0],e),this.item=t(this.html.item)[0],this.fields=[],this.annotations=[]}return T(i,n),i.prototype.events={".annotator-edit click":"onEditClick",".annotator-delete click":"onDeleteClick"},i.prototype.classes={hide:"annotator-hide",showControls:"annotator-visible"},i.prototype.html={element:'<div class="annotator-outer annotator-viewer">\n  <ul class="annotator-widget annotator-listing"></ul>\n</div>',item:'<li class="annotator-annotation annotator-item">\n  <span class="annotator-controls">\n    <a href="#" title="View as webpage" class="annotator-link">View as webpage</a>\n    <button title="Edit" class="annotator-edit">Edit</button>\n    <button title="Delete" class="annotator-delete">Delete</button>\n  </span>\n</li>'},i.prototype.options={readOnly:!1},i.prototype.show=function(t){var n,o=this;return e.Util.preventEventDefault(t),n=this.element.find(".annotator-controls").addClass(this.classes.showControls),setTimeout(function(){return n.removeClass(o.classes.showControls)},500),this.element.removeClass(this.classes.hide),this.checkOrientation().publish("show")},i.prototype.isShown=function(){return!this.element.hasClass(this.classes.hide)},i.prototype.hide=function(t){return e.Util.preventEventDefault(t),this.element.addClass(this.classes.hide),this.publish("hide")},i.prototype.load=function(e){var n,i,r,s,a,l,u,h,d,c,p,f,m,g,v,y,w;for(this.annotations=e||[],p=this.element.find("ul:first").empty(),y=this.annotations,f=0,g=y.length;g>f;f++)for(n=y[f],h=t(this.item).clone().appendTo(p).data("annotation",n),r=h.find(".annotator-controls"),d=r.find(".annotator-link"),a=r.find(".annotator-edit"),s=r.find(".annotator-delete"),c=new o(n.links||[]).get("alternate",{type:"text/html"}),0===c.length||null==c[0].href?d.remove():d.attr("href",c[0].href),this.options.readOnly?(a.remove(),s.remove()):i={showEdit:function(){return a.removeAttr("disabled")},hideEdit:function(){return a.attr("disabled","disabled")},showDelete:function(){return s.removeAttr("disabled")},hideDelete:function(){return s.attr("disabled","disabled")}},w=this.fields,m=0,v=w.length;v>m;m++)u=w[m],l=t(u.element).clone().appendTo(h)[0],u.load(l,n,i);
return this.publish("load",[this.annotations]),this.show()},i.prototype.addField=function(e){var n;return n=t.extend({load:function(){}},e),n.element=t("<div />")[0],this.fields.push(n),n.element,this},i.prototype.onEditClick=function(t){return this.onButtonClick(t,"edit")},i.prototype.onDeleteClick=function(t){return this.onButtonClick(t,"delete")},i.prototype.onButtonClick=function(e,n){var o;return o=t(e.target).parents(".annotator-annotation"),this.publish(n,[o.data("annotation")])},i}(e.Widget),o=function(){function e(t){this.data=t}return e.prototype.get=function(e,n){var o,i,r,s,a,l,u,h,d;for(null==n&&(n={}),n=t.extend({},n,{rel:e}),r=function(){var t;t=[];for(i in n)O.call(n,i)&&(a=n[i],t.push(i));return t}(),h=this.data,d=[],l=0,u=h.length;u>l;l++)o=h[l],s=r.reduce(function(t,e){return t&&o[e]===n[e]},!0),s&&d.push(o);return d},e}(),e=e||{},e.Notification=function(n){function o(e){this.hide=x(this.hide,this),this.show=x(this.show,this),o.__super__.constructor.call(this,t(this.options.html).appendTo(document.body)[0],e)}return T(o,n),o.prototype.events={click:"hide"},o.prototype.options={html:"<div class='annotator-notice'></div>",classes:{show:"annotator-notice-show",info:"annotator-notice-info",success:"annotator-notice-success",error:"annotator-notice-error"}},o.prototype.show=function(n,o){return null==o&&(o=e.Notification.INFO),this.currentStatus=o,t(this.element).addClass(this.options.classes.show).addClass(this.options.classes[this.currentStatus]).html(r.escape(n||"")),setTimeout(this.hide,5e3),this},o.prototype.hide=function(){return null==this.currentStatus&&(this.currentStatus=e.Notification.INFO),t(this.element).removeClass(this.options.classes.show).removeClass(this.options.classes[this.currentStatus]),this},o}(n),e.Notification.INFO="info",e.Notification.SUCCESS="success",e.Notification.ERROR="error",t(function(){var t;return t=new e.Notification,e.showNotification=t.show,e.hideNotification=t.hide})}).call(this),i("undefined"!=typeof Annotator?Annotator:window.Annotator)}).call(global,void 0,void 0,void 0,void 0,function(t){module.exports=t});

}).call(this,window)

},{"jquery":"jquery"}],63:[function(require,module,exports){
!function(){function t(t){return function(){return this[t]}}function n(t){return function(){return t}}function e(t){var n=typeof t;if("object"==n){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return n;var e=Object.prototype.toString.call(t);if("[object Window]"==e)return"object";if("[object Array]"==e||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==e||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==n&&"undefined"==typeof t.call)return"object";return n}function r(t){return"string"==typeof t}function i(t,n,e){return t.call.apply(t.bind,arguments)}function o(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function a(t,n,e){return a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:o,a.apply(null,arguments)}function u(t,n){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function s(t){function n(){}var e=tt;n.prototype=e.prototype,t.u=e.prototype,t.prototype=new n,t.t=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function c(t,n,e){this.a=t,this.b=n||1,this.d=e||1}function f(t,n){return-1!=t.indexOf(n)}function l(t,n){return n>t?-1:t>n?1:0}function h(t,n){var e;t:{e=t.length;for(var i=r(t)?t.split(""):t,o=0;e>o;o++)if(o in i&&n.call(void 0,i[o],o,t)){e=o;break t}e=-1}return 0>e?null:r(t)?t.charAt(e):t[e]}function p(t){return Wt.concat.apply(Wt,arguments)}function d(t,n,e){return 2>=arguments.length?Wt.slice.call(t,n):Wt.slice.call(t,n,e)}function g(t){var n=arguments.length;if(1==n&&"array"==e(arguments[0]))return g.apply(null,arguments[0]);for(var r={},i=0;n>i;i++)r[arguments[i]]=!0;return r}function v(){return f(Gt,"Edge")}function w(){var t=Gt;return an?/rv\:([^\);]+)(\)|;)/.exec(t):on&&v()?/Edge\/([\d\.]+)/.exec(t):on?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):un?/WebKit\/(\S+)/.exec(t):void 0}function b(){var t=qt.document;return t?t.documentMode:void 0}function y(t){if(!cn[t]){for(var n=0,e=Kt(String(sn)).split("."),r=Kt(String(t)).split("."),i=Math.max(e.length,r.length),o=0;0==n&&i>o;o++){var a=e[o]||"",u=r[o]||"",s=RegExp("(\\d*)(\\D*)","g"),c=RegExp("(\\d*)(\\D*)","g");do{var f=s.exec(a)||["","",""],h=c.exec(u)||["","",""];if(0==f[0].length&&0==h[0].length)break;n=l(0==f[1].length?0:parseInt(f[1],10),0==h[1].length?0:parseInt(h[1],10))||l(0==f[2].length,0==h[2].length)||l(f[2],h[2])}while(0==n)}cn[t]=n>=0}}function m(t){return on&&(v()||hn>=t)}function E(t,n,e,r){this.a=t,this.nodeName=e,this.nodeValue=r,this.nodeType=2,this.parentNode=this.ownerElement=n}function x(t,n){var e=dn&&"href"==n.nodeName?t.getAttribute(n.nodeName,2):n.nodeValue;return new E(n,t,n.nodeName,e)}function N(t){this.b=t,this.a=0}function S(t){t=t.match(gn);for(var n=0;n<t.length;n++)vn.test(t[n])&&t.splice(n,1);return new N(t)}function T(t,n){return t.b[t.a+(n||0)]}function k(t){return t.b[t.a++]}function I(t){return t.b.length<=t.a}function O(t,n){if(t.contains&&1==n.nodeType)return t==n||t.contains(n);if("undefined"!=typeof t.compareDocumentPosition)return t==n||Boolean(16&t.compareDocumentPosition(n));for(;n&&t!=n;)n=n.parentNode;return n==t}function R(t,n){if(t==n)return 0;if(t.compareDocumentPosition)return 2&t.compareDocumentPosition(n)?1:-1;if(on&&!m(9)){if(9==t.nodeType)return-1;if(9==n.nodeType)return 1}if("sourceIndex"in t||t.parentNode&&"sourceIndex"in t.parentNode){var e=1==t.nodeType,r=1==n.nodeType;if(e&&r)return t.sourceIndex-n.sourceIndex;var i=t.parentNode,o=n.parentNode;return i==o?P(t,n):!e&&O(i,n)?-1*A(t,n):!r&&O(o,t)?A(n,t):(e?t.sourceIndex:i.sourceIndex)-(r?n.sourceIndex:o.sourceIndex)}return r=9==t.nodeType?t:t.ownerDocument||t.document,e=r.createRange(),e.selectNode(t),e.collapse(!0),r=r.createRange(),r.selectNode(n),r.collapse(!0),e.compareBoundaryPoints(qt.Range.START_TO_END,r)}function A(t,n){var e=t.parentNode;if(e==n)return-1;for(var r=n;r.parentNode!=e;)r=r.parentNode;return P(r,t)}function P(t,n){for(var e=n;e=e.previousSibling;)if(e==t)return-1;return 1}function D(t){var n=null,e=t.nodeType;if(1==e&&(n=t.textContent,n=void 0==n||null==n?t.innerText:n,n=void 0==n||null==n?"":n),"string"!=typeof n)if(pn&&"title"==t.nodeName.toLowerCase()&&1==e)n=t.text;else if(9==e||1==e){t=9==e?t.documentElement:t.firstChild;for(var e=0,r=[],n="";t;){do 1!=t.nodeType&&(n+=t.nodeValue),pn&&"title"==t.nodeName.toLowerCase()&&(n+=t.text),r[e++]=t;while(t=t.firstChild);for(;e&&!(t=r[--e].nextSibling););}}else n=t.nodeValue;return""+n}function _(t,n,e){if(null===n)return!0;try{if(!t.getAttribute)return!1}catch(r){return!1}return dn&&"class"==n&&(n="className"),null==e?!!t.getAttribute(n):t.getAttribute(n,2)==e}function M(t,n,e,i,o){return(pn?C:B).call(null,t,n,r(e)?e:null,r(i)?i:null,o||new Y)}function C(t,n,e,r,i){if(t instanceof bt||8==t.b||e&&null===t.b){var o=n.all;if(!o)return i;if(t=F(t),"*"!=t&&(o=n.getElementsByTagName(t),!o))return i;if(e){for(var a=[],u=0;n=o[u++];)_(n,e,r)&&a.push(n);o=a}for(u=0;n=o[u++];)"*"==t&&"!"==n.tagName||$(i,n);return i}return L(t,n,e,r,i),i}function B(t,n,e,r,i){return n.getElementsByName&&r&&"name"==e&&!on?(n=n.getElementsByName(r),Jt(n,function(n){t.a(n)&&$(i,n)})):n.getElementsByClassName&&r&&"class"==e?(n=n.getElementsByClassName(r),Jt(n,function(n){n.className==r&&t.a(n)&&$(i,n)})):t instanceof gt?L(t,n,e,r,i):n.getElementsByTagName&&(n=n.getElementsByTagName(t.d()),Jt(n,function(t){_(t,e,r)&&$(i,t)})),i}function j(t,n,e,r,i){var o;if((t instanceof bt||8==t.b||e&&null===t.b)&&(o=n.childNodes)){var a=F(t);return"*"==a||(o=Qt(o,function(t){return t.tagName&&t.tagName.toLowerCase()==a}))?(e&&(o=Qt(o,function(t){return _(t,e,r)})),Jt(o,function(t){"*"==a&&("!"==t.tagName||"*"==a&&1!=t.nodeType)||$(i,t)}),i):i}return U(t,n,e,r,i)}function U(t,n,e,r,i){for(n=n.firstChild;n;n=n.nextSibling)_(n,e,r)&&t.a(n)&&$(i,n);return i}function L(t,n,e,r,i){for(n=n.firstChild;n;n=n.nextSibling)_(n,e,r)&&t.a(n)&&$(i,n),L(t,n,e,r,i)}function F(t){if(t instanceof gt){if(8==t.b)return"!";if(null===t.b)return"*"}return t.d()}function Y(){this.b=this.a=null,this.i=0}function V(t){this.d=t,this.a=this.b=null}function H(t,n){if(!t.a)return n;if(!n.a)return t;for(var e=t.a,r=n.a,i=null,o=null,a=0;e&&r;){var o=e.d,u=r.d;o==u||o instanceof E&&u instanceof E&&o.a==u.a?(o=e,e=e.a,r=r.a):0<R(e.d,r.d)?(o=r,r=r.a):(o=e,e=e.a),(o.b=i)?i.a=o:t.a=o,i=o,a++}for(o=e||r;o;)o.b=i,i=i.a=o,a++,o=o.a;return t.b=i,t.i=a,t}function X(t,n){var e=new V(n);e.a=t.a,t.b?t.a.b=e:t.a=t.b=e,t.a=e,t.i++}function $(t,n){var e=new V(n);e.b=t.b,t.a?t.b.a=e:t.a=t.b=e,t.b=e,t.i++}function q(t){return(t=t.a)?t.d:null}function G(t){return(t=q(t))?D(t):""}function K(t,n){return new W(t,!!n)}function W(t,n){this.d=t,this.b=(this.c=n)?t.b:t.a,this.a=null}function z(t){var n=t.b;if(null==n)return null;var e=t.a=n;return t.b=t.c?n.b:n.a,e.d}function J(t){switch(t.nodeType){case 1:return u(Z,t);case 9:return J(t.documentElement);case 11:case 10:case 6:case 12:return Q;default:return t.parentNode?J(t.parentNode):Q}}function Q(){return null}function Z(t,n){if(t.prefix==n)return t.namespaceURI||"http://www.w3.org/1999/xhtml";var e=t.getAttributeNode("xmlns:"+n);return e&&e.specified?e.value||null:t.parentNode&&9!=t.parentNode.nodeType?Z(t.parentNode,n):null}function tt(t){this.g=t,this.b=this.e=!1,this.d=null}function nt(t){return"\n  "+t.toString().split("\n").join("\n  ")}function et(t,n){t.e=n}function rt(t,n){t.b=n}function it(t,n){var e=t.a(n);return e instanceof Y?+G(e):+e}function ot(t,n){var e=t.a(n);return e instanceof Y?G(e):""+e}function at(t,n){var e=t.a(n);return e instanceof Y?!!e.i:!!e}function ut(t,n,e){tt.call(this,t.g),this.c=t,this.f=n,this.k=e,this.e=n.e||e.e,this.b=n.b||e.b,this.c==bn&&(e.b||e.e||4==e.g||0==e.g||!n.d?n.b||n.e||4==n.g||0==n.g||!e.d||(this.d={name:e.d.name,l:n}):this.d={name:n.d.name,l:e})}function st(t,n,e,r,i){n=n.a(r),e=e.a(r);var o;if(n instanceof Y&&e instanceof Y){for(i=K(n),r=z(i);r;r=z(i))for(n=K(e),o=z(n);o;o=z(n))if(t(D(r),D(o)))return!0;return!1}if(n instanceof Y||e instanceof Y){for(n instanceof Y?i=n:(i=e,e=n),i=K(i),n=typeof e,r=z(i);r;r=z(i)){switch(n){case"number":r=+D(r);break;case"boolean":r=!!D(r);break;case"string":r=D(r);break;default:throw Error("Illegal primitive type for comparison.")}if(t(r,e))return!0}return!1}return i?"boolean"==typeof n||"boolean"==typeof e?t(!!n,!!e):"number"==typeof n||"number"==typeof e?t(+n,+e):t(n,e):t(+n,+e)}function ct(t,n,e,r){this.a=t,this.p=n,this.g=e,this.j=r}function ft(t,n,e,r){if(wn.hasOwnProperty(t))throw Error("Binary operator already created: "+t);return t=new ct(t,n,e,r),wn[t.toString()]=t}function lt(t,n){if(n.a.length&&4!=t.g)throw Error("Primary expression must evaluate to nodeset if filter has predicate(s).");tt.call(this,t.g),this.c=t,this.f=n,this.e=t.e,this.b=t.b}function ht(t,n){if(n.length<t.o)throw Error("Function "+t.h+" expects at least"+t.o+" arguments, "+n.length+" given");if(null!==t.n&&n.length>t.n)throw Error("Function "+t.h+" expects at most "+t.n+" arguments, "+n.length+" given");t.s&&Jt(n,function(n,e){if(4!=n.g)throw Error("Argument "+e+" to function "+t.h+" is not of type Nodeset: "+n)}),tt.call(this,t.g),this.f=t,this.c=n,et(this,t.e||tn(n,function(t){return t.e})),rt(this,t.r&&!n.length||t.q&&!!n.length||tn(n,function(t){return t.b}))}function pt(t,n,e,r,i,o,a,u,s){this.h=t,this.g=n,this.e=e,this.r=r,this.q=i,this.j=o,this.o=a,this.n=void 0!==u?u:a,this.s=!!s}function dt(t,n,e,r,i,o,a,u){if(yn.hasOwnProperty(t))throw Error("Function already created: "+t+".");yn[t]=new pt(t,n,e,r,!1,i,o,a,u)}function gt(t,n){switch(this.f=t,this.c=void 0!==n?n:null,this.b=null,t){case"comment":this.b=8;break;case"text":this.b=3;break;case"processing-instruction":this.b=7;break;case"node":break;default:throw Error("Unexpected argument")}}function vt(t){return"comment"==t||"text"==t||"processing-instruction"==t||"node"==t}function wt(t){tt.call(this,3),this.c=t.substring(1,t.length-1)}function bt(t,n){this.h=t.toLowerCase(),this.c=n?n.toLowerCase():"http://www.w3.org/1999/xhtml"}function yt(t){tt.call(this,1),this.c=t}function mt(t,n){if(tt.call(this,t.g),this.f=t,this.c=n,this.e=t.e,this.b=t.b,1==this.c.length){var e=this.c[0];e.m||e.c!=En||(e=e.k,"*"!=e.d()&&(this.d={name:e.d(),l:null}))}}function Et(){tt.call(this,4)}function xt(){tt.call(this,4)}function Nt(t){return"/"==t||"//"==t}function St(t,n){this.a=t,this.b=!!n}function Tt(t,n,e){for(e=e||0;e<t.a.length;e++)for(var r,i=t.a[e],o=K(n),a=n.i,u=0;r=z(o);u++){var s=t.b?a-u:u+1;if(r=i.a(new c(r,s,a)),"number"==typeof r)s=s==r;else if("string"==typeof r||"boolean"==typeof r)s=!!r;else{if(!(r instanceof Y))throw Error("Predicate.evaluate returned an unexpected type.");s=0<r.i}if(!s){s=o,r=s.d;var f=s.a;if(!f)throw Error("Next must be called at least once before remove.");var l=f.b,f=f.a;l?l.a=f:r.a=f,f?f.b=l:r.b=l,r.i--,s.a=null}}return n}function kt(t,n,e,r){tt.call(this,4),this.c=t,this.k=n,this.f=e||new St([]),this.m=!!r,n=this.f,n=0<n.a.length?n.a[0].d:null,t.b&&n&&(t=n.name,t=pn?t.toLowerCase():t,this.d={name:t,l:n.l});t:{for(t=this.f,n=0;n<t.a.length;n++)if(e=t.a[n],e.e||1==e.g||0==e.g){t=!0;break t}t=!1}this.e=t}function It(t,n,e,r){this.h=t,this.d=n,this.a=e,this.b=r}function Ot(t,n,e,r){if(mn.hasOwnProperty(t))throw Error("Axis already created: "+t);return n=new It(t,n,e,!!r),mn[t]=n}function Rt(t){tt.call(this,1),this.c=t,this.e=t.e,this.b=t.b}function At(t){tt.call(this,4),this.c=t,et(this,tn(this.c,function(t){return t.e})),rt(this,tn(this.c,function(t){return t.b}))}function Pt(t,n){this.a=t,this.b=n}function Dt(t){for(var n,e=[];;){_t(t,"Missing right hand side of binary expression."),n=Yt(t);var r=k(t.a);if(!r)break;var i=(r=wn[r]||null)&&r.p;if(!i){t.a.a--;break}for(;e.length&&i<=e[e.length-1].p;)n=new ut(e.pop(),e.pop(),n);e.push(n,r)}for(;e.length;)n=new ut(e.pop(),e.pop(),n);return n}function _t(t,n){if(I(t.a))throw Error(n)}function Mt(t,n){var e=k(t.a);if(e!=n)throw Error("Bad token, expected: "+n+" got: "+e)}function Ct(t){if(t=k(t.a),")"!=t)throw Error("Bad token: "+t)}function Bt(t){if(t=k(t.a),2>t.length)throw Error("Unclosed literal string");return new wt(t)}function jt(t){var n=k(t.a),e=n.indexOf(":");if(-1==e)return new bt(n);var r=n.substring(0,e);if(t=t.b(r),!t)throw Error("Namespace prefix not declared: "+r);return n=n.substr(e+1),new bt(n,t)}function Ut(t){var n,e,r=[];if(Nt(T(t.a))){if(n=k(t.a),e=T(t.a),"/"==n&&(I(t.a)||"."!=e&&".."!=e&&"@"!=e&&"*"!=e&&!/(?![0-9])[\w]/.test(e)))return new Et;e=new Et,_t(t,"Missing next location step."),n=Lt(t,n),r.push(n)}else{t:{switch(n=T(t.a),e=n.charAt(0)){case"$":throw Error("Variable reference not allowed in HTML XPath");case"(":k(t.a),n=Dt(t),_t(t,'unclosed "("'),Mt(t,")");break;case'"':case"'":n=Bt(t);break;default:if(isNaN(+n)){if(vt(n)||!/(?![0-9])[\w]/.test(e)||"("!=T(t.a,1)){n=null;break t}for(n=k(t.a),n=yn[n]||null,k(t.a),e=[];")"!=T(t.a)&&(_t(t,"Missing function argument list."),e.push(Dt(t)),","==T(t.a));)k(t.a);_t(t,"Unclosed function argument list."),Ct(t),n=new ht(n,e)}else n=new yt(+k(t.a))}"["==T(t.a)&&(e=new St(Ft(t)),n=new lt(n,e))}if(n){if(!Nt(T(t.a)))return n;e=n}else n=Lt(t,"/"),e=new xt,r.push(n)}for(;Nt(T(t.a));)n=k(t.a),_t(t,"Missing next location step."),n=Lt(t,n),r.push(n);return new mt(e,r)}function Lt(t,n){var e,r,i;if("/"!=n&&"//"!=n)throw Error('Step op should be "/" or "//"');if("."==T(t.a))return r=new kt(In,new gt("node")),k(t.a),r;if(".."==T(t.a))return r=new kt(Tn,new gt("node")),k(t.a),r;var o;if("@"==T(t.a))o=En,k(t.a),_t(t,"Missing attribute name");else if("::"==T(t.a,1)){if(!/(?![0-9])[\w]/.test(T(t.a).charAt(0)))throw Error("Bad token: "+k(t.a));if(e=k(t.a),o=mn[e]||null,!o)throw Error("No axis with name: "+e);k(t.a),_t(t,"Missing node name")}else o=xn;if(e=T(t.a),/(?![0-9])[\w]/.test(e.charAt(0)))if("("==T(t.a,1)){if(!vt(e))throw Error("Invalid node type: "+e);if(e=k(t.a),!vt(e))throw Error("Invalid type name: "+e);Mt(t,"("),_t(t,"Bad nodetype"),i=T(t.a).charAt(0);var a=null;'"'!=i&&"'"!=i||(a=Bt(t)),_t(t,"Bad nodetype"),Ct(t),e=new gt(e,a)}else e=jt(t);else{if("*"!=e)throw Error("Bad token: "+k(t.a));e=jt(t)}return i=new St(Ft(t),o.a),r||new kt(o,e,i,"//"==n)}function Ft(t){for(var n=[];"["==T(t.a);){k(t.a),_t(t,"Missing predicate expression.");var e=Dt(t);n.push(e),_t(t,"Unclosed predicate expression."),Mt(t,"]")}return n}function Yt(t){if("-"==T(t.a))return k(t.a),new Rt(Yt(t));var n=Ut(t);if("|"!=T(t.a))t=n;else{for(n=[n];"|"==k(t.a);)_t(t,"Missing next union location path."),n.push(Ut(t));t.a.a--,t=new At(n)}return t}function Vt(t,r){if(!t.length)throw Error("Empty XPath expression.");var i=S(t);if(I(i))throw Error("Invalid XPath expression.");r?"function"==e(r)||(r=a(r.lookupNamespaceURI,r)):r=n(null);var o=Dt(new Pt(i,r));if(!I(i))throw Error("Bad token: "+k(i));this.evaluate=function(t,n){var e=o.a(new c(t));return new Ht(e,n)}}function Ht(t,n){if(0==n)if(t instanceof Y)n=4;else if("string"==typeof t)n=2;else if("number"==typeof t)n=1;else{if("boolean"!=typeof t)throw Error("Unexpected evaluation result.");n=3}if(2!=n&&1!=n&&3!=n&&!(t instanceof Y))throw Error("value could not be converted to the specified type");this.resultType=n;var e;switch(n){case 2:this.stringValue=t instanceof Y?G(t):""+t;break;case 1:this.numberValue=t instanceof Y?+G(t):+t;break;case 3:this.booleanValue=t instanceof Y?0<t.i:!!t;break;case 4:case 5:case 6:case 7:var r=K(t);e=[];for(var i=z(r);i;i=z(r))e.push(i instanceof E?i.a:i);this.snapshotLength=t.i,this.invalidIteratorState=!1;break;case 8:case 9:r=q(t),this.singleNodeValue=r instanceof E?r.a:r;break;default:throw Error("Unknown XPathResult type.")}var o=0;this.iterateNext=function(){if(4!=n&&5!=n)throw Error("iterateNext called with wrong result type");return o>=e.length?null:e[o++]},this.snapshotItem=function(t){if(6!=n&&7!=n)throw Error("snapshotItem called with wrong result type");return t>=e.length||0>t?null:e[t]}}function Xt(t){this.lookupNamespaceURI=J(t)}function $t(t){t=t||qt;var n=t.document;n.evaluate||(t.XPathResult=Ht,n.evaluate=function(t,n,e,r){return new Vt(t,e).evaluate(n,r)},n.createExpression=function(t,n){return new Vt(t,n)},n.createNSResolver=function(t){return new Xt(t)})}var qt=this;Function.prototype.bind=Function.prototype.bind||function(t,n){if(1<arguments.length){var e=Array.prototype.slice.call(arguments,1);return e.unshift(this,t),a.apply(null,e)}return a(this,t)};var Gt,Kt=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Wt=Array.prototype,zt=Wt.indexOf?function(t,n,e){return Wt.indexOf.call(t,n,e)}:function(t,n,e){if(e=null==e?0:0>e?Math.max(0,t.length+e):e,r(t))return r(n)&&1==n.length?t.indexOf(n,e):-1;for(;e<t.length;e++)if(e in t&&t[e]===n)return e;return-1},Jt=Wt.forEach?function(t,n,e){Wt.forEach.call(t,n,e)}:function(t,n,e){for(var i=t.length,o=r(t)?t.split(""):t,a=0;i>a;a++)a in o&&n.call(e,o[a],a,t)},Qt=Wt.filter?function(t,n,e){return Wt.filter.call(t,n,e)}:function(t,n,e){for(var i=t.length,o=[],a=0,u=r(t)?t.split(""):t,s=0;i>s;s++)if(s in u){var c=u[s];n.call(e,c,s,t)&&(o[a++]=c)}return o},Zt=Wt.reduce?function(t,n,e,r){return r&&(n=a(n,r)),Wt.reduce.call(t,n,e)}:function(t,n,e,r){var i=e;return Jt(t,function(e,o){i=n.call(r,i,e,o,t)}),i},tn=Wt.some?function(t,n,e){return Wt.some.call(t,n,e)}:function(t,n,e){for(var i=t.length,o=r(t)?t.split(""):t,a=0;i>a;a++)if(a in o&&n.call(e,o[a],a,t))return!0;return!1};t:{var nn=qt.navigator;if(nn){var en=nn.userAgent;if(en){Gt=en;break t}}Gt=""}var rn=f(Gt,"Opera")||f(Gt,"OPR"),on=f(Gt,"Edge")||f(Gt,"Trident")||f(Gt,"MSIE"),an=f(Gt,"Gecko")&&!(f(Gt.toLowerCase(),"webkit")&&!v())&&!(f(Gt,"Trident")||f(Gt,"MSIE"))&&!v(),un=f(Gt.toLowerCase(),"webkit")&&!v(),sn=function(){if(rn&&qt.opera){var t=qt.opera.version;return"function"==e(t)?t():t}var t="",n=w();return n&&(t=n?n[1]:""),on&&!v()&&(n=b(),n>parseFloat(t))?String(n):t}(),cn={},fn=qt.document,ln=b(),hn=!fn||!on||!ln&&v()?void 0:ln||("CSS1Compat"==fn.compatMode?parseInt(sn,10):5),pn=on&&!m(9),dn=on&&!m(8),gn=RegExp("\\$?(?:(?![0-9-])[\\w-]+:)?(?![0-9-])[\\w-]+|\\/\\/|\\.\\.|::|\\d+(?:\\.\\d*)?|\\.\\d+|\"[^\"]*\"|'[^']*'|[!<>]=|\\s+|.","g"),vn=/^\s/;g("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),!an&&!on||on&&m(9)||an&&y("1.9.1"),on&&y("9"),s(ut),ut.prototype.a=function(t){return this.c.j(this.f,this.k,t)},ut.prototype.toString=function(){var t="Binary Expression: "+this.c,t=t+nt(this.f);return t+=nt(this.k)},ct.prototype.toString=t("a");var wn={};ft("div",6,1,function(t,n,e){return it(t,e)/it(n,e)}),ft("mod",6,1,function(t,n,e){return it(t,e)%it(n,e)}),ft("*",6,1,function(t,n,e){return it(t,e)*it(n,e)}),ft("+",5,1,function(t,n,e){return it(t,e)+it(n,e)}),ft("-",5,1,function(t,n,e){return it(t,e)-it(n,e)}),ft("<",4,2,function(t,n,e){return st(function(t,n){return n>t},t,n,e)}),ft(">",4,2,function(t,n,e){return st(function(t,n){return t>n},t,n,e)}),ft("<=",4,2,function(t,n,e){return st(function(t,n){return n>=t},t,n,e)}),ft(">=",4,2,function(t,n,e){return st(function(t,n){return t>=n},t,n,e)});var bn=ft("=",3,2,function(t,n,e){return st(function(t,n){return t==n},t,n,e,!0)});ft("!=",3,2,function(t,n,e){return st(function(t,n){return t!=n},t,n,e,!0)}),ft("and",2,2,function(t,n,e){return at(t,e)&&at(n,e)}),ft("or",1,2,function(t,n,e){return at(t,e)||at(n,e)}),s(lt),lt.prototype.a=function(t){return t=this.c.a(t),Tt(this.f,t)},lt.prototype.toString=function(){var t;return t="Filter:"+nt(this.c),t+=nt(this.f)},s(ht),ht.prototype.a=function(t){return this.f.j.apply(null,p(t,this.c))},ht.prototype.toString=function(){var t="Function: "+this.f;if(this.c.length)var n=Zt(this.c,function(t,n){return t+nt(n)},"Arguments:"),t=t+nt(n);return t},pt.prototype.toString=t("h");var yn={};dt("boolean",2,!1,!1,function(t,n){return at(n,t)},1),dt("ceiling",1,!1,!1,function(t,n){return Math.ceil(it(n,t))},1),dt("concat",3,!1,!1,function(t,n){var e=d(arguments,1);return Zt(e,function(n,e){return n+ot(e,t)},"")},2,null),dt("contains",2,!1,!1,function(t,n,e){return f(ot(n,t),ot(e,t))},2),dt("count",1,!1,!1,function(t,n){return n.a(t).i},1,1,!0),dt("false",2,!1,!1,n(!1),0),dt("floor",1,!1,!1,function(t,n){return Math.floor(it(n,t))},1),dt("id",4,!1,!1,function(t,n){function e(t){if(pn){var n=i.all[t];if(n){if(n.nodeType&&t==n.id)return n;if(n.length)return h(n,function(n){return t==n.id})}return null}return i.getElementById(t)}var r=t.a,i=9==r.nodeType?r:r.ownerDocument,r=ot(n,t).split(/\s+/),o=[];Jt(r,function(t){t=e(t),!t||0<=zt(o,t)||o.push(t)}),o.sort(R);var a=new Y;return Jt(o,function(t){$(a,t)}),a},1),dt("lang",2,!1,!1,n(!1),1),dt("last",1,!0,!1,function(t){if(1!=arguments.length)throw Error("Function last expects ()");return t.d},0),dt("local-name",3,!1,!0,function(t,n){var e=n?q(n.a(t)):t.a;return e?e.localName||e.nodeName.toLowerCase():""},0,1,!0),dt("name",3,!1,!0,function(t,n){var e=n?q(n.a(t)):t.a;return e?e.nodeName.toLowerCase():""},0,1,!0),dt("namespace-uri",3,!0,!1,n(""),0,1,!0),dt("normalize-space",3,!1,!0,function(t,n){return(n?ot(n,t):D(t.a)).replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")},0,1),dt("not",2,!1,!1,function(t,n){return!at(n,t)},1),dt("number",1,!1,!0,function(t,n){return n?it(n,t):+D(t.a)},0,1),dt("position",1,!0,!1,function(t){return t.b},0),dt("round",1,!1,!1,function(t,n){return Math.round(it(n,t))},1),dt("starts-with",2,!1,!1,function(t,n,e){return n=ot(n,t),t=ot(e,t),0==n.lastIndexOf(t,0)},2),dt("string",3,!1,!0,function(t,n){return n?ot(n,t):D(t.a)},0,1),dt("string-length",1,!1,!0,function(t,n){return(n?ot(n,t):D(t.a)).length},0,1),dt("substring",3,!1,!1,function(t,n,e,r){if(e=it(e,t),isNaN(e)||1/0==e||-(1/0)==e)return"";if(r=r?it(r,t):1/0,isNaN(r)||-(1/0)===r)return"";e=Math.round(e)-1;var i=Math.max(e,0);return t=ot(n,t),1/0==r?t.substring(i):(n=Math.round(r),t.substring(i,e+n))},2,3),dt("substring-after",3,!1,!1,function(t,n,e){return n=ot(n,t),t=ot(e,t),e=n.indexOf(t),-1==e?"":n.substring(e+t.length)},2),dt("substring-before",3,!1,!1,function(t,n,e){return n=ot(n,t),t=ot(e,t),t=n.indexOf(t),-1==t?"":n.substring(0,t)},2),dt("sum",1,!1,!1,function(t,n){for(var e=K(n.a(t)),r=0,i=z(e);i;i=z(e))r+=+D(i);return r},1,1,!0),dt("translate",3,!1,!1,function(t,n,e,r){n=ot(n,t),e=ot(e,t);var i=ot(r,t);for(t=[],r=0;r<e.length;r++){var o=e.charAt(r);o in t||(t[o]=i.charAt(r))}for(e="",r=0;r<n.length;r++)o=n.charAt(r),e+=o in t?t[o]:o;return e},3),dt("true",2,!1,!1,n(!0),0),gt.prototype.a=function(t){return null===this.b||this.b==t.nodeType},gt.prototype.d=t("f"),gt.prototype.toString=function(){var t="Kind Test: "+this.f;return null===this.c||(t+=nt(this.c)),t},s(wt),wt.prototype.a=t("c"),wt.prototype.toString=function(){return"Literal: "+this.c},bt.prototype.a=function(t){var n=t.nodeType;return 1!=n&&2!=n?!1:"*"!=this.h&&this.h!=t.nodeName.toLowerCase()?!1:this.c==(t.namespaceURI?t.namespaceURI.toLowerCase():"http://www.w3.org/1999/xhtml")},bt.prototype.d=t("h"),bt.prototype.toString=function(){return"Name Test: "+("http://www.w3.org/1999/xhtml"==this.c?"":this.c+":")+this.h},s(yt),yt.prototype.a=t("c"),yt.prototype.toString=function(){return"Number: "+this.c},s(mt),s(Et),Et.prototype.a=function(t){var n=new Y;return t=t.a,9==t.nodeType?$(n,t):$(n,t.ownerDocument),n},Et.prototype.toString=n("Root Helper Expression"),s(xt),xt.prototype.a=function(t){var n=new Y;return $(n,t.a),n},xt.prototype.toString=n("Context Helper Expression"),mt.prototype.a=function(t){var n=this.f.a(t);if(!(n instanceof Y))throw Error("Filter expression must evaluate to nodeset.");t=this.c;for(var e=0,r=t.length;r>e&&n.i;e++){var i,o=t[e],a=K(n,o.c.a);if(o.e||o.c!=Sn)if(o.e||o.c!=kn)for(i=z(a),n=o.a(new c(i));null!=(i=z(a));)i=o.a(new c(i)),n=H(n,i);else i=z(a),n=o.a(new c(i));else{for(i=z(a);(n=z(a))&&(!i.contains||i.contains(n))&&8&n.compareDocumentPosition(i);i=n);n=o.a(new c(i))}}return n},mt.prototype.toString=function(){var t;if(t="Path Expression:"+nt(this.f),this.c.length){var n=Zt(this.c,function(t,n){return t+nt(n)},"Steps:");t+=nt(n)}return t},St.prototype.toString=function(){return Zt(this.a,function(t,n){return t+nt(n)},"Predicates:")},s(kt),kt.prototype.a=function(t){var n=t.a,e=null,e=this.d,r=null,i=null,o=0;if(e&&(r=e.name,i=e.l?ot(e.l,t):null,o=1),this.m)if(this.e||this.c!=xn)if(t=K(new kt(Nn,new gt("node")).a(t)),n=z(t))for(e=this.j(n,r,i,o);null!=(n=z(t));)e=H(e,this.j(n,r,i,o));else e=new Y;else e=M(this.k,n,r,i),e=Tt(this.f,e,o);else e=this.j(t.a,r,i,o);return e},kt.prototype.j=function(t,n,e,r){return t=this.c.d(this.k,t,n,e),t=Tt(this.f,t,r)},kt.prototype.toString=function(){var t;if(t="Step:"+nt("Operator: "+(this.m?"//":"/")),this.c.h&&(t+=nt("Axis: "+this.c)),t+=nt(this.k),this.f.a.length){var n=Zt(this.f.a,function(t,n){return t+nt(n)},"Predicates:");t+=nt(n)}return t},It.prototype.toString=t("h");var mn={};Ot("ancestor",function(t,n){for(var e=new Y,r=n;r=r.parentNode;)t.a(r)&&X(e,r);return e},!0),Ot("ancestor-or-self",function(t,n){var e=new Y,r=n;do t.a(r)&&X(e,r);while(r=r.parentNode);return e},!0);var En=Ot("attribute",function(t,n){var e=new Y,r=t.d();if("style"==r&&n.style&&pn)return $(e,new E(n.style,n,"style",n.style.cssText)),e;var i=n.attributes;if(i)if(t instanceof gt&&null===t.b||"*"==r)for(var o,r=0;o=i[r];r++)pn?o.nodeValue&&$(e,x(n,o)):$(e,o);else(o=i.getNamedItem(r))&&(pn?o.nodeValue&&$(e,x(n,o)):$(e,o));return e},!1),xn=Ot("child",function(t,n,e,i,o){return(pn?j:U).call(null,t,n,r(e)?e:null,r(i)?i:null,o||new Y)},!1,!0);Ot("descendant",M,!1,!0);var Nn=Ot("descendant-or-self",function(t,n,e,r){var i=new Y;return _(n,e,r)&&t.a(n)&&$(i,n),M(t,n,e,r,i)},!1,!0),Sn=Ot("following",function(t,n,e,r){var i=new Y;do for(var o=n;o=o.nextSibling;)_(o,e,r)&&t.a(o)&&$(i,o),i=M(t,o,e,r,i);while(n=n.parentNode);return i},!1,!0);Ot("following-sibling",function(t,n){for(var e=new Y,r=n;r=r.nextSibling;)t.a(r)&&$(e,r);return e},!1),Ot("namespace",function(){return new Y},!1);var Tn=Ot("parent",function(t,n){var e=new Y;if(9==n.nodeType)return e;if(2==n.nodeType)return $(e,n.ownerElement),e;var r=n.parentNode;return t.a(r)&&$(e,r),e},!1),kn=Ot("preceding",function(t,n,e,r){var i=new Y,o=[];do o.unshift(n);while(n=n.parentNode);for(var a=1,u=o.length;u>a;a++){var s=[];for(n=o[a];n=n.previousSibling;)s.unshift(n);for(var c=0,f=s.length;f>c;c++)n=s[c],_(n,e,r)&&t.a(n)&&$(i,n),i=M(t,n,e,r,i)}return i},!0,!0);Ot("preceding-sibling",function(t,n){for(var e=new Y,r=n;r=r.previousSibling;)t.a(r)&&X(e,r);return e},!0);var In=Ot("self",function(t,n){var e=new Y;return t.a(n)&&$(e,n),e},!1);s(Rt),Rt.prototype.a=function(t){return-it(this.c,t)},Rt.prototype.toString=function(){return"Unary Expression: -"+nt(this.c)},s(At),At.prototype.a=function(t){var n=new Y;return Jt(this.c,function(e){if(e=e.a(t),!(e instanceof Y))throw Error("Path expression must evaluate to NodeSet.");n=H(n,e)}),n},At.prototype.toString=function(){return Zt(this.c,function(t,n){return t+nt(n)},"Union Expression:")},Ht.ANY_TYPE=0,Ht.NUMBER_TYPE=1,Ht.STRING_TYPE=2,Ht.BOOLEAN_TYPE=3,Ht.UNORDERED_NODE_ITERATOR_TYPE=4,Ht.ORDERED_NODE_ITERATOR_TYPE=5,Ht.UNORDERED_NODE_SNAPSHOT_TYPE=6,Ht.ORDERED_NODE_SNAPSHOT_TYPE=7,Ht.ANY_UNORDERED_NODE_TYPE=8,Ht.FIRST_ORDERED_NODE_TYPE=9;var On=["wgxpath","install"],Rn=qt;On[0]in Rn||!Rn.execScript||Rn.execScript("var "+On[0]);for(var An;On.length&&(An=On.shift());)On.length||void 0===$t?Rn=Rn[An]?Rn[An]:Rn[An]={}:Rn[An]=$t}();

},{}],64:[function(require,module,exports){
"use strict";module.exports={PUBLIC_ANNOTATION_COUNT_CHANGED:"publicAnnotationCountChanged",DO_LOGIN:"doLogin"};

},{}],65:[function(require,module,exports){
var Bridge,RPC,extend,slice=[].slice;extend=require("extend"),RPC=require("./frame-rpc"),module.exports=Bridge=function(){function n(){this.links=[],this.channelListeners={},this.onConnectListeners=[]}return n.prototype.links=null,n.prototype.channelListeners=null,n.prototype.onConnectListeners=null,n.prototype.destroy=function(){var n,t,e,r,i;for(r=this.links,i=[],n=0,t=r.length;t>n;n++)e=r[n],i.push(e.channel.destroy());return i},n.prototype.createChannel=function(n,t,e){var r,i,o,l,c;return r=null,o=!1,c=function(t){return function(){var e,i,l,c,u;if(!o){for(o=!0,c=t.onConnectListeners,u=[],i=0,l=c.length;l>i;i++)e=c[i],u.push(e.call(null,r,n));return u}}}(this),i=function(n){return function(n,t){return n===e?(t(),c()):void 0}}(this),l=extend({connect:i},this.channelListeners),r=new RPC(window,n,t,l),r.call("connect",e,c),this.links.push({channel:r,window:n}),r},n.prototype.call=function(){var n,t,e,r,i,o;return r=arguments[0],t=2<=arguments.length?slice.call(arguments,1):[],e=null,"function"==typeof t[t.length-1]&&(e=t[t.length-1],t=t.slice(0,-1)),n=function(n){return function(t){return function(e){var r;throw t.destroy(),n.links=function(){var n,e,i,o;for(i=this.links,o=[],n=0,e=i.length;e>n;n++)r=i[n],r.channel!==t&&o.push(r);return o}.call(n),e}}}(this),i=this.links.map(function(e){var i;return i=new Promise(function(n,i){var o,l,c,u;u=setTimeout(function(){return n(null)},1e3);try{return(c=e.channel).call.apply(c,[r].concat(slice.call(t),[function(t,e){return clearTimeout(u),t?i(t):n(e)}]))}catch(l){return o=l,i(o)}}),i["catch"](n(e.channel))}),o=Promise.all(i),null!=e&&(o=o.then(function(n){return e(null,n)})["catch"](function(n){return e(n)})),o},n.prototype.on=function(n,t){if(this.channelListeners[n])throw new Error("Listener '"+n+"' already bound in Bridge");return this.channelListeners[n]=t,this},n.prototype.off=function(n){return delete this.channelListeners[n],this},n.prototype.onConnect=function(n){return this.onConnectListeners.push(n),this},n}();

},{"./frame-rpc":67,"extend":24}],66:[function(require,module,exports){
var Discovery,bind=function(e,s){return function(){return e.apply(s,arguments)}};module.exports=Discovery=function(){function e(e,s){this.target=e,null==s&&(s={}),this._onMessage=bind(this._onMessage,this),this.stopDiscovery=bind(this.stopDiscovery,this),s.server&&(this.server=s.server),s.origin&&(this.origin=s.origin)}return e.prototype.server=!1,e.prototype.origin="*",e.prototype.onDiscovery=null,e.prototype.requestInProgress=!1,e.prototype.startDiscovery=function(e){if(this.onDiscovery)throw new Error("Discovery is already in progress, call .stopDiscovery() first");this.onDiscovery=e,this.target.addEventListener("message",this._onMessage,!1),this._beacon()},e.prototype.stopDiscovery=function(){this.onDiscovery=null,this.target.removeEventListener("message",this._onMessage)},e.prototype._beacon=function(){var e,s,r,o,t,i,n;for(e=this.server?"__cross_frame_dhcp_offer":"__cross_frame_dhcp_discovery",i=[this.target.top];i.length;)for(t=i.shift(),t!==this.target&&t.postMessage(e,this.origin),n=t.frames,r=0,o=n.length;o>r;r++)s=n[r],i.push(s)},e.prototype._onMessage=function(e){var s,r,o,t,i,n,c,a,p;a=e.source,i=e.origin,s=e.data,("null"===i||i.match("moz-extension:")||"moz-extension:"===window.location.protocol)&&(i="*"),o="function"==typeof s.match?s.match(/^__cross_frame_dhcp_(discovery|offer|request|ack)(?::(\d+))?$/):void 0,o&&(t=o[1],p=o[2],n=this._processMessage(t,p,i),c=n.reply,r=n.discovered,p=n.token,c&&a.postMessage("__cross_frame_dhcp_"+c,i),r&&this.onDiscovery.call(null,a,i,p))},e.prototype._processMessage=function(e,s,r){var o,t;if(t=null,o=!1,this.server){if("discovery"===e)t="offer";else if("request"===e)s=this._generateToken(),t="ack:"+s,o=!0;else if("offer"===e||"ack"===e)throw new Error("A second Discovery server has been detected at "+r+".\nThis is unsupported and will cause unexpected behaviour.")}else"offer"===e?this.requestInProgress||(this.requestInProgress=!0,t="request"):"ack"===e&&(this.requestInProgress=!1,o=!0);return{reply:t,discovered:o,token:s}},e.prototype._generateToken=function(){return(""+Math.random()).replace(/\D/g,"")},e}();

},{}],67:[function(require,module,exports){
"use strict";function RPC(e,t,s,o){if(!(this instanceof RPC))return new RPC(e,t,s,o);var r=this;if(this.src=e,this.dst=t,"*"===s)this.origin="*";else{var i=new URL(s);this.origin=i.protocol+"//"+i.host}this._sequence=0,this._callbacks={},this._onmessage=function(e){r._destroyed||"*"!==r.origin&&e.origin!==r.origin||e.data&&"object"==typeof e.data&&"frame-rpc"===e.data.protocol&&Array.isArray(e.data.arguments)&&r._handle(e.data)},this.src.addEventListener("message",this._onmessage),this._methods=("function"==typeof o?o(this):o)||{}}var VERSION="1.0.0";module.exports=RPC,RPC.prototype.destroy=function(){this._destroyed=!0,this.src.removeEventListener("message",this._onmessage)},RPC.prototype.call=function(e){var t=[].slice.call(arguments,1);return this.apply(e,t)},RPC.prototype.apply=function(e,t){if(!this._destroyed){var s=this._sequence++;"function"==typeof t[t.length-1]&&(this._callbacks[s]=t[t.length-1],t=t.slice(0,-1)),this.dst.postMessage({protocol:"frame-rpc",version:VERSION,sequence:s,method:e,arguments:t},this.origin)}},RPC.prototype._handle=function(e){var t=this;if(!t._destroyed)if(e.hasOwnProperty("method")){if(!this._methods.hasOwnProperty(e.method))return;var s=e.arguments.concat(function(){t.dst.postMessage({protocol:"frame-rpc",version:VERSION,response:e.sequence,arguments:[].slice.call(arguments)},t.origin)});this._methods[e.method].apply(this._methods,s)}else if(e.hasOwnProperty("response")){var o=this._callbacks[e.response];delete this._callbacks[e.response],o&&o.apply(null,e.arguments)}};

},{}],68:[function(require,module,exports){
"use strict";function assign(t,s){for(var e in s)s.hasOwnProperty(e)&&(t[e]=s[e]);return t}function settings(t){for(var s=t.querySelectorAll("script.js-hypothesis-config"),e={},n=0;n<s.length;n++)assign(e,JSON.parse(s[n].textContent));return e}module.exports=settings;

},{}]},{},[47])
//# sourceMappingURL=injector.bundle.js.map
